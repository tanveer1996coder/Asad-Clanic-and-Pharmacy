{"version":3,"file":"static/js/173.4fa69e6c.chunk.js","mappings":"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","sources":["../node_modules/@mui/icons-material/esm/Visibility.js","utils/formatters.js","../node_modules/@mui/icons-material/esm/Send.js","components/purchaseOrders/CreateEditPODialog.js","components/stock/ReceiveStockDialog.js","utils/poPdfGenerator.js","components/purchaseOrders/PODetailDialog.js","../node_modules/@mui/icons-material/esm/Share.js","utils/printPO.js","components/purchaseOrders/POReceiptModal.js","components/purchaseOrders/PurchaseOrdersPage.js","../node_modules/@mui/icons-material/esm/Add.js","../node_modules/@mui/icons-material/esm/Edit.js","utils/whatsappHelper.js","../node_modules/@mui/icons-material/esm/CheckCircle.js"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3\"\n}), 'Visibility');","/**\r\n * Format currency value\r\n * @param {number} value - Value to format\r\n * @param {string} symbol - Currency symbol (default: 'PKR')\r\n * @returns {string} Formatted currency string\r\n */\r\nexport function formatCurrency(value, symbol = 'PKR') {\r\n    if (value === null || value === undefined || isNaN(value)) {\r\n        return `${symbol} 0.00`;\r\n    }\r\n\r\n    const num = Number(value);\r\n    return `${symbol} ${num.toLocaleString('en-US', {\r\n        minimumFractionDigits: 2,\r\n        maximumFractionDigits: 2,\r\n    })}`;\r\n}\r\n\r\n/**\r\n * Format number with thousand separators\r\n * @param {number} value - Value to format\r\n * @returns {string} Formatted number string\r\n */\r\nexport function formatNumber(value) {\r\n    if (value === null || value === undefined || isNaN(value)) {\r\n        return '0';\r\n    }\r\n\r\n    return Number(value).toLocaleString('en-US');\r\n}\r\n\r\n/**\r\n * Format percentage\r\n * @param {number} value - Value to format (0-100)\r\n * @param {number} decimals - Number of decimal places (default: 1)\r\n * @returns {string} Formatted percentage string\r\n */\r\nexport function formatPercentage(value, decimals = 1) {\r\n    if (value === null || value === undefined || isNaN(value)) {\r\n        return '0%';\r\n    }\r\n\r\n    return `${Number(value).toFixed(decimals)}%`;\r\n}\r\n\r\n/**\r\n * Truncate text to specified length\r\n * @param {string} text - Text to truncate\r\n * @param {number} maxLength - Maximum length\r\n * @returns {string} Truncated text\r\n */\r\nexport function truncateText(text, maxLength = 50) {\r\n    if (!text) return '';\r\n    if (text.length <= maxLength) return text;\r\n    return text.substring(0, maxLength) + '...';\r\n}\r\n\r\n/**\r\n * Capitalize first letter of each word\r\n * @param {string} text - Text to capitalize\r\n * @returns {string} Capitalized text\r\n */\r\nexport function capitalizeWords(text) {\r\n    if (!text) return '';\r\n    return text\r\n        .toLowerCase()\r\n        .split(' ')\r\n        .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n        .join(' ');\r\n}\r\n\r\n/**\r\n * Format phone number\r\n * @param {string} phone - Phone number\r\n * @returns {string} Formatted phone number\r\n */\r\nexport function formatPhone(phone) {\r\n    if (!phone) return '';\r\n    // Remove all non-digit characters\r\n    const cleaned = phone.replace(/\\D/g, '');\r\n\r\n    // Format as: 0300-1234567\r\n    if (cleaned.length === 11 && cleaned.startsWith('0')) {\r\n        return `${cleaned.slice(0, 4)}-${cleaned.slice(4)}`;\r\n    }\r\n\r\n    return phone;\r\n}\r\n\r\n/**\r\n * Get initials from name\r\n * @param {string} name - Full name\r\n * @returns {string} Initials (max 2 letters)\r\n */\r\nexport function getInitials(name) {\r\n    if (!name) return '?';\r\n\r\n    const parts = name.trim().split(' ');\r\n    if (parts.length === 1) {\r\n        return parts[0].charAt(0).toUpperCase();\r\n    }\r\n\r\n    return (parts[0].charAt(0) + parts[parts.length - 1].charAt(0)).toUpperCase();\r\n}\r\n\r\n/**\r\n * Calculate profit margin percentage\r\n * @param {number} revenue - Total revenue\r\n * @param {number} cost - Total cost\r\n * @returns {number} Profit margin percentage\r\n */\r\nexport function calculateProfitMargin(revenue, cost) {\r\n    if (!revenue || revenue === 0) return 0;\r\n    const profit = revenue - (cost || 0);\r\n    return (profit / revenue) * 100;\r\n}\r\n\r\n/**\r\n * Generate random color for charts\r\n * @param {number} index - Index for consistent colors\r\n * @returns {string} Hex color code\r\n */\r\nexport function getChartColor(index) {\r\n    const colors = [\r\n        '#6366f1', // Indigo\r\n        '#ec4899', // Pink\r\n        '#10b981', // Green\r\n        '#f59e0b', // Amber\r\n        '#3b82f6', // Blue\r\n        '#8b5cf6', // Purple\r\n        '#ef4444', // Red\r\n        '#14b8a6', // Teal\r\n        '#f97316', // Orange\r\n        '#06b6d4', // Cyan\r\n    ];\r\n\r\n    return colors[index % colors.length];\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z\"\n}), 'Send');","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    TextField,\r\n    Grid,\r\n    MenuItem,\r\n    Box,\r\n    Typography,\r\n    IconButton,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Autocomplete,\r\n    Divider,\r\n    Card,\r\n    CardContent,\r\n    useTheme,\r\n    useMediaQuery,\r\n} from '@mui/material';\r\nimport { Add, Delete, ShoppingCart } from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\n\r\nexport default function CreateEditPODialog({ open, onClose, purchaseOrder, suppliers }) {\r\n    const isEdit = !!purchaseOrder;\r\n    const theme = useTheme();\r\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\r\n\r\n    const [formData, setFormData] = useState({\r\n        supplier_id: '',\r\n        order_date: new Date().toISOString().split('T')[0],\r\n        notes: '',\r\n    });\r\n\r\n    const [items, setItems] = useState([]);\r\n    const [products, setProducts] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (open) {\r\n            fetchProducts();\r\n            if (isEdit) {\r\n                loadPOData();\r\n            } else {\r\n                resetForm();\r\n            }\r\n        }\r\n    }, [open, purchaseOrder]);\r\n\r\n    const fetchProducts = async () => {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session) return;\r\n\r\n        const { data } = await supabase\r\n            .from('products')\r\n            .select('*')\r\n            .eq('organization_id', session.user.id)\r\n            .is('deleted_at', null)\r\n            .order('name');\r\n\r\n        setProducts(data || []);\r\n    };\r\n\r\n    const loadPOData = async () => {\r\n        if (!purchaseOrder) return;\r\n\r\n        setFormData({\r\n            supplier_id: purchaseOrder.supplier_id || '',\r\n            order_date: purchaseOrder.order_date || new Date().toISOString().split('T')[0],\r\n            notes: purchaseOrder.notes || '',\r\n        });\r\n\r\n        // Fetch PO items\r\n        const { data } = await supabase\r\n            .from('purchase_order_items')\r\n            .select('*, products(name)')\r\n            .eq('purchase_order_id', purchaseOrder.id);\r\n\r\n        if (data) {\r\n            setItems(data.map(item => ({\r\n                product_id: item.product_id,\r\n                product_name: item.products?.name,\r\n                quantity_ordered: item.quantity_ordered,\r\n                boxes_ordered: item.boxes_ordered || '',\r\n                items_per_box: item.items_per_box || 1,\r\n            })));\r\n        }\r\n    };\r\n\r\n    const resetForm = () => {\r\n        setFormData({\r\n            supplier_id: '',\r\n            order_date: new Date().toISOString().split('T')[0],\r\n            notes: '',\r\n        });\r\n        setItems([]);\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        setFormData({\r\n            ...formData,\r\n            [e.target.name]: e.target.value,\r\n        });\r\n    };\r\n\r\n    const handleAddItem = () => {\r\n        setItems([...items, {\r\n            product_id: '',\r\n            product_name: '',\r\n            quantity_ordered: 1,\r\n            boxes_ordered: '',\r\n            items_per_box: 1,\r\n        }]);\r\n    };\r\n\r\n    const handleRemoveItem = (index) => {\r\n        setItems(items.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const handleItemChange = (index, field, value) => {\r\n        const newItems = [...items];\r\n        newItems[index][field] = value;\r\n\r\n        // If product changed, update product name and default items_per_box\r\n        if (field === 'product_id') {\r\n            const product = products.find(p => p.id === value);\r\n            if (product) {\r\n                newItems[index].product_name = product.name;\r\n                newItems[index].items_per_box = product.items_per_box || 1;\r\n                // Recalculate if boxes are already entered\r\n                if (newItems[index].boxes_ordered) {\r\n                    newItems[index].quantity_ordered = newItems[index].boxes_ordered * (product.items_per_box || 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto-calculate total quantity if boxes or items_per_box change\r\n        if (field === 'boxes_ordered' || field === 'items_per_box') {\r\n            const boxes = field === 'boxes_ordered' ? value : newItems[index].boxes_ordered;\r\n            const perBox = field === 'items_per_box' ? value : newItems[index].items_per_box;\r\n\r\n            if (boxes && perBox) {\r\n                newItems[index].quantity_ordered = parseInt(boxes) * parseInt(perBox);\r\n            }\r\n        }\r\n\r\n        setItems(newItems);\r\n    };\r\n\r\n    const handleKeyDown = (e, index) => {\r\n        if (e.key === 'Enter' && !e.shiftKey) {\r\n            e.preventDefault();\r\n            // Move to next field or add new item if on last item\r\n            if (index === items.length - 1) {\r\n                handleAddItem();\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        // Validation\r\n        if (!formData.supplier_id) {\r\n            toast.error('Please select a supplier');\r\n            return;\r\n        }\r\n        if (items.length === 0) {\r\n            toast.error('Please add at least one item');\r\n            return;\r\n        }\r\n        if (items.some(item => !item.product_id || item.quantity_ordered <= 0)) {\r\n            toast.error('Please fill in all item details correctly');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) throw new Error('Not authenticated');\r\n\r\n            if (isEdit) {\r\n                // Update existing PO\r\n                const { error: poError } = await supabase\r\n                    .from('purchase_orders')\r\n                    .update({\r\n                        supplier_id: formData.supplier_id,\r\n                        order_date: formData.order_date,\r\n                        notes: formData.notes,\r\n                        updated_at: new Date().toISOString(),\r\n                    })\r\n                    .eq('id', purchaseOrder.id);\r\n\r\n                if (poError) throw poError;\r\n\r\n                // Delete existing items\r\n                await supabase\r\n                    .from('purchase_order_items')\r\n                    .delete()\r\n                    .eq('purchase_order_id', purchaseOrder.id);\r\n\r\n                // Insert new items\r\n                const { error: itemsError } = await supabase\r\n                    .from('purchase_order_items')\r\n                    .insert(items.map(item => ({\r\n                        purchase_order_id: purchaseOrder.id,\r\n                        product_id: item.product_id,\r\n                        quantity_ordered: item.quantity_ordered,\r\n                        boxes_ordered: item.boxes_ordered ? parseInt(item.boxes_ordered) : null,\r\n                        items_per_box: item.items_per_box ? parseInt(item.items_per_box) : 1,\r\n                        unit_price: 0,\r\n                    })));\r\n\r\n                if (itemsError) throw itemsError;\r\n\r\n                toast.success('PO updated successfully!');\r\n                onClose(); // Close without passing data for edits\r\n            } else {\r\n                // Generate PO number\r\n                const { data: poNumberData } = await supabase.rpc('generate_po_number');\r\n                const poNumber = poNumberData || `PO-${Date.now()}`;\r\n\r\n                // Create new PO\r\n                const { data: newPO, error: poError } = await supabase\r\n                    .from('purchase_orders')\r\n                    .insert([{\r\n                        po_number: poNumber,\r\n                        supplier_id: formData.supplier_id,\r\n                        currency_id: null,\r\n                        order_date: formData.order_date,\r\n                        status: 'draft',\r\n                        notes: formData.notes,\r\n                        created_by: session.user.id,\r\n                        organization_id: session.user.id,\r\n                        total_amount: 0,\r\n                        final_amount: 0,\r\n                    }])\r\n                    .select()\r\n                    .single();\r\n\r\n                if (poError) throw poError;\r\n\r\n                // Insert items\r\n                const { error: itemsError } = await supabase\r\n                    .from('purchase_order_items')\r\n                    .insert(items.map(item => ({\r\n                        purchase_order_id: newPO.id,\r\n                        product_id: item.product_id,\r\n                        quantity_ordered: item.quantity_ordered,\r\n                        boxes_ordered: item.boxes_ordered ? parseInt(item.boxes_ordered) : null,\r\n                        items_per_box: item.items_per_box ? parseInt(item.items_per_box) : 1,\r\n                        unit_price: 0,\r\n                    })));\r\n\r\n                if (itemsError) throw itemsError;\r\n\r\n                toast.success('Purchase Order created successfully!');\r\n\r\n                // Pass the created PO data back to parent for receipt modal\r\n                const itemsWithNames = items.map(item => ({\r\n                    ...item,\r\n                    product_name: products.find(p => p.id === item.product_id)?.name\r\n                }));\r\n\r\n                onClose(newPO, itemsWithNames, suppliers.find(s => s.id === formData.supplier_id));\r\n            }\r\n        } catch (error) {\r\n            console.error('Error saving PO:', error);\r\n            toast.error('Failed to save purchase order: ' + error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onClose={() => onClose()} maxWidth=\"md\" fullWidth>\r\n            <DialogTitle>\r\n                <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n                    <ShoppingCart color=\"primary\" />\r\n                    {isEdit ? 'Edit Purchase Order' : 'Create Purchase Order'}\r\n                </Box>\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <Grid container spacing={2} sx={{ mt: 1 }}>\r\n                    <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                            select\r\n                            fullWidth\r\n                            required\r\n                            label=\"Supplier\"\r\n                            name=\"supplier_id\"\r\n                            value={formData.supplier_id}\r\n                            onChange={handleChange}\r\n                        >\r\n                            {suppliers.map((supplier) => (\r\n                                <MenuItem key={supplier.id} value={supplier.id}>\r\n                                    {supplier.name}\r\n                                </MenuItem>\r\n                            ))}\r\n                        </TextField>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                            fullWidth\r\n                            required\r\n                            type=\"date\"\r\n                            label=\"Order Date\"\r\n                            name=\"order_date\"\r\n                            value={formData.order_date}\r\n                            onChange={handleChange}\r\n                            InputLabelProps={{ shrink: true }}\r\n                        />\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <Divider sx={{ my: 1 }} />\r\n                        <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\r\n                            <Typography variant=\"h6\">Items to Order</Typography>\r\n                            <Button startIcon={<Add />} onClick={handleAddItem}>\r\n                                Add Item\r\n                            </Button>\r\n                        </Box>\r\n\r\n                        {isMobile ? (\r\n                            // Mobile view - Cards instead of table\r\n                            <Box>\r\n                                {items.map((item, index) => (\r\n                                    <Card key={index} variant=\"outlined\" sx={{ mb: 2 }}>\r\n                                        <CardContent>\r\n                                            <Grid container spacing={2}>\r\n                                                <Grid item xs={12}>\r\n                                                    <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={1}>\r\n                                                        <Typography variant=\"subtitle2\" fontWeight={600}>\r\n                                                            Item #{index + 1}\r\n                                                        </Typography>\r\n                                                        <IconButton size=\"small\" color=\"error\" onClick={() => handleRemoveItem(index)}>\r\n                                                            <Delete fontSize=\"small\" />\r\n                                                        </IconButton>\r\n                                                    </Box>\r\n                                                </Grid>\r\n                                                <Grid item xs={12}>\r\n                                                    <Autocomplete\r\n                                                        size=\"small\"\r\n                                                        options={products}\r\n                                                        getOptionLabel={(option) => option.name || ''}\r\n                                                        value={products.find(p => p.id === item.product_id) || null}\r\n                                                        onChange={(e, newValue) => {\r\n                                                            handleItemChange(index, 'product_id', newValue?.id || '');\r\n                                                        }}\r\n                                                        renderInput={(params) => (\r\n                                                            <TextField {...params} label=\"Product\" placeholder=\"Select product\" />\r\n                                                        )}\r\n                                                    />\r\n                                                </Grid>\r\n                                                <Grid item xs={6}>\r\n                                                    <TextField\r\n                                                        size=\"small\"\r\n                                                        fullWidth\r\n                                                        type=\"number\"\r\n                                                        label=\"Boxes\"\r\n                                                        placeholder=\"Boxes\"\r\n                                                        value={item.boxes_ordered}\r\n                                                        onChange={(e) => handleItemChange(index, 'boxes_ordered', e.target.value)}\r\n                                                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                                                        inputProps={{ min: 1 }}\r\n                                                    />\r\n                                                </Grid>\r\n                                                <Grid item xs={6}>\r\n                                                    <TextField\r\n                                                        size=\"small\"\r\n                                                        fullWidth\r\n                                                        type=\"number\"\r\n                                                        label=\"Items/Box\"\r\n                                                        placeholder=\"Per Box\"\r\n                                                        value={item.items_per_box}\r\n                                                        onChange={(e) => handleItemChange(index, 'items_per_box', e.target.value)}\r\n                                                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                                                        inputProps={{ min: 1 }}\r\n                                                    />\r\n                                                </Grid>\r\n                                                <Grid item xs={12}>\r\n                                                    <TextField\r\n                                                        size=\"small\"\r\n                                                        fullWidth\r\n                                                        type=\"number\"\r\n                                                        label=\"Total Items\"\r\n                                                        value={item.quantity_ordered}\r\n                                                        onChange={(e) => handleItemChange(index, 'quantity_ordered', e.target.value)}\r\n                                                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                                                        inputProps={{ min: 1 }}\r\n                                                        helperText=\"Total Units\"\r\n                                                    />\r\n                                                </Grid>\r\n                                            </Grid>\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                ))}\r\n                            </Box>\r\n                        ) : (\r\n                            // Desktop view - Table\r\n                            <TableContainer>\r\n                                <Table size=\"small\">\r\n                                    <TableHead>\r\n                                        <TableRow>\r\n                                            <TableCell><strong>Product</strong></TableCell>\r\n                                            <TableCell width=\"100\"><strong>Boxes</strong></TableCell>\r\n                                            <TableCell width=\"100\"><strong>Items/Box</strong></TableCell>\r\n                                            <TableCell width=\"120\"><strong>Total Items</strong></TableCell>\r\n                                            <TableCell width=\"50\"></TableCell>\r\n                                        </TableRow>\r\n                                    </TableHead>\r\n                                    <TableBody>\r\n                                        {items.map((item, index) => (\r\n                                            <TableRow key={index}>\r\n                                                <TableCell>\r\n                                                    <Autocomplete\r\n                                                        size=\"small\"\r\n                                                        options={products}\r\n                                                        getOptionLabel={(option) => option.name || ''}\r\n                                                        value={products.find(p => p.id === item.product_id) || null}\r\n                                                        onChange={(e, newValue) => {\r\n                                                            handleItemChange(index, 'product_id', newValue?.id || '');\r\n                                                        }}\r\n                                                        renderInput={(params) => (\r\n                                                            <TextField {...params} placeholder=\"Select product\" />\r\n                                                        )}\r\n                                                    />\r\n                                                </TableCell>\r\n                                                <TableCell>\r\n                                                    <TextField\r\n                                                        size=\"small\"\r\n                                                        fullWidth\r\n                                                        type=\"number\"\r\n                                                        placeholder=\"Boxes\"\r\n                                                        value={item.boxes_ordered}\r\n                                                        onChange={(e) => handleItemChange(index, 'boxes_ordered', e.target.value)}\r\n                                                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                                                        inputProps={{ min: 1 }}\r\n                                                    />\r\n                                                </TableCell>\r\n                                                <TableCell>\r\n                                                    <TextField\r\n                                                        size=\"small\"\r\n                                                        fullWidth\r\n                                                        type=\"number\"\r\n                                                        placeholder=\"Per Box\"\r\n                                                        value={item.items_per_box}\r\n                                                        onChange={(e) => handleItemChange(index, 'items_per_box', e.target.value)}\r\n                                                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                                                        inputProps={{ min: 1 }}\r\n                                                    />\r\n                                                </TableCell>\r\n                                                <TableCell>\r\n                                                    <TextField\r\n                                                        size=\"small\"\r\n                                                        fullWidth\r\n                                                        type=\"number\"\r\n                                                        value={item.quantity_ordered}\r\n                                                        onChange={(e) => handleItemChange(index, 'quantity_ordered', e.target.value)}\r\n                                                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                                                        inputProps={{ min: 1 }}\r\n                                                        helperText=\"Total Units\"\r\n                                                    />\r\n                                                </TableCell>\r\n                                                <TableCell>\r\n                                                    <IconButton size=\"small\" color=\"error\" onClick={() => handleRemoveItem(index)}>\r\n                                                        <Delete fontSize=\"small\" />\r\n                                                    </IconButton>\r\n                                                </TableCell>\r\n                                            </TableRow>\r\n                                        ))}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </TableContainer>\r\n                        )}\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <TextField\r\n                            fullWidth\r\n                            multiline\r\n                            rows={2}\r\n                            label=\"Notes (Optional)\"\r\n                            name=\"notes\"\r\n                            value={formData.notes}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Any special instructions for the supplier...\"\r\n                        />\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <Box bgcolor=\"info.light\" p={2} borderRadius={1}>\r\n                            <Typography variant=\"body2\" color=\"info.dark\">\r\n                                <strong>Note:</strong> Prices will be entered when you receive the stock from the supplier.\r\n                            </Typography>\r\n                        </Box>\r\n                    </Grid>\r\n                </Grid>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={() => onClose()}>Cancel</Button>\r\n                <Button onClick={handleSubmit} variant=\"contained\" disabled={loading}>\r\n                    {isEdit ? 'Update Order' : 'Create Order'}\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    TextField,\r\n    Grid,\r\n    Box,\r\n    Typography,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Chip,\r\n} from '@mui/material';\r\nimport { LocalShipping, Inventory } from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\n\r\nexport default function ReceiveStockDialog({ open, onClose, purchaseOrder, poItems }) {\r\n    const [receivingData, setReceivingData] = useState([]);\r\n    const [receivedDate, setReceivedDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [notes, setNotes] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (open && poItems) {\r\n            fetchProductDetails();\r\n        }\r\n    }, [open, poItems]);\r\n\r\n    const fetchProductDetails = async () => {\r\n        try {\r\n            // Get all product IDs\r\n            const productIds = poItems.map(item => item.product_id);\r\n\r\n            // Fetch current product details (especially selling price)\r\n            const { data: products, error } = await supabase\r\n                .from('products')\r\n                .select('id, price, cost_price, items_per_box')\r\n                .in('id', productIds);\r\n\r\n            if (error) throw error;\r\n\r\n            // Map products for easy lookup\r\n            const productMap = {};\r\n            products?.forEach(p => {\r\n                productMap[p.id] = p;\r\n            });\r\n\r\n            // Initialize receiving data\r\n            setReceivingData(poItems.map(item => {\r\n                const product = productMap[item.product_id];\r\n                return {\r\n                    po_item_id: item.id,\r\n                    product_id: item.product_id,\r\n                    product_name: item.product_name || item.products?.name,\r\n                    quantity_ordered: item.quantity_ordered,\r\n                    quantity_already_received: item.quantity_received,\r\n                    quantity_remaining: item.quantity_ordered - item.quantity_received,\r\n                    quantity_to_receive: 0,\r\n                    unit_price: item.unit_price || product?.cost_price || 0, // Purchasing Price (per item)\r\n                    selling_price: product?.price || 0, // Selling Price (per item)\r\n                    boxes_received: '',\r\n                    items_per_box: item.items_per_box || product?.items_per_box || 1,\r\n                    cost_per_box: '',\r\n                    total_cost: '', // User entry: Total Purchasing Cost\r\n                    selling_price_per_box: '', // User entry: Selling Price per Box (MRP)\r\n                    total_selling_price: 0, // Calculated: selling_price_per_box * boxes_received\r\n                };\r\n            }));\r\n        } catch (error) {\r\n            console.error('Error fetching product details:', error);\r\n            toast.error('Failed to load product details');\r\n        }\r\n    };\r\n\r\n    const handleQuantityChange = (index, field, value) => {\r\n        const newData = [...receivingData];\r\n\r\n        if (field === 'boxes_received' || field === 'items_per_box') {\r\n            newData[index][field] = value;\r\n\r\n            const boxes = parseFloat(newData[index].boxes_received) || 0;\r\n            const perBox = parseFloat(newData[index].items_per_box) || 1;\r\n\r\n            // Auto-calculate total quantity\r\n            if (boxes > 0) {\r\n                const totalQty = Math.round(boxes * perBox);\r\n                const maxReceivable = newData[index].quantity_remaining;\r\n                newData[index].quantity_to_receive = Math.min(totalQty, maxReceivable);\r\n            }\r\n        } else {\r\n            // Direct quantity update\r\n            const maxReceivable = newData[index].quantity_remaining;\r\n            const qty = Math.min(parseInt(value) || 0, maxReceivable);\r\n            newData[index].quantity_to_receive = qty;\r\n        }\r\n\r\n        setReceivingData(newData);\r\n    };\r\n\r\n    const handlePriceChange = (index, field, value) => {\r\n        const newData = [...receivingData];\r\n        newData[index][field] = parseFloat(value) || 0;\r\n\r\n        const boxes = parseFloat(newData[index].boxes_received) || 0;\r\n        const perBox = parseFloat(newData[index].items_per_box) || 1;\r\n        const totalItems = boxes * perBox;\r\n\r\n        // Auto-calculate costs based on Total Cost\r\n        if (field === 'total_cost' || field === 'boxes_received' || field === 'items_per_box') {\r\n            const totalCost = parseFloat(field === 'total_cost' ? value : newData[index].total_cost) || 0;\r\n\r\n            if (boxes > 0) {\r\n                newData[index].cost_per_box = totalCost / boxes;\r\n                if (totalItems > 0) {\r\n                    newData[index].unit_price = totalCost / totalItems;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto-calculate selling price per item based on Selling Price/Box\r\n        if (field === 'selling_price_per_box' || field === 'items_per_box' || field === 'boxes_received') {\r\n            const sellBox = parseFloat(field === 'selling_price_per_box' ? value : newData[index].selling_price_per_box) || 0;\r\n\r\n            if (perBox > 0) {\r\n                newData[index].selling_price = sellBox / perBox;\r\n            }\r\n\r\n            // Calculate Total Selling Price\r\n            if (boxes > 0) {\r\n                newData[index].total_selling_price = sellBox * boxes;\r\n            }\r\n        }\r\n\r\n        setReceivingData(newData);\r\n    };\r\n\r\n    const handleReceiveAll = (index) => {\r\n        const newData = [...receivingData];\r\n        newData[index].quantity_to_receive = newData[index].quantity_remaining;\r\n        setReceivingData(newData);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        const itemsToReceive = receivingData.filter(item => item.quantity_to_receive > 0);\r\n\r\n        if (itemsToReceive.length === 0) {\r\n            toast.error('Please enter quantities to receive');\r\n            return;\r\n        }\r\n\r\n        // Validate prices are entered\r\n        const itemsWithoutPrice = itemsToReceive.filter(item => item.unit_price <= 0 || item.selling_price <= 0);\r\n        if (itemsWithoutPrice.length > 0) {\r\n            toast.error('Please enter both purchasing and selling prices for all items being received');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) throw new Error('Not authenticated');\r\n\r\n            // Process each item\r\n            for (const item of itemsToReceive) {\r\n                // Create stock receipt\r\n                const { data: stockReceipt, error: receiptError } = await supabase\r\n                    .from('stock_receipts')\r\n                    .insert([{\r\n                        product_id: item.product_id,\r\n                        quantity: item.quantity_to_receive,\r\n                        received_date: receivedDate,\r\n                        notes,\r\n                        purchase_order_id: purchaseOrder.id,\r\n                        organization_id: session.user.id // Ensure org_id is set\r\n                    }])\r\n                    .select()\r\n                    .single();\r\n\r\n                if (receiptError) throw receiptError;\r\n\r\n                // Fetch current stock to ensure accuracy\r\n                const { data: currentProduct, error: fetchError } = await supabase\r\n                    .from('products')\r\n                    .select('stock')\r\n                    .eq('id', item.product_id)\r\n                    .single();\r\n\r\n                if (fetchError) throw fetchError;\r\n\r\n                const newStock = (currentProduct?.stock || 0) + parseInt(item.quantity_to_receive);\r\n\r\n                // Update product stock, cost price, selling price, and box details\r\n                const { error: updateError } = await supabase\r\n                    .from('products')\r\n                    .update({\r\n                        stock: newStock,\r\n                        cost_price: item.unit_price, // Update cost price\r\n                        price: item.selling_price,   // Update selling price (per item)\r\n                        items_per_box: item.items_per_box, // Update items per box\r\n                        price_per_box: item.selling_price_per_box // Update MRP/Selling Price per Box\r\n                    })\r\n                    .eq('id', item.product_id);\r\n\r\n                if (updateError) throw updateError;\r\n\r\n                // Update PO item with received quantity and price\r\n                const { error: poItemError } = await supabase\r\n                    .from('purchase_order_items')\r\n                    .update({\r\n                        quantity_received: item.quantity_already_received + item.quantity_to_receive,\r\n                        unit_price: item.unit_price, // Save the purchasing price\r\n                    })\r\n                    .eq('id', item.po_item_id);\r\n\r\n                if (poItemError) throw poItemError;\r\n\r\n                // Record in receiving history\r\n                await supabase\r\n                    .from('po_receiving_history')\r\n                    .insert([{\r\n                        purchase_order_id: purchaseOrder.id,\r\n                        po_item_id: item.po_item_id,\r\n                        quantity_received: item.quantity_to_receive,\r\n                        received_date: receivedDate,\r\n                        received_by: session.user.id,\r\n                        stock_receipt_id: stockReceipt.id,\r\n                        notes,\r\n                        boxes_received: item.boxes_received ? parseInt(item.boxes_received) : null,\r\n                    }]);\r\n            }\r\n\r\n            // Check if PO is fully received\r\n            const allReceived = receivingData.every(item =>\r\n                (item.quantity_already_received + item.quantity_to_receive) >= item.quantity_ordered\r\n            );\r\n\r\n            if (allReceived) {\r\n                await supabase\r\n                    .from('purchase_orders')\r\n                    .update({ status: 'received' })\r\n                    .eq('id', purchaseOrder.id);\r\n            } else {\r\n                await supabase\r\n                    .from('purchase_orders')\r\n                    .update({ status: 'partially_received' })\r\n                    .eq('id', purchaseOrder.id);\r\n            }\r\n\r\n            toast.success('Stock received successfully!');\r\n            onClose();\r\n        } catch (error) {\r\n            console.error('Error receiving stock:', error);\r\n            toast.error('Failed to receive stock: ' + error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const totalToReceive = receivingData.reduce((sum, item) => sum + item.quantity_to_receive, 0);\r\n    const totalAmount = receivingData.reduce((sum, item) => sum + (parseFloat(item.total_cost) || 0), 0);\r\n\r\n    return (\r\n        <Dialog open={open} onClose={onClose} maxWidth=\"xl\" fullWidth>\r\n            <DialogTitle>\r\n                <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n                    <LocalShipping color=\"primary\" />\r\n                    Receive Stock - PO: {purchaseOrder?.po_number}\r\n                </Box>\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <Grid container spacing={2} sx={{ mt: 1 }}>\r\n                    <Grid item xs={12}>\r\n                        <TextField\r\n                            fullWidth\r\n                            type=\"date\"\r\n                            label=\"Received Date\"\r\n                            value={receivedDate}\r\n                            onChange={(e) => setReceivedDate(e.target.value)}\r\n                            InputLabelProps={{ shrink: true }}\r\n                        />\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <TableContainer sx={{ overflowX: 'auto', maxHeight: '60vh' }}>\r\n                            <Table size=\"small\" stickyHeader>\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell>Product</TableCell>\r\n                                        <TableCell align=\"center\">Ordered</TableCell>\r\n                                        <TableCell align=\"center\">Received</TableCell>\r\n                                        <TableCell align=\"center\">Remaining</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>Boxes Received</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>Items/Box</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>Total Cost</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>MRP/Box</TableCell>\r\n\r\n                                        {/* System Calculated Fields */}\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Total Items</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Cost/Box</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Cost/Item</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Sale/Item</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Total Selling</TableCell>\r\n                                        <TableCell></TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {receivingData.map((item, index) => (\r\n                                        <TableRow key={index}>\r\n                                            <TableCell>{item.product_name}</TableCell>\r\n                                            <TableCell align=\"center\">\r\n                                                <Chip label={item.quantity_ordered} size=\"small\" />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\">\r\n                                                <Chip\r\n                                                    label={item.quantity_already_received}\r\n                                                    size=\"small\"\r\n                                                    color={item.quantity_already_received > 0 ? 'success' : 'default'}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\">\r\n                                                <Chip\r\n                                                    label={item.quantity_remaining}\r\n                                                    size=\"small\"\r\n                                                    color={item.quantity_remaining > 0 ? 'warning' : 'success'}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    placeholder=\"Boxes\"\r\n                                                    value={item.boxes_received}\r\n                                                    onChange={(e) => handleQuantityChange(index, 'boxes_received', e.target.value)}\r\n                                                    inputProps={{ min: 0, style: { width: '60px', textAlign: 'center' } }}\r\n                                                    disabled={item.quantity_remaining === 0}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    placeholder=\"/Box\"\r\n                                                    value={item.items_per_box}\r\n                                                    onChange={(e) => handleQuantityChange(index, 'items_per_box', e.target.value)}\r\n                                                    inputProps={{ min: 1, style: { width: '50px', textAlign: 'center' } }}\r\n                                                    disabled={item.quantity_remaining === 0}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    placeholder=\"Total\"\r\n                                                    value={item.total_cost}\r\n                                                    onChange={(e) => handlePriceChange(index, 'total_cost', e.target.value)}\r\n                                                    inputProps={{ min: 0, step: 0.01, style: { width: '80px', textAlign: 'center' } }}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    value={item.selling_price_per_box}\r\n                                                    onChange={(e) => handlePriceChange(index, 'selling_price_per_box', e.target.value)}\r\n                                                    placeholder=\"MRP\"\r\n                                                    inputProps={{\r\n                                                        min: 0,\r\n                                                        step: 0.01,\r\n                                                        style: { width: '80px', textAlign: 'center' }\r\n                                                    }}\r\n                                                />\r\n                                            </TableCell>\r\n\r\n                                            {/* Calculated Values */}\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\" fontWeight={600}>\r\n                                                    {item.quantity_to_receive}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\">\r\n                                                    {item.cost_per_box ? parseFloat(item.cost_per_box).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\">\r\n                                                    {item.unit_price ? parseFloat(item.unit_price).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\">\r\n                                                    {item.selling_price ? parseFloat(item.selling_price).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\" fontWeight={600} color=\"success.main\">\r\n                                                    {item.total_selling_price ? parseFloat(item.total_selling_price).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell>\r\n                                                {item.quantity_remaining > 0 && (\r\n                                                    <Button\r\n                                                        size=\"small\"\r\n                                                        onClick={() => handleReceiveAll(index)}\r\n                                                    >\r\n                                                        All\r\n                                                    </Button>\r\n                                                )}\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </TableContainer>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <Box bgcolor=\"primary.main\" color=\"white\" p={2} borderRadius={1}>\r\n                            <Grid container>\r\n                                <Grid item xs={6}>\r\n                                    <Typography variant=\"h6\">\r\n                                        Total Items: {totalToReceive}\r\n                                    </Typography>\r\n                                </Grid>\r\n                                <Grid item xs={6}>\r\n                                    <Typography variant=\"h6\" align=\"right\">\r\n                                        Total Cost: Rs {totalAmount.toFixed(2)}\r\n                                    </Typography>\r\n                                </Grid>\r\n                            </Grid>\r\n                        </Box>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <TextField\r\n                            fullWidth\r\n                            multiline\r\n                            rows={2}\r\n                            label=\"Delivery Notes\"\r\n                            value={notes}\r\n                            onChange={(e) => setNotes(e.target.value)}\r\n                            placeholder=\"Optional notes about this delivery (condition, packaging, etc.)\"\r\n                        />\r\n                    </Grid>\r\n                </Grid>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={onClose}>Cancel</Button>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    startIcon={<Inventory />}\r\n                    onClick={handleSubmit}\r\n                    disabled={loading || totalToReceive === 0}\r\n                >\r\n                    Receive Stock\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n","import jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\nexport const generatePOPDF = async (po, poItems, settings) => {\r\n    try {\r\n        const doc = new jsPDF();\r\n\r\n        // Default values to prevent crashes\r\n        const storeName = settings?.store_name || 'Medical Store';\r\n        const poNumber = po?.po_number || 'DRAFT';\r\n        const orderDate = po?.order_date ? new Date(po.order_date).toLocaleDateString() : new Date().toLocaleDateString();\r\n        const supplierName = po?.suppliers?.name || 'N/A';\r\n        const supplierPhone = po?.suppliers?.phone || '';\r\n        const items = Array.isArray(poItems) ? poItems : [];\r\n\r\n        // Header - Store Name\r\n        doc.setFontSize(20);\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text(storeName, 105, 20, { align: 'center' });\r\n\r\n        // Store details\r\n        doc.setFontSize(10);\r\n        doc.setFont(undefined, 'normal');\r\n        let yPos = 28;\r\n\r\n        if (settings?.address) {\r\n            doc.text(settings.address, 105, yPos, { align: 'center' });\r\n            yPos += 5;\r\n        }\r\n        if (settings?.phone) {\r\n            doc.text(`Phone: ${settings.phone}`, 105, yPos, { align: 'center' });\r\n            yPos += 5;\r\n        }\r\n        if (settings?.owner_name) {\r\n            doc.text(`Owner: ${settings.owner_name}`, 105, yPos, { align: 'center' });\r\n            yPos += 5;\r\n        }\r\n\r\n        // Divider line\r\n        doc.setLineWidth(0.5);\r\n        doc.line(14, yPos + 3, 196, yPos + 3);\r\n\r\n        // Title\r\n        doc.setFontSize(16);\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text('PURCHASE ORDER', 105, yPos + 12, { align: 'center' });\r\n\r\n        // PO Info Box\r\n        const infoY = yPos + 22;\r\n        doc.setFontSize(11);\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text('PO Details:', 14, infoY);\r\n\r\n        doc.setFont(undefined, 'normal');\r\n        doc.text(`PO Number: ${poNumber}`, 14, infoY + 7);\r\n        doc.text(`Order Date: ${orderDate}`, 14, infoY + 14);\r\n\r\n        // Supplier Info (right side)\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text('Supplier:', 120, infoY);\r\n        doc.setFont(undefined, 'normal');\r\n\r\n        doc.text(supplierName, 120, infoY + 7);\r\n\r\n        if (supplierPhone) {\r\n            doc.text(`Phone: ${supplierPhone}`, 120, infoY + 14);\r\n        }\r\n\r\n        // Items Table\r\n        const tableColumn = [\"#\", \"Product\", \"Quantity (Boxes)\"];\r\n        const tableRows = items.map((item, index) => {\r\n            // Handle both data formats safely\r\n            let productName = 'N/A';\r\n            if (item.product_name) productName = item.product_name;\r\n            else if (item.products?.name) productName = item.products.name;\r\n\r\n            const quantity = item.quantity_ordered || 0;\r\n\r\n            return [\r\n                (index + 1).toString(),\r\n                productName,\r\n                quantity.toString()\r\n            ];\r\n        });\r\n\r\n        autoTable(doc, {\r\n            head: [tableColumn],\r\n            body: tableRows,\r\n            startY: infoY + 25,\r\n            theme: 'striped',\r\n            headStyles: {\r\n                fillColor: [41, 128, 185],\r\n                fontStyle: 'bold',\r\n                fontSize: 11\r\n            },\r\n            styles: {\r\n                fontSize: 10\r\n            },\r\n            columnStyles: {\r\n                0: { cellWidth: 15 },\r\n                1: { cellWidth: 125 },\r\n                2: { cellWidth: 40, halign: 'center' }\r\n            }\r\n        });\r\n\r\n        // Notes\r\n        let finalY = (doc.lastAutoTable && doc.lastAutoTable.finalY) || (infoY + 30) + 10;\r\n        if (po?.notes) {\r\n            doc.setFontSize(10);\r\n            doc.setFont(undefined, 'bold');\r\n            doc.text('Notes:', 14, finalY);\r\n            doc.setFont(undefined, 'normal');\r\n            const splitText = doc.splitTextToSize(po.notes, 180);\r\n            doc.text(splitText, 14, finalY + 6);\r\n            finalY += 6 + (splitText.length * 5);\r\n        }\r\n\r\n        // Digital Signature Area\r\n        finalY += 15;\r\n        if (finalY > 250) {\r\n            doc.addPage();\r\n            finalY = 20;\r\n        }\r\n\r\n        doc.setFontSize(10);\r\n        doc.setFont(undefined, 'normal');\r\n\r\n        // Signature boxes\r\n        doc.text('Prepared By:', 14, finalY);\r\n        doc.line(14, finalY + 15, 80, finalY + 15); // Line for signature\r\n        doc.setFontSize(9);\r\n        doc.text('Signature & Date', 30, finalY + 20);\r\n\r\n        doc.setFontSize(10);\r\n        doc.text('Approved By:', 120, finalY);\r\n        doc.line(120, finalY + 15, 186, finalY + 15); // Line for signature\r\n        doc.setFontSize(9);\r\n        doc.text('Signature & Date', 135, finalY + 20);\r\n\r\n        // Footer\r\n        const pageHeight = doc.internal.pageSize.height;\r\n        doc.setFontSize(9);\r\n        doc.setFont(undefined, 'italic');\r\n        doc.setTextColor(100, 100, 100);\r\n\r\n        const footerY = pageHeight - 20;\r\n        if (settings?.footer_text) {\r\n            doc.text(settings.footer_text, 105, footerY, { align: 'center' });\r\n        } else {\r\n            doc.text('Thank you for your service!', 105, footerY, { align: 'center' });\r\n        }\r\n\r\n        // Branding footer - REMOVED for white-label\r\n        // doc.setFontSize(8);\r\n        // doc.setTextColor(150, 150, 150); \r\n        // doc.text('Receipt designed and generated by MedixFlow | +923089020131', 105, footerY + 6, { align: 'center' });\r\n\r\n        // Page number\r\n        doc.setFontSize(8);\r\n        doc.text(`Page 1`, 105, footerY + 10, { align: 'center' });\r\n\r\n        return doc.output('blob');\r\n    } catch (error) {\r\n        console.error('PDF Generation Error:', error);\r\n        // Fallback: return a simple PDF with error message so app doesn't crash\r\n        const doc = new jsPDF();\r\n        doc.text('Error generating PDF receipt.', 10, 10);\r\n        doc.text(error.message, 10, 20);\r\n        return doc.output('blob');\r\n    }\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    Box,\r\n    Typography,\r\n    Grid,\r\n    Chip,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Divider,\r\n    IconButton,\r\n    Tooltip,\r\n} from '@mui/material';\r\nimport {\r\n    Send,\r\n    Download,\r\n    LocalShipping,\r\n    Close,\r\n} from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { formatCurrency } from '../../utils/formatters';\r\nimport ReceiveStockDialog from '../stock/ReceiveStockDialog';\r\nimport { generatePOPDF } from '../../utils/poPdfGenerator';\r\nimport { openWhatsApp } from '../../utils/whatsappHelper';\r\n\r\nexport default function PODetailDialog({ open, onClose, purchaseOrder, onRefresh }) {\r\n    const [poDetails, setPODetails] = useState(null);\r\n    const [poItems, setPOItems] = useState([]);\r\n    const [receivingHistory, setReceivingHistory] = useState([]);\r\n    const [receiveDialogOpen, setReceiveDialogOpen] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (open && purchaseOrder) {\r\n            fetchPODetails();\r\n        }\r\n    }, [open, purchaseOrder]);\r\n\r\n    const fetchPODetails = async () => {\r\n        if (!purchaseOrder) return;\r\n\r\n        try {\r\n            // Fetch PO with all relations\r\n            const { data: po, error: poError } = await supabase\r\n                .from('purchase_orders')\r\n                .select(`\r\n                    *,\r\n                    suppliers(name, phone, supplier_contacts(*))\r\n                `)\r\n                .eq('id', purchaseOrder.id)\r\n                .single();\r\n\r\n            if (poError) throw poError;\r\n            setPODetails(po);\r\n\r\n            // Fetch PO items\r\n            const { data: items, error: itemsError } = await supabase\r\n                .from('purchase_order_items')\r\n                .select('*, products(name)')\r\n                .eq('purchase_order_id', purchaseOrder.id);\r\n\r\n            if (itemsError) throw itemsError;\r\n            setPOItems(items || []);\r\n\r\n            // Fetch receiving history\r\n            const { data: history, error: historyError } = await supabase\r\n                .from('po_receiving_history')\r\n                .select('*')\r\n                .eq('purchase_order_id', purchaseOrder.id)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (historyError) throw historyError;\r\n            setReceivingHistory(history || []);\r\n        } catch (error) {\r\n            console.error('Error fetching PO details:', error);\r\n            toast.error('Failed to load PO details');\r\n        }\r\n    };\r\n\r\n    const handleSendToSupplier = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            const { data: settingsData } = await supabase\r\n                .from('settings')\r\n                .select('*')\r\n                .eq('organization_id', session.user.id)\r\n                .single();\r\n\r\n            // Generate and Download PDF\r\n            try {\r\n                const pdfBlob = await generatePOPDF(poDetails, poItems, settingsData);\r\n                const url = URL.createObjectURL(pdfBlob);\r\n                const link = document.createElement('a');\r\n                link.href = url;\r\n                link.download = `${poDetails.po_number}.pdf`;\r\n                link.click();\r\n                URL.revokeObjectURL(url);\r\n                toast.info('PDF downloaded! Please attach it to the WhatsApp chat.');\r\n            } catch (pdfError) {\r\n                console.error('PDF Error:', pdfError);\r\n                toast.warning('Could not generate PDF, but opening WhatsApp...');\r\n            }\r\n\r\n            // Update status to sent\r\n            const { error } = await supabase\r\n                .from('purchase_orders')\r\n                .update({\r\n                    status: 'sent',\r\n                    sent_at: new Date().toISOString(),\r\n                })\r\n                .eq('id', purchaseOrder.id);\r\n\r\n            if (error) throw error;\r\n\r\n            // Get primary contact\r\n            const primaryContact = poDetails.suppliers?.supplier_contacts?.find(c => c.is_primary);\r\n            const phone = primaryContact?.phone || poDetails.suppliers?.phone;\r\n\r\n            if (phone) {\r\n                const message = `Hello! Please find the Purchase Order ${poDetails.po_number}. We need these items as soon as possible. Thank you!`;\r\n                setTimeout(() => openWhatsApp(phone, message), 1000);\r\n            } else {\r\n                toast.warning('No phone number found for supplier');\r\n            }\r\n\r\n            toast.success('PO marked as sent!');\r\n            onRefresh();\r\n            fetchPODetails();\r\n        } catch (error) {\r\n            console.error('Error sending PO:', error);\r\n            toast.error('Failed to send PO');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDownloadPDF = async () => {\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            const { data: settingsData } = await supabase\r\n                .from('settings')\r\n                .select('*')\r\n                .eq('organization_id', session.user.id)\r\n                .single();\r\n\r\n            const pdfBlob = await generatePOPDF(poDetails, poItems, settingsData);\r\n            const url = URL.createObjectURL(pdfBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `${poDetails.po_number}.pdf`;\r\n            link.click();\r\n            URL.revokeObjectURL(url);\r\n            toast.success('PDF downloaded!');\r\n        } catch (error) {\r\n            console.error('Error generating PDF:', error);\r\n            toast.error('Failed to generate PDF');\r\n        }\r\n    };\r\n\r\n    const handleReceiveStock = () => {\r\n        setReceiveDialogOpen(true);\r\n    };\r\n\r\n    const handleReceiveDialogClose = () => {\r\n        setReceiveDialogOpen(false);\r\n        fetchPODetails();\r\n        onRefresh();\r\n    };\r\n\r\n    if (!poDetails) return null;\r\n\r\n    const getStatusColor = (status) => {\r\n        const colors = {\r\n            draft: 'default',\r\n            sent: 'primary',\r\n            partially_received: 'secondary',\r\n            received: 'success',\r\n        };\r\n        return colors[status] || 'default';\r\n    };\r\n\r\n    const getStatusLabel = (status) => {\r\n        const labels = {\r\n            draft: 'Draft',\r\n            sent: 'Sent',\r\n            partially_received: 'Receiving',\r\n            received: 'Completed',\r\n        };\r\n        return labels[status] || status;\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Dialog open={open} onClose={onClose} maxWidth=\"md\" fullWidth>\r\n                <DialogTitle>\r\n                    <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                        <Typography variant=\"h6\">Purchase Order: {poDetails.po_number}</Typography>\r\n                        <IconButton onClick={onClose}>\r\n                            <Close />\r\n                        </IconButton>\r\n                    </Box>\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                    <Grid container spacing={2}>\r\n                        {/* Status and Dates */}\r\n                        <Grid item xs={12}>\r\n                            <Box display=\"flex\" gap={1} flexWrap=\"wrap\">\r\n                                <Chip\r\n                                    label={getStatusLabel(poDetails.status)}\r\n                                    color={getStatusColor(poDetails.status)}\r\n                                />\r\n                                <Chip label={`Order: ${new Date(poDetails.order_date).toLocaleDateString()}`} variant=\"outlined\" />\r\n                                {poDetails.expected_delivery_date && (\r\n                                    <Chip label={`Expected: ${new Date(poDetails.expected_delivery_date).toLocaleDateString()}`} variant=\"outlined\" />\r\n                                )}\r\n                            </Box>\r\n                        </Grid>\r\n\r\n                        {/* Supplier Info */}\r\n                        <Grid item xs={12}>\r\n                            <Typography variant=\"subtitle2\" color=\"text.secondary\">Supplier</Typography>\r\n                            <Typography variant=\"h6\">{poDetails.suppliers?.name}</Typography>\r\n                            {poDetails.suppliers?.phone && (\r\n                                <Typography variant=\"body2\" color=\"text.secondary\">Phone: {poDetails.suppliers.phone}</Typography>\r\n                            )}\r\n                        </Grid>\r\n\r\n                        {/* Items */}\r\n                        <Grid item xs={12}>\r\n                            <Divider sx={{ my: 1 }} />\r\n                            <Typography variant=\"h6\" gutterBottom>Items</Typography>\r\n                            <TableContainer>\r\n                                <Table size=\"small\">\r\n                                    <TableHead>\r\n                                        <TableRow>\r\n                                            <TableCell>Product</TableCell>\r\n                                            <TableCell align=\"center\">Ordered</TableCell>\r\n                                            <TableCell align=\"center\">Received</TableCell>\r\n                                            {poDetails.status !== 'draft' && (\r\n                                                <>\r\n                                                    <TableCell align=\"right\">Unit Price</TableCell>\r\n                                                    <TableCell align=\"right\">Total</TableCell>\r\n                                                </>\r\n                                            )}\r\n                                        </TableRow>\r\n                                    </TableHead>\r\n                                    <TableBody>\r\n                                        {poItems.map((item) => (\r\n                                            <TableRow key={item.id}>\r\n                                                <TableCell>{item.products?.name}</TableCell>\r\n                                                <TableCell align=\"center\">\r\n                                                    <Chip\r\n                                                        label={item.boxes_ordered\r\n                                                            ? `${item.boxes_ordered} Boxes (${item.quantity_ordered})`\r\n                                                            : item.quantity_ordered\r\n                                                        }\r\n                                                        size=\"small\"\r\n                                                    />\r\n                                                </TableCell>\r\n                                                <TableCell align=\"center\">\r\n                                                    <Chip\r\n                                                        label={item.quantity_received}\r\n                                                        size=\"small\"\r\n                                                        color={item.quantity_received >= item.quantity_ordered ? 'success' : 'default'}\r\n                                                    />\r\n                                                </TableCell>\r\n                                                {poDetails.status !== 'draft' && (\r\n                                                    <>\r\n                                                        <TableCell align=\"right\">\r\n                                                            {item.unit_price > 0 ? `Rs ${formatCurrency(item.unit_price, '')}` : ''}\r\n                                                        </TableCell>\r\n                                                        <TableCell align=\"right\">\r\n                                                            {item.unit_price > 0 ? `Rs ${formatCurrency(item.quantity_ordered * item.unit_price, '')}` : ''}\r\n                                                        </TableCell>\r\n                                                    </>\r\n                                                )}\r\n                                            </TableRow>\r\n                                        ))}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </TableContainer>\r\n                        </Grid>\r\n\r\n                        {/* Receiving History */}\r\n                        {receivingHistory.length > 0 && (\r\n                            <Grid item xs={12}>\r\n                                <Divider sx={{ my: 1 }} />\r\n                                <Typography variant=\"h6\" gutterBottom>Receiving History</Typography>\r\n                                {receivingHistory.map((history) => (\r\n                                    <Box key={history.id} sx={{ mb: 1, p: 1, bgcolor: 'grey.50', borderRadius: 1 }}>\r\n                                        <Typography variant=\"body2\">\r\n                                            <strong>{new Date(history.received_date).toLocaleDateString()}:</strong>\r\n                                            {' '}Received {history.quantity_received} units\r\n                                            {history.notes && ` - ${history.notes}`}\r\n                                        </Typography>\r\n                                    </Box>\r\n                                ))}\r\n                            </Grid>\r\n                        )}\r\n\r\n                        {/* Notes */}\r\n                        {poDetails.notes && (\r\n                            <Grid item xs={12}>\r\n                                <Typography variant=\"subtitle2\" color=\"text.secondary\">Notes</Typography>\r\n                                <Typography variant=\"body2\">{poDetails.notes}</Typography>\r\n                            </Grid>\r\n                        )}\r\n                    </Grid>\r\n                </DialogContent>\r\n                <DialogActions sx={{ flexWrap: 'wrap', gap: 1, p: 2 }}>\r\n                    <Box flex={1} display=\"flex\" gap={1}>\r\n                        <Tooltip title=\"Download PDF\">\r\n                            <IconButton color=\"primary\" onClick={handleDownloadPDF}>\r\n                                <Download />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </Box>\r\n                    <Box display=\"flex\" gap={1} flexWrap=\"wrap\">\r\n                        {poDetails.status === 'draft' && (\r\n                            <Button\r\n                                startIcon={<Send />}\r\n                                variant=\"contained\"\r\n                                onClick={handleSendToSupplier}\r\n                                disabled={loading}\r\n                            >\r\n                                Send to Supplier\r\n                            </Button>\r\n                        )}\r\n                        {(poDetails.status === 'sent' || poDetails.status === 'partially_received') && (\r\n                            <Button\r\n                                startIcon={<LocalShipping />}\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={handleReceiveStock}\r\n                            >\r\n                                Receive Stock\r\n                            </Button>\r\n                        )}\r\n                        <Button onClick={onClose}>Close</Button>\r\n                    </Box>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <ReceiveStockDialog\r\n                open={receiveDialogOpen}\r\n                onClose={handleReceiveDialogClose}\r\n                purchaseOrder={poDetails}\r\n                poItems={poItems}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92\"\n}), 'Share');","import { formatCurrency } from './formatters';\r\n\r\nexport const printPO = (po, items, settings) => {\r\n    try {\r\n        const storeName = settings?.store_name || 'Medical Store';\r\n        const currency = settings?.currency_symbol || 'Rs';\r\n        const poNumber = po?.po_number || 'DRAFT';\r\n        const orderDate = po?.order_date ? new Date(po.order_date).toLocaleDateString() : new Date().toLocaleDateString();\r\n        const supplierName = po?.suppliers?.name || 'N/A';\r\n        const supplierPhone = po?.suppliers?.phone || '';\r\n\r\n        // Create receipt HTML\r\n        const receiptHTML = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>PO #${poNumber}</title>\r\n    <style>\r\n        @media print {\r\n            @page {\r\n                size: 80mm auto;\r\n                margin: 5mm;\r\n            }\r\n            body {\r\n                margin: 0;\r\n                padding: 0;\r\n            }\r\n        }\r\n        \r\n        body {\r\n            font-family: 'Courier New', monospace;\r\n            width: 80mm;\r\n            margin: 0 auto;\r\n            padding: 10px;\r\n            font-size: 12px;\r\n        }\r\n        \r\n        .header {\r\n            text-align: center;\r\n            margin-bottom: 15px;\r\n            border-bottom: 2px dashed #000;\r\n            padding-bottom: 10px;\r\n        }\r\n       \r\n        .store-name {\r\n            font-size: 18px;\r\n            font-weight: bold;\r\n            margin-bottom: 5px;\r\n        }\r\n        \r\n        .receipt-title {\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n            margin-bottom: 5px;\r\n        }\r\n        \r\n        .info-row {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            font-size: 11px;\r\n            margin-bottom: 2px;\r\n        }\r\n        \r\n        .items-table {\r\n            width: 100%;\r\n            margin: 10px 0;\r\n            border-collapse: collapse;\r\n        }\r\n        \r\n        .items-table th {\r\n            text-align: left;\r\n            border-bottom: 1px solid #000;\r\n            padding: 5px 2px;\r\n            font-size: 10px;\r\n        }\r\n        \r\n        .items-table td {\r\n            padding: 5px 2px;\r\n            font-size: 10px;\r\n            vertical-align: top;\r\n        }\r\n        \r\n        .item-name {\r\n            max-width: 40mm;\r\n            word-wrap: break-word;\r\n        }\r\n        \r\n        .text-center {\r\n            text-align: center;\r\n        }\r\n        \r\n        .text-right {\r\n            text-align: right;\r\n        }\r\n        \r\n        .footer {\r\n            text-align: center;\r\n            margin-top: 15px;\r\n            padding-top: 10px;\r\n            border-top: 2px dashed #000;\r\n            font-size: 10px;\r\n            color: #555;\r\n        }\r\n        \r\n        .branding {\r\n            margin-top: 10px;\r\n            font-size: 9px;\r\n            color: #888;\r\n            font-style: italic;\r\n        }\r\n\r\n        .notes {\r\n            margin-top: 10px;\r\n            border-top: 1px dashed #000;\r\n            padding-top: 5px;\r\n            font-size: 11px;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <div class=\"store-name\">${storeName}</div>\r\n        ${settings?.address ? `<div style=\"font-size: 10px;\">${settings.address}</div>` : ''}\r\n        ${settings?.phone ? `<div style=\"font-size: 10px;\">Phone: ${settings.phone}</div>` : ''}\r\n        <div class=\"receipt-title\" style=\"margin-top: 10px;\">PURCHASE ORDER</div>\r\n    </div>\r\n\r\n    <div class=\"info-row\">\r\n        <span>PO #:</span>\r\n        <span>${poNumber}</span>\r\n    </div>\r\n    <div class=\"info-row\">\r\n        <span>Date:</span>\r\n        <span>${orderDate}</span>\r\n    </div>\r\n    <div class=\"info-row\">\r\n        <span>Supplier:</span>\r\n        <span>${supplierName}</span>\r\n    </div>\r\n    ${supplierPhone ? `\r\n    <div class=\"info-row\">\r\n        <span>Supplier Ph:</span>\r\n        <span>${supplierPhone}</span>\r\n    </div>` : ''}\r\n    \r\n    <table class=\"items-table\">\r\n        <thead>\r\n            <tr>\r\n                <th>Item</th>\r\n                <th class=\"text-right\">Qty (Boxes)</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ${items.map(item => {\r\n            // Handle both data formats safely\r\n            let productName = 'N/A';\r\n            if (item.product_name) productName = item.product_name;\r\n            else if (item.products?.name) productName = item.products.name;\r\n\r\n            const quantity = item.quantity_ordered || 0;\r\n\r\n            return `\r\n                <tr>\r\n                    <td class=\"item-name\">${productName}</td>\r\n                    <td class=\"text-right\">${quantity}</td>\r\n                </tr>\r\n                `;\r\n        }).join('')}\r\n        </tbody>\r\n    </table>\r\n    \r\n    ${po.notes ? `\r\n    <div class=\"notes\">\r\n        <strong>Notes:</strong><br/>\r\n        ${po.notes}\r\n    </div>\r\n    ` : ''}\r\n    \r\n    <div class=\"footer\">\r\n        ${settings?.footer_text || 'Thank you for your service!'}\r\n        <div class=\"branding\">\r\n            \r\n        </div>\r\n    </div>\r\n    \r\n    <script>\r\n        // Auto-close window after printing or canceling\r\n        window.onafterprint = function() {\r\n            window.close();\r\n        };\r\n        \r\n        // Trigger print dialog immediately\r\n        window.onload = function() {\r\n            window.print();\r\n        };\r\n    </script>\r\n</body>\r\n</html>\r\n        `;\r\n\r\n        // Open in new window and print\r\n        const printWindow = window.open('', '_blank', 'width=400,height=600');\r\n        if (printWindow) {\r\n            printWindow.document.write(receiptHTML);\r\n            printWindow.document.close();\r\n            return true;\r\n        } else {\r\n            console.error('Could not open print window. Popup blocked?');\r\n            return false;\r\n        }\r\n    } catch (error) {\r\n        console.error('PO printing failed:', error);\r\n        return false;\r\n    }\r\n};\r\n","import React from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    Box,\r\n    Typography,\r\n    IconButton,\r\n    Divider,\r\n    useTheme,\r\n    useMediaQuery,\r\n    Paper,\r\n    Table,\r\n    TableBody,\r\n    TableRow,\r\n    TableCell,\r\n    TableHead,\r\n    TableContainer,\r\n} from '@mui/material';\r\nimport {\r\n    Close,\r\n    Download,\r\n    Print,\r\n    WhatsApp,\r\n    Share,\r\n    CheckCircle,\r\n} from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { generatePOPDF } from '../../utils/poPdfGenerator';\r\nimport { openWhatsApp } from '../../utils/whatsappHelper';\r\nimport { printPO } from '../../utils/printPO';\r\nimport html2canvas from 'html2canvas';\r\n\r\nexport default function POReceiptModal({ open, onClose, purchaseOrder, poItems, supplier, settings }) {\r\n    const theme = useTheme();\r\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\r\n\r\n    // Return null if no data\r\n    if (!purchaseOrder || !poItems || !supplier) {\r\n        return null;\r\n    }\r\n\r\n    const handleDownloadPDF = async () => {\r\n        try {\r\n            const pdfBlob = await generatePOPDF(purchaseOrder, poItems, settings);\r\n            const url = URL.createObjectURL(pdfBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `${purchaseOrder.po_number}.pdf`;\r\n            link.click();\r\n            URL.revokeObjectURL(url);\r\n            toast.success('PDF downloaded!');\r\n        } catch (error) {\r\n            console.error('Error generating PDF:', error);\r\n            toast.error('Failed to generate PDF: ' + error.message);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        const success = printPO(purchaseOrder, poItems, settings);\r\n        if (!success) {\r\n            toast.error('Failed to open print window. Please allow popups.');\r\n        }\r\n    };\r\n\r\n    const handleShare = async () => {\r\n        try {\r\n            const message = `Purchase Order: ${purchaseOrder.po_number}\\n\\nSupplier: ${supplier?.name}\\nDate: ${new Date(purchaseOrder.order_date).toLocaleDateString()}\\n\\nItems:\\n${poItems.map(item => `- ${item.product_name} x${item.quantity_ordered}`).join('\\n')}`;\r\n\r\n            if (navigator.share) {\r\n                await navigator.share({\r\n                    title: `PO ${purchaseOrder.po_number}`,\r\n                    text: message,\r\n                });\r\n            } else {\r\n                // Fallback to copy\r\n                await navigator.clipboard.writeText(message);\r\n                toast.success('Order details copied to clipboard!');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error sharing:', error);\r\n        }\r\n    };\r\n\r\n    const handleGenerateImage = async () => {\r\n        try {\r\n            const element = document.getElementById('po-receipt-content');\r\n            if (!element) return null;\r\n\r\n            const canvas = await html2canvas(element, {\r\n                scale: 2,\r\n                backgroundColor: '#ffffff',\r\n                logging: false,\r\n            });\r\n\r\n            return new Promise((resolve) => {\r\n                canvas.toBlob((blob) => {\r\n                    resolve(blob);\r\n                }, 'image/png');\r\n            });\r\n        } catch (error) {\r\n            console.error('Error generating image:', error);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    const handleWhatsApp = async () => {\r\n        const phone = supplier?.phone || supplier?.supplier_contacts?.find(c => c.is_primary)?.phone;\r\n        if (!phone) {\r\n            toast.error('No phone number found for supplier');\r\n            return;\r\n        }\r\n\r\n        const loadingToast = toast.loading('Generating receipt image...');\r\n\r\n        try {\r\n            const imageBlob = await handleGenerateImage();\r\n            if (!imageBlob) {\r\n                throw new Error('Failed to generate image');\r\n            }\r\n\r\n            const imageFile = new File(\r\n                [imageBlob],\r\n                `PO-${purchaseOrder.po_number}.png`,\r\n                { type: 'image/png' }\r\n            );\r\n\r\n            // Mobile: Use Web Share API for seamless sharing\r\n            if (navigator.share && navigator.canShare && navigator.canShare({ files: [imageFile] })) {\r\n                toast.update(loadingToast, {\r\n                    render: 'Opening share menu...',\r\n                    type: 'info',\r\n                    isLoading: false,\r\n                    autoClose: 2000\r\n                });\r\n\r\n                await navigator.share({\r\n                    title: `PO ${purchaseOrder.po_number}`,\r\n                    text: `Purchase Order: ${purchaseOrder.po_number}\\n\\nPlease find the order details in the attached image.\\n\\nThank you!`,\r\n                    files: [imageFile]\r\n                });\r\n\r\n                toast.success('Shared successfully!');\r\n            } else {\r\n                // Desktop: Download and open WhatsApp Web\r\n                const url = URL.createObjectURL(imageBlob);\r\n                const link = document.createElement('a');\r\n                link.href = url;\r\n                link.download = `PO-${purchaseOrder.po_number}.png`;\r\n                link.click();\r\n                URL.revokeObjectURL(url);\r\n\r\n                toast.update(loadingToast, {\r\n                    render: 'Image downloaded! Opening WhatsApp - please attach it.',\r\n                    type: 'success',\r\n                    isLoading: false,\r\n                    autoClose: 5000\r\n                });\r\n\r\n                const message = `Purchase Order: ${purchaseOrder.po_number}\\n\\nPlease find the order details in the downloaded image file.\\n\\nThank you!`;\r\n\r\n                setTimeout(() => {\r\n                    openWhatsApp(phone, message);\r\n                }, 1000);\r\n            }\r\n        } catch (e) {\r\n            console.error('Error handling WhatsApp share:', e);\r\n\r\n            if (e.name === 'AbortError') {\r\n                toast.dismiss(loadingToast);\r\n                return;\r\n            }\r\n\r\n            toast.update(loadingToast, {\r\n                render: 'Failed to share. Opening WhatsApp with text only.',\r\n                type: 'warning',\r\n                isLoading: false,\r\n                autoClose: 3000\r\n            });\r\n\r\n            const message = `Purchase Order: ${purchaseOrder.po_number}\\n\\nItems:\\n${poItems.map(item => `- ${item.product_name} x${item.quantity_ordered}`).join('\\n')}\\n\\nPlease confirm availability.`;\r\n            openWhatsApp(phone, message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onClose={onClose} maxWidth=\"sm\" fullWidth>\r\n            <DialogTitle>\r\n                <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                    <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n                        <CheckCircle color=\"success\" />\r\n                        <Typography variant=\"h6\">Purchase Order Created!</Typography>\r\n                    </Box>\r\n                    <IconButton onClick={onClose} size=\"small\">\r\n                        <Close />\r\n                    </IconButton>\r\n                </Box>\r\n            </DialogTitle>\r\n\r\n            <DialogContent>\r\n                {/* Professional Receipt Card */}\r\n                <Paper\r\n                    id=\"po-receipt-content\"\r\n                    elevation={3}\r\n                    sx={{ p: 3, bgcolor: 'grey.50', border: '1px solid', borderColor: 'grey.300' }}\r\n                >\r\n                    {/* Header */}\r\n                    <Box textAlign=\"center\" mb={2}>\r\n                        <Typography variant=\"h5\" fontWeight={700} color=\"primary\" gutterBottom>\r\n                            {settings?.store_name || 'Medical Store'}\r\n                        </Typography>\r\n                        {settings?.address && (\r\n                            <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                {settings.address}\r\n                            </Typography>\r\n                        )}\r\n                        {settings?.phone && (\r\n                            <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                Phone: {settings.phone}\r\n                            </Typography>\r\n                        )}\r\n                        {settings?.owner_name && (\r\n                            <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                Owner: {settings.owner_name}\r\n                            </Typography>\r\n                        )}\r\n                    </Box>\r\n\r\n                    <Divider sx={{ my: 2, borderColor: 'primary.main', borderWidth: 1 }} />\r\n\r\n                    {/* PO Title */}\r\n                    <Box textAlign=\"center\" my={2}>\r\n                        <Typography variant=\"h6\" fontWeight={700} color=\"text.primary\">\r\n                            PURCHASE ORDER\r\n                        </Typography>\r\n                        <Typography variant=\"h4\" fontWeight={700} color=\"primary\" mt={1}>\r\n                            {purchaseOrder.po_number}\r\n                        </Typography>\r\n                    </Box>\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    {/* Details Table */}\r\n                    <Table size=\"small\">\r\n                        <TableBody>\r\n                            <TableRow>\r\n                                <TableCell sx={{ fontWeight: 600, border: 'none', py: 0.5 }}>Date:</TableCell>\r\n                                <TableCell sx={{ border: 'none', py: 0.5 }}>\r\n                                    {new Date(purchaseOrder.order_date).toLocaleDateString()}\r\n                                </TableCell>\r\n                            </TableRow>\r\n                            <TableRow>\r\n                                <TableCell sx={{ fontWeight: 600, border: 'none', py: 0.5 }}>Supplier:</TableCell>\r\n                                <TableCell sx={{ border: 'none', py: 0.5 }}>{supplier?.name}</TableCell>\r\n                            </TableRow>\r\n                            {supplier?.phone && (\r\n                                <TableRow>\r\n                                    <TableCell sx={{ fontWeight: 600, border: 'none', py: 0.5 }}>Supplier Phone:</TableCell>\r\n                                    <TableCell sx={{ border: 'none', py: 0.5 }}>{supplier.phone}</TableCell>\r\n                                </TableRow>\r\n                            )}\r\n                        </TableBody>\r\n                    </Table>\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    {/* Items with Headers */}\r\n                    <Box mb={2}>\r\n                        <Typography variant=\"subtitle2\" fontWeight={700} color=\"text.secondary\" gutterBottom>\r\n                            Items Ordered:\r\n                        </Typography>\r\n                        <TableContainer sx={{ bgcolor: 'white', borderRadius: 1, border: '1px solid', borderColor: 'grey.300' }}>\r\n                            <Table size=\"small\">\r\n                                <TableHead>\r\n                                    <TableRow sx={{ bgcolor: 'grey.100' }}>\r\n                                        <TableCell sx={{ fontWeight: 700 }}>Product</TableCell>\r\n                                        <TableCell align=\"right\" sx={{ fontWeight: 700 }}>Quantity</TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {poItems.map((item, index) => (\r\n                                        <TableRow key={index} hover>\r\n                                            <TableCell>{item.product_name}</TableCell>\r\n                                            <TableCell align=\"right\">\r\n                                                <strong>\r\n                                                    {item.boxes_ordered\r\n                                                        ? `${item.boxes_ordered} Boxes (${item.quantity_ordered} items)`\r\n                                                        : `${item.quantity_ordered} items`\r\n                                                    }\r\n                                                </strong>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </TableContainer>\r\n                    </Box>\r\n\r\n                    {/* Notes */}\r\n                    {purchaseOrder.notes && (\r\n                        <Box mb={2}>\r\n                            <Typography variant=\"subtitle2\" fontWeight={700} color=\"text.secondary\" gutterBottom>\r\n                                Notes:\r\n                            </Typography>\r\n                            <Box sx={{ bgcolor: 'info.lighter', p: 1.5, borderRadius: 1, border: '1px dashed', borderColor: 'info.main' }}>\r\n                                <Typography variant=\"body2\">{purchaseOrder.notes}</Typography>\r\n                            </Box>\r\n                        </Box>\r\n                    )}\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    {/* Signature Area */}\r\n                    <Box mt={3}>\r\n                        <Typography variant=\"caption\" color=\"text.secondary\" display=\"block\" gutterBottom>\r\n                            Digital Signature:\r\n                        </Typography>\r\n                        <Box\r\n                            sx={{\r\n                                border: '2px dashed',\r\n                                borderColor: 'grey.400',\r\n                                borderRadius: 1,\r\n                                p: 2,\r\n                                textAlign: 'center',\r\n                                bgcolor: 'grey.100'\r\n                            }}\r\n                        >\r\n                            <Typography variant=\"body2\" color=\"text.secondary\" fontStyle=\"italic\">\r\n                                Authorized by: {settings?.owner_name || 'Store Owner'}\r\n                            </Typography>\r\n                            <Typography variant=\"caption\" color=\"text.secondary\">\r\n                                {new Date().toLocaleString()}\r\n                            </Typography>\r\n                        </Box>\r\n                    </Box>\r\n\r\n                    {/* Footer */}\r\n                    {settings?.footer_text && (\r\n                        <Box mt={2} textAlign=\"center\">\r\n                            <Typography variant=\"caption\" color=\"text.secondary\" fontStyle=\"italic\">\r\n                                {settings.footer_text}\r\n                            </Typography>\r\n                        </Box>\r\n                    )}\r\n\r\n                    {/* Branding */}\r\n                    <Box mt={2} textAlign=\"center\" pt={2} borderTop=\"1px dashed #ccc\">\r\n                        <Typography variant=\"caption\" color=\"text.secondary\" fontStyle=\"italic\">\r\n                            Receipt designed and generated by <strong>MedixFlow</strong>\r\n                        </Typography>\r\n                        <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\r\n                            Contact: +923089020131\r\n                        </Typography>\r\n                    </Box>\r\n                </Paper>\r\n            </DialogContent>\r\n\r\n            <DialogActions sx={{ p: 2, flexDirection: 'column', gap: 1, bgcolor: 'grey.50' }}>\r\n                <Box display=\"flex\" gap={1} width=\"100%\" flexWrap=\"wrap\" justifyContent=\"center\">\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        startIcon={<WhatsApp />}\r\n                        onClick={handleWhatsApp}\r\n                        fullWidth={isMobile}\r\n                        sx={{ bgcolor: '#25D366', '&:hover': { bgcolor: '#1fb855' } }}\r\n                    >\r\n                        Send via WhatsApp\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Download />}\r\n                        onClick={handleDownloadPDF}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        Download PDF\r\n                    </Button>\r\n                </Box>\r\n                <Box display=\"flex\" gap={1} width=\"100%\" flexWrap=\"wrap\" justifyContent=\"center\">\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Print />}\r\n                        onClick={handlePrint}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        Print\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Share />}\r\n                        onClick={handleShare}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        Share\r\n                    </Button>\r\n                </Box>\r\n                <Button onClick={onClose} fullWidth variant=\"text\" sx={{ mt: 1 }}>\r\n                    Close\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport {\r\n    Container,\r\n    Card,\r\n    CardContent,\r\n    Typography,\r\n    Button,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Box,\r\n    Chip,\r\n    TextField,\r\n    InputAdornment,\r\n    MenuItem,\r\n    IconButton,\r\n    Tooltip,\r\n    useTheme,\r\n    useMediaQuery,\r\n    TablePagination,\r\n} from '@mui/material';\r\nimport {\r\n    Add,\r\n    Search,\r\n    Visibility,\r\n    Edit,\r\n    Send,\r\n    CheckCircle,\r\n    Cancel,\r\n    LocalShipping,\r\n    PendingActions,\r\n    Delete,\r\n    Keyboard,\r\n} from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { formatCurrency } from '../../utils/formatters';\r\nimport CreateEditPODialog from './CreateEditPODialog';\r\nimport PODetailDialog from './PODetailDialog';\r\nimport POReceiptModal from './POReceiptModal';\r\nimport useSettings from '../../hooks/useSettings';\r\nimport useKeyboardShortcuts from '../../hooks/useKeyboardShortcuts';\r\nimport { useKeyboard } from '../../contexts/KeyboardContext';\r\n\r\nexport default function PurchaseOrdersPage() {\r\n    const { settings } = useSettings();\r\n    const { toggleHelp } = useKeyboard();\r\n    const theme = useTheme();\r\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\r\n\r\n    const [purchaseOrders, setPurchaseOrders] = useState([]);\r\n    const [suppliers, setSuppliers] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Filter states\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('all');\r\n    const [supplierFilter, setSupplierFilter] = useState('all');\r\n\r\n    // Pagination states\r\n    const [page, setPage] = useState(0);\r\n    const [rowsPerPage, setRowsPerPage] = useState(25);\r\n    const [totalCount, setTotalCount] = useState(0);\r\n\r\n    // Dialog states\r\n    const [createDialogOpen, setCreateDialogOpen] = useState(false);\r\n    const [detailDialogOpen, setDetailDialogOpen] = useState(false);\r\n    const [selectedPO, setSelectedPO] = useState(null);\r\n    const [receiptModalOpen, setReceiptModalOpen] = useState(false);\r\n    const [receiptData, setReceiptData] = useState({ po: null, items: [], supplier: null });\r\n\r\n    const searchInputRef = useRef(null);\r\n\r\n    useKeyboardShortcuts({\r\n        'Alt+n': () => handleCreateNew(),\r\n        'Alt+f': () => searchInputRef.current?.focus(),\r\n    }, 'Purchase Orders Page');\r\n\r\n    useEffect(() => {\r\n        fetchPurchaseOrders();\r\n        fetchSuppliers();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const delayDebounceFn = setTimeout(() => {\r\n            fetchPurchaseOrders();\r\n        }, 500);\r\n\r\n        return () => clearTimeout(delayDebounceFn);\r\n    }, [searchQuery, statusFilter, supplierFilter, page, rowsPerPage]);\r\n\r\n    useEffect(() => {\r\n        fetchSuppliers();\r\n    }, []);\r\n\r\n    const fetchPurchaseOrders = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) return;\r\n\r\n            let query = supabase\r\n                .from('purchase_orders')\r\n                .select(`\r\n                    *,\r\n                    suppliers(name, phone, supplier_contacts(*))\r\n                `, { count: 'exact' })\r\n                .eq('organization_id', session.user.id)\r\n                .is('deleted_at', null)\r\n                .order('created_at', { ascending: false });\r\n\r\n            // Apply filters\r\n            if (searchQuery) {\r\n                query = query.ilike('po_number', `%${searchQuery}%`);\r\n            }\r\n\r\n            if (statusFilter !== 'all') {\r\n                query = query.eq('status', statusFilter);\r\n            }\r\n\r\n            if (supplierFilter !== 'all') {\r\n                query = query.eq('supplier_id', supplierFilter);\r\n            }\r\n\r\n            const from = page * rowsPerPage;\r\n            const to = from + rowsPerPage - 1;\r\n\r\n            const { data, count, error } = await query.range(from, to);\r\n\r\n            if (error) throw error;\r\n            setPurchaseOrders(data || []);\r\n            setTotalCount(count || 0);\r\n        } catch (error) {\r\n            console.error('Error fetching POs:', error);\r\n            toast.error('Failed to load purchase orders');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const fetchSuppliers = async () => {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session) return;\r\n\r\n        const { data, error } = await supabase\r\n            .from('suppliers')\r\n            .select('*, supplier_contacts(*)')\r\n            .eq('organization_id', session.user.id)\r\n            .is('deleted_at', null)\r\n            .order('name');\r\n\r\n        if (error) {\r\n            console.error('Error fetching suppliers:', error);\r\n        } else {\r\n            setSuppliers(data || []);\r\n        }\r\n    };\r\n\r\n    const handleChangePage = (event, newPage) => {\r\n        setPage(newPage);\r\n    };\r\n\r\n    const handleChangeRowsPerPage = (event) => {\r\n        setRowsPerPage(parseInt(event.target.value, 10));\r\n        setPage(0);\r\n    };\r\n\r\n    const getStatusColor = (status) => {\r\n        const colors = {\r\n            draft: 'default',\r\n            sent: 'primary',\r\n            partially_received: 'secondary',\r\n            received: 'success',\r\n        };\r\n        return colors[status] || 'default';\r\n    };\r\n\r\n    const getStatusIcon = (status) => {\r\n        const icons = {\r\n            draft: <Edit fontSize=\"small\" />,\r\n            sent: <Send fontSize=\"small\" />,\r\n            partially_received: <LocalShipping fontSize=\"small\" />,\r\n            received: <CheckCircle fontSize=\"small\" />,\r\n        };\r\n        return icons[status];\r\n    };\r\n\r\n    const getStatusLabel = (status) => {\r\n        const labels = {\r\n            draft: 'Draft',\r\n            sent: 'Sent',\r\n            partially_received: 'Receiving',\r\n            received: 'Completed',\r\n        };\r\n        return labels[status] || status;\r\n    };\r\n\r\n    const handleViewDetails = (po) => {\r\n        setSelectedPO(po);\r\n        setDetailDialogOpen(true);\r\n    };\r\n\r\n    const handleEdit = (po) => {\r\n        setSelectedPO(po);\r\n        setCreateDialogOpen(true);\r\n    };\r\n\r\n    const handleCreateNew = () => {\r\n        setSelectedPO(null);\r\n        setCreateDialogOpen(true);\r\n    };\r\n\r\n    const handleDialogClose = (newPO, items, supplier) => {\r\n        setCreateDialogOpen(false);\r\n\r\n        // If PO was created (not edited), show receipt modal\r\n        if (newPO && items && supplier) {\r\n            setReceiptData({ po: newPO, items, supplier });\r\n            setReceiptModalOpen(true);\r\n        }\r\n\r\n        setSelectedPO(null);\r\n        fetchPurchaseOrders();\r\n    };\r\n\r\n    const handleDelete = async (po) => {\r\n        if (!window.confirm(`Are you sure you want to delete PO ${po.po_number}?`)) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const { error } = await supabase\r\n                .from('purchase_orders')\r\n                .update({ deleted_at: new Date().toISOString() })\r\n                .eq('id', po.id);\r\n\r\n            if (error) throw error;\r\n\r\n            toast.success('Purchase order deleted!');\r\n            fetchPurchaseOrders();\r\n        } catch (error) {\r\n            console.error('Error deleting PO:', error);\r\n            toast.error('Failed to delete purchase order');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Container maxWidth=\"xl\">\r\n            <Box\r\n                display=\"flex\"\r\n                flexDirection={isMobile ? 'column' : 'row'}\r\n                justifyContent=\"space-between\"\r\n                alignItems={isMobile ? 'flex-start' : 'center'}\r\n                gap={2}\r\n                mb={3}\r\n            >\r\n                <Typography variant=\"h4\" fontWeight={700} color=\"primary\">\r\n                    Purchase Orders\r\n                </Typography>\r\n                <Box display=\"flex\" gap={1}>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Keyboard />}\r\n                        onClick={toggleHelp}\r\n                        size={isMobile ? 'small' : 'medium'}\r\n                    >\r\n                        Shortcuts\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        startIcon={<Add />}\r\n                        onClick={handleCreateNew}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        New Purchase Order (Alt+n)\r\n                    </Button>\r\n                </Box>\r\n            </Box>\r\n\r\n            {/* Filters */}\r\n            <Card sx={{ mb: 3 }}>\r\n                <CardContent>\r\n                    <Box display=\"flex\" gap={2} flexWrap=\"wrap\">\r\n                        <TextField\r\n                            label=\"Search PO (Alt+f)\"\r\n                            inputRef={searchInputRef}\r\n                            value={searchQuery}\r\n                            onChange={(e) => setSearchQuery(e.target.value)}\r\n                            size=\"small\"\r\n                            sx={{ minWidth: 250 }}\r\n                            InputProps={{\r\n                                startAdornment: (\r\n                                    <InputAdornment position=\"start\">\r\n                                        <Search />\r\n                                    </InputAdornment>\r\n                                ),\r\n                            }}\r\n                        />\r\n                        <TextField\r\n                            select\r\n                            label=\"Status\"\r\n                            value={statusFilter}\r\n                            onChange={(e) => setStatusFilter(e.target.value)}\r\n                            size=\"small\"\r\n                            sx={{ minWidth: 150 }}\r\n                        >\r\n                            <MenuItem value=\"all\">All Status</MenuItem>\r\n                            <MenuItem value=\"draft\">Draft</MenuItem>\r\n                            <MenuItem value=\"sent\">Sent</MenuItem>\r\n                            <MenuItem value=\"partially_received\">Receiving</MenuItem>\r\n                            <MenuItem value=\"received\">Completed</MenuItem>\r\n                        </TextField>\r\n                        <TextField\r\n                            select\r\n                            label=\"Supplier\"\r\n                            value={supplierFilter}\r\n                            onChange={(e) => setSupplierFilter(e.target.value)}\r\n                            size=\"small\"\r\n                            sx={{ minWidth: 200 }}\r\n                        >\r\n                            <MenuItem value=\"all\">All Suppliers</MenuItem>\r\n                            {suppliers.map((supplier) => (\r\n                                <MenuItem key={supplier.id} value={supplier.id}>\r\n                                    {supplier.name}\r\n                                </MenuItem>\r\n                            ))}\r\n                        </TextField>\r\n                    </Box>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Purchase Orders Table */}\r\n            <Card>\r\n                <TableContainer sx={{ overflowX: 'auto', maxWidth: '100%' }}>\r\n                    <Table sx={{ minWidth: 900 }}>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell><strong>PO Number</strong></TableCell>\r\n                                <TableCell><strong>Supplier</strong></TableCell>\r\n                                <TableCell><strong>Order Date</strong></TableCell>\r\n                                <TableCell><strong>Status</strong></TableCell>\r\n                                <TableCell align=\"right\"><strong>Total Amount</strong></TableCell>\r\n                                <TableCell align=\"right\"><strong>Actions</strong></TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {loading ? (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={6} align=\"center\">Loading...</TableCell>\r\n                                </TableRow>\r\n                            ) : purchaseOrders.length === 0 ? (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={6} align=\"center\">\r\n                                        No purchase orders found\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            ) : (\r\n                                purchaseOrders.map((po) => (\r\n                                    <TableRow key={po.id} hover>\r\n                                        <TableCell>\r\n                                            <Typography variant=\"body2\" fontWeight={600}>\r\n                                                {po.po_number}\r\n                                            </Typography>\r\n                                        </TableCell>\r\n                                        <TableCell>{po.suppliers?.name || ''}</TableCell>\r\n                                        <TableCell>\r\n                                            {new Date(po.order_date).toLocaleDateString()}\r\n                                        </TableCell>\r\n                                        <TableCell>\r\n                                            <Chip\r\n                                                icon={getStatusIcon(po.status)}\r\n                                                label={getStatusLabel(po.status)}\r\n                                                color={getStatusColor(po.status)}\r\n                                                size=\"small\"\r\n                                            />\r\n                                        </TableCell>\r\n                                        <TableCell align=\"right\">\r\n                                            <Typography variant=\"body2\" fontWeight={600}>\r\n                                                {settings?.currency_symbol || 'Rs'}\r\n                                                {formatCurrency(po.final_amount || po.total_amount, '')}\r\n                                            </Typography>\r\n                                        </TableCell>\r\n                                        <TableCell align=\"right\">\r\n                                            <Box display=\"flex\" gap={1} justifyContent=\"flex-end\">\r\n                                                <Tooltip title=\"View Details\">\r\n                                                    <IconButton\r\n                                                        size=\"small\"\r\n                                                        color=\"primary\"\r\n                                                        onClick={() => handleViewDetails(po)}\r\n                                                    >\r\n                                                        <Visibility fontSize=\"small\" />\r\n                                                    </IconButton>\r\n                                                </Tooltip>\r\n                                                {po.status === 'draft' && (\r\n                                                    <>\r\n                                                        <Tooltip title=\"Edit\">\r\n                                                            <IconButton\r\n                                                                size=\"small\"\r\n                                                                color=\"secondary\"\r\n                                                                onClick={() => handleEdit(po)}\r\n                                                            >\r\n                                                                <Edit fontSize=\"small\" />\r\n                                                            </IconButton>\r\n                                                        </Tooltip>\r\n                                                        <Tooltip title=\"Delete\">\r\n                                                            <IconButton\r\n                                                                size=\"small\"\r\n                                                                color=\"error\"\r\n                                                                onClick={() => handleDelete(po)}\r\n                                                            >\r\n                                                                <Delete fontSize=\"small\" />\r\n                                                            </IconButton>\r\n                                                        </Tooltip>\r\n                                                    </>\r\n                                                )}\r\n                                            </Box>\r\n                                        </TableCell>\r\n                                    </TableRow>\r\n                                ))\r\n                            )}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n            </Card>\r\n\r\n            <TablePagination\r\n                rowsPerPageOptions={[10, 25, 50, 100]}\r\n                component=\"div\"\r\n                count={totalCount}\r\n                rowsPerPage={rowsPerPage}\r\n                page={page}\r\n                onPageChange={handleChangePage}\r\n                onRowsPerPageChange={handleChangeRowsPerPage}\r\n            />\r\n\r\n            {/* Dialogs */}\r\n            <CreateEditPODialog\r\n                open={createDialogOpen}\r\n                onClose={handleDialogClose}\r\n                purchaseOrder={selectedPO}\r\n                suppliers={suppliers}\r\n            />\r\n\r\n            <PODetailDialog\r\n                open={detailDialogOpen}\r\n                onClose={() => setDetailDialogOpen(false)}\r\n                purchaseOrder={selectedPO}\r\n                onRefresh={fetchPurchaseOrders}\r\n            />\r\n\r\n            <POReceiptModal\r\n                open={receiptModalOpen}\r\n                onClose={() => setReceiptModalOpen(false)}\r\n                purchaseOrder={receiptData.po}\r\n                poItems={receiptData.items}\r\n                supplier={receiptData.supplier}\r\n                settings={settings}\r\n            />\r\n        </Container>\r\n    );\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z\"\n}), 'Add');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z\"\n}), 'Edit');","/**\r\n * Generates a WhatsApp URL for ordering a product\r\n * @param {string} phone - Supplier's phone number\r\n * @param {string} productName - Name of the product\r\n * @param {number} currentStock - Current stock level\r\n * @param {string} storeName - Name of the medical store (optional)\r\n * @returns {string|null} - WhatsApp URL or null if no phone provided\r\n */\r\nexport const generateWhatsAppLink = (phone, productName, currentStock, storeName = 'Medical Store') => {\r\n    if (!phone) return null;\r\n\r\n    // Remove non-numeric characters from phone\r\n    const cleanPhone = phone.replace(/\\D/g, '');\r\n\r\n    const message = `Hi, this is ${storeName}. We need to order \"${productName}\". Current stock is ${currentStock}. Please let us know availability and price.`;\r\n\r\n    const encodedMessage = encodeURIComponent(message);\r\n\r\n    return `https://wa.me/${cleanPhone}?text=${encodedMessage}`;\r\n};\r\n\r\n/**\r\n * Opens WhatsApp in a new tab\r\n * @param {string} phone - Supplier's phone number\r\n * @param {string} productName - Name of the product\r\n * @param {number} currentStock - Current stock level\r\n * @param {string} storeName - Name of the medical store\r\n */\r\nexport const openWhatsAppOrder = (phone, productName, currentStock, storeName) => {\r\n    const url = generateWhatsAppLink(phone, productName, currentStock, storeName);\r\n    if (url) {\r\n        window.open(url, '_blank');\r\n    } else {\r\n        alert('Supplier phone number is missing!');\r\n    }\r\n};\r\n\r\n/**\r\n * Opens WhatsApp with a custom message\r\n * @param {string} phone - Phone number\r\n * @param {string} message - Message to send\r\n */\r\nexport const openWhatsApp = (phone, message) => {\r\n    if (!phone) {\r\n        alert('Phone number is missing!');\r\n        return;\r\n    }\r\n\r\n    // Remove non-numeric characters from phone\r\n    const cleanPhone = phone.replace(/\\D/g, '');\r\n    const encodedMessage = encodeURIComponent(message);\r\n    const url = `https://wa.me/${cleanPhone}?text=${encodedMessage}`;\r\n\r\n    window.open(url, '_blank');\r\n};\r\n\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"\n}), 'CheckCircle');"],"names":["createSvgIcon","_jsx","d","formatCurrency","value","symbol","arguments","length","undefined","isNaN","concat","num","Number","toLocaleString","minimumFractionDigits","maximumFractionDigits","formatNumber","formatPercentage","decimals","toFixed","CreateEditPODialog","_ref","open","onClose","purchaseOrder","suppliers","isEdit","theme","useTheme","isMobile","useMediaQuery","breakpoints","down","formData","setFormData","useState","supplier_id","order_date","Date","toISOString","split","notes","items","setItems","products","setProducts","loading","setLoading","useEffect","fetchProducts","loadPOData","resetForm","async","data","session","supabase","auth","getSession","from","select","eq","user","id","is","order","map","item","_item$products","product_id","product_name","name","quantity_ordered","boxes_ordered","items_per_box","handleChange","e","_objectSpread","target","handleAddItem","handleRemoveItem","index","filter","_","i","handleItemChange","field","newItems","product","find","p","boxes","perBox","parseInt","handleKeyDown","key","shiftKey","preventDefault","_jsxs","Dialog","maxWidth","fullWidth","children","DialogTitle","Box","display","alignItems","gap","ShoppingCart","color","DialogContent","Grid","container","spacing","sx","mt","xs","sm","TextField","required","label","onChange","supplier","MenuItem","type","InputLabelProps","shrink","Divider","my","justifyContent","mb","Typography","variant","Button","startIcon","Add","onClick","Card","CardContent","fontWeight","IconButton","size","Delete","fontSize","Autocomplete","options","getOptionLabel","option","newValue","renderInput","params","placeholder","onKeyDown","inputProps","min","helperText","TableContainer","Table","TableHead","TableRow","TableCell","width","TableBody","multiline","rows","bgcolor","borderRadius","DialogActions","some","toast","error","Error","poError","update","updated_at","delete","itemsError","insert","purchase_order_id","unit_price","success","poNumberData","rpc","poNumber","now","newPO","po_number","currency_id","status","created_by","organization_id","total_amount","final_amount","single","itemsWithNames","_products$find","s","console","message","disabled","ReceiveStockDialog","poItems","receivingData","setReceivingData","receivedDate","setReceivedDate","setNotes","fetchProductDetails","productIds","in","productMap","forEach","po_item_id","quantity_already_received","quantity_received","quantity_remaining","quantity_to_receive","cost_price","selling_price","price","boxes_received","cost_per_box","total_cost","selling_price_per_box","total_selling_price","handleQuantityChange","newData","parseFloat","totalQty","Math","round","maxReceivable","qty","handlePriceChange","totalItems","totalCost","sellBox","totalToReceive","reduce","sum","totalAmount","LocalShipping","overflowX","maxHeight","stickyHeader","align","Chip","style","textAlign","step","handleReceiveAll","Inventory","itemsToReceive","stockReceipt","receiptError","quantity","received_date","currentProduct","fetchError","newStock","stock","updateError","price_per_box","poItemError","received_by","stock_receipt_id","every","generatePOPDF","po","settings","_po$suppliers","_po$suppliers2","doc","jsPDF","storeName","store_name","orderDate","toLocaleDateString","supplierName","supplierPhone","phone","Array","isArray","setFontSize","setFont","text","yPos","address","owner_name","setLineWidth","line","infoY","tableColumn","tableRows","productName","toString","autoTable","head","body","startY","headStyles","fillColor","fontStyle","styles","columnStyles","cellWidth","halign","finalY","lastAutoTable","splitText","splitTextToSize","addPage","pageHeight","internal","pageSize","height","setTextColor","footerY","footer_text","output","PODetailDialog","_poDetails$suppliers3","_poDetails$suppliers4","onRefresh","poDetails","setPODetails","setPOItems","receivingHistory","setReceivingHistory","receiveDialogOpen","setReceiveDialogOpen","fetchPODetails","history","historyError","ascending","_Fragment","Close","flexWrap","draft","sent","partially_received","received","getStatusColor","expected_delivery_date","gutterBottom","flex","Tooltip","title","settingsData","pdfBlob","url","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","Download","Send","_poDetails$suppliers","_poDetails$suppliers$","_poDetails$suppliers2","info","pdfError","warning","sent_at","primaryContact","supplier_contacts","c","is_primary","setTimeout","openWhatsApp","handleReceiveStock","handleReceiveDialogClose","printPO","currency_symbol","receiptHTML","join","printWindow","window","write","close","POReceiptModal","CheckCircle","Paper","elevation","border","borderColor","borderWidth","py","hover","pt","borderTop","flexDirection","WhatsApp","_supplier$supplier_co","_supplier$supplier_co2","loadingToast","imageBlob","element","getElementById","canvas","html2canvas","scale","backgroundColor","logging","Promise","resolve","toBlob","blob","handleGenerateImage","imageFile","File","navigator","share","canShare","files","render","isLoading","autoClose","dismiss","Print","handlePrint","Share","clipboard","writeText","PurchaseOrdersPage","useSettings","toggleHelp","useKeyboard","purchaseOrders","setPurchaseOrders","setSuppliers","searchQuery","setSearchQuery","statusFilter","setStatusFilter","supplierFilter","setSupplierFilter","page","setPage","rowsPerPage","setRowsPerPage","totalCount","setTotalCount","createDialogOpen","setCreateDialogOpen","detailDialogOpen","setDetailDialogOpen","selectedPO","setSelectedPO","receiptModalOpen","setReceiptModalOpen","receiptData","setReceiptData","searchInputRef","useRef","useKeyboardShortcuts","Alt+n","handleCreateNew","Alt+f","_searchInputRef$curre","current","focus","fetchPurchaseOrders","fetchSuppliers","delayDebounceFn","clearTimeout","query","count","ilike","to","range","getStatusLabel","Container","Keyboard","inputRef","minWidth","InputProps","startAdornment","InputAdornment","position","Search","colSpan","icon","Edit","handleViewDetails","Visibility","handleEdit","confirm","deleted_at","handleDelete","TablePagination","rowsPerPageOptions","component","onPageChange","handleChangePage","event","newPage","onRowsPerPageChange","handleDialogClose","openWhatsAppOrder","currentStock","cleanPhone","replace","encodedMessage","encodeURIComponent","generateWhatsAppLink","alert"],"sourceRoot":""}