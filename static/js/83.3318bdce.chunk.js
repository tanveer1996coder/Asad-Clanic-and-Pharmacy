"use strict";(self.webpackChunksupabase_sales_app=self.webpackChunksupabase_sales_app||[]).push([[83],{12807:(e,t,r)=>{function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PKR";if(null===e||void 0===e||isNaN(e))return"".concat(t," 0.00");const r=Number(e);return"".concat(t," ").concat(r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))}function o(e){return null===e||void 0===e||isNaN(e)?"0":Number(e).toLocaleString("en-US")}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null===e||void 0===e||isNaN(e)?"0%":"".concat(Number(e).toFixed(t),"%")}r.d(t,{Ee:()=>i,ZV:()=>o,vv:()=>n})},29347:(e,t,r)=>{r.d(t,{A:()=>A});var n=r(98587),o=r(58168),i=r(65043),s=r(58387),l=r(98610),a=r(34535),c=r(98206),d=r(92532),u=r(72372);function p(e){return(0,u.Ay)("MuiDialogActions",e)}(0,d.A)("MuiDialogActions",["root","spacing"]);var h=r(70579);const m=["className","disableSpacing"],x=(0,a.Ay)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableSpacing&&t.spacing]}})(e=>{let{ownerState:t}=e;return(0,o.A)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})}),A=i.forwardRef(function(e,t){const r=(0,c.b)({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:a=!1}=r,d=(0,n.A)(r,m),u=(0,o.A)({},r,{disableSpacing:a}),A=(e=>{const{classes:t,disableSpacing:r}=e,n={root:["root",!r&&"spacing"]};return(0,l.A)(n,p,t)})(u);return(0,h.jsx)(x,(0,o.A)({className:(0,s.A)(A.root,i),ownerState:u,ref:t},d))})},34642:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(59662),o=r(70579);const i=(0,n.A)((0,o.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")},43243:(e,t,r)=>{r.d(t,{V0:()=>a,Yq:()=>i,fU:()=>s,go:()=>l,t6:()=>c});var n=r(82125),o=r(98920);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MMM dd, yyyy";if(!e)return"\u2014";try{const r="string"===typeof e?(0,o.A)(e):e;return(0,n.A)(r,t)}catch(r){return console.error("Error formatting date:",r),String(e)}}function s(e){if(!e)return"\u2014";try{const t="string"===typeof e?(0,o.A)(e):e;return(0,n.A)(t,"h:mm a")}catch(t){return console.error("Error formatting time:",t),String(e)}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;const n=function(e){if(!e)return null;try{const t="string"===typeof e?new Date(e):e,r=new Date;r.setHours(0,0,0,0),t.setHours(0,0,0,0);const n=t-r;return Math.ceil(n/864e5)}catch(t){return console.error("Error calculating days until expiry:",t),null}}(e);return null===n?{type:"unknown",color:"default",label:"No expiry date"}:n<0?{type:"expired",color:"error",label:"Expired",days:n}:n<=t?{type:"urgent",color:"error",label:"".concat(n," days left"),days:n}:n<=r?{type:"warning",color:"warning",label:"".concat(n," days left"),days:n}:{type:"ok",color:"success",label:"Good",days:n}}function a(e){return 0===e?{type:"out",color:"error",label:"Out of stock"}:e<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:10)?{type:"low",color:"warning",label:"Low stock"}:{type:"ok",color:"success",label:"In stock"}}function c(e){const t=new Date;return t.setDate(t.getDate()-e),(0,n.A)(t,"yyyy-MM-dd")}},51387:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(59662),o=r(70579);const i=(0,n.A)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},60931:(e,t,r)=>{r.d(t,{A:()=>u});r(65043);var n=r(90035),o=r(26600),i=r(35316),s=r(98533),l=r(29347),a=r(11906),c=r(34642),d=r(70579);function u(e){let{open:t,onClose:r,onConfirm:u,title:p="Confirm Delete",content:h="Are you sure you want to delete this item? This action cannot be undone.",confirmText:m="Delete",cancelText:x="Cancel"}=e;return(0,d.jsxs)(n.A,{open:t,onClose:r,"aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-description",children:[(0,d.jsxs)(o.A,{id:"confirm-dialog-title",sx:{display:"flex",alignItems:"center",gap:1},children:[(0,d.jsx)(c.A,{color:"error"}),p]}),(0,d.jsx)(i.A,{children:(0,d.jsx)(s.A,{id:"confirm-dialog-description",children:h})}),(0,d.jsxs)(l.A,{children:[(0,d.jsx)(a.A,{onClick:r,color:"primary",children:x}),(0,d.jsx)(a.A,{onClick:u,color:"error",variant:"contained",autoFocus:!0,children:m})]})]})}},62083:(e,t,r)=>{r.r(t),r.d(t,{default:()=>oe});var n=r(89379),o=r(65043),i=r(35475),s=r(26240),l=r(30344),a=r(19252),c=r(96446),d=r(85865),u=r(11906),p=r(43845),h=r(12110),m=r(26494),x=r(5146),A=r(51787),g=r(17392),_=r(77739),j=r(79650),y=r(71806),f=r(84882),b=r(28076),v=r(10039),S=r(73460),k=r(19090),w=r(90035),C=r(26600),P=r(35316),I=r(68903),N=r(39336),z=r(32143),D=r(29347),W=r(17673),T=r(70141),M=r(34642),E=r(33438),R=r(79484),F=r(83560),O=r(51387),L=r(59662),q=r(70579);const V=(0,L.A)((0,q.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");var H=r(98606),U=r(61560),B=r(47503),Y=r(27001),Z=r(12807),G=r(43243),K=r(11737),Q=r(60931),X=r(80045),J=r(27108),$=r(81637);const ee=["onSelect","label"];function te(e){let{onSelect:t,label:r="Search Medicine Database"}=e,i=(0,X.A)(e,ee);const[s,l]=(0,o.useState)(!1),[a,u]=(0,o.useState)([]),[p,h]=(0,o.useState)(!1),[m,A]=(0,o.useState)(""),[g,_]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(!s)return void u([]);if(m.length<2)return void u([]);const e=setTimeout(async()=>{h(!0);try{const{data:e,error:t}=await Y.N.from("medicine_reference").select("*").or("brand_name.ilike.%".concat(m,"%,generic_name.ilike.%").concat(m,"%")).limit(20);if(t)throw t;u(e||[])}catch(e){console.error("Error searching medicines:",e),u([])}finally{h(!1)}},300);return()=>clearTimeout(e)},[m,s]),(0,q.jsx)(J.A,(0,n.A)({value:g,open:s,onOpen:()=>l(!0),onClose:()=>l(!1),options:a,loading:p,getOptionLabel:e=>{const t=[e.brand_name];return e.strength&&t.push(e.strength),e.generic_name&&t.push("(".concat(e.generic_name,")")),t.join(" ")},onInputChange:(e,t)=>{A(t)},onChange:(e,r)=>{_(r),r&&t&&t(r)},renderInput:e=>(0,q.jsx)(x.A,(0,n.A)((0,n.A)({},e),{},{label:r,placeholder:"Type to search...",InputProps:(0,n.A)((0,n.A)({},e.InputProps),{},{endAdornment:(0,q.jsxs)(q.Fragment,{children:[p?(0,q.jsx)($.A,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})})),renderOption:(e,t)=>(0,q.jsx)(c.A,(0,n.A)((0,n.A)({component:"li"},e),{},{children:(0,q.jsxs)(c.A,{children:[(0,q.jsx)(d.A,{variant:"body2",fontWeight:600,children:t.brand_name}),(0,q.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:[t.generic_name," \u2022 ",t.strength," \u2022 ",t.dosage_form]})]})})),noOptionsText:m.length<2?"Type at least 2 characters to search":"No medicines found"},i))}var re=r(90990),ne=r(8649);function oe(){const{settings:e}=(0,K.A)(),{toggleHelp:t}=(0,ne.d)(),[r,L]=(0,i.ok)(),[X,J]=(0,o.useState)([]),[$,ee]=(0,o.useState)([]),[oe,ie]=(0,o.useState)(!0),[se,le]=(0,o.useState)(""),[ae,ce]=(0,o.useState)(0),[de,ue]=(0,o.useState)(25),[pe,he]=(0,o.useState)(0),[me,xe]=(0,o.useState)(!1),[Ae,ge]=(0,o.useState)(null),[_e,je]=(0,o.useState)(!1),[ye,fe]=(0,o.useState)(null),[be,ve]=(0,o.useState)(null),[Se,ke]=(0,o.useState)({name:"",generic_name:"",drug_type:"",strength:"",price:"",cost_price:"",stock:"",min_stock_level:e.low_stock_threshold||"10",expiry_date:"",supplier_id:"",form:"",batch_number:"",items_per_box:"1",price_per_box:"",selling_unit:"item"}),we=(0,o.useRef)(null);async function Ce(){ie(!0);try{const{data:{session:t}}=await Y.N.auth.getSession();if(!t)return B.oR.error("Please log in to view products"),void ie(!1);const r=t.user.id;let n=Y.N.from("products").select("*, suppliers(name)",{count:"exact"}).eq("organization_id",r).is("deleted_at",null).order("created_at",{ascending:!1});if(se&&(n=n.or("name.ilike.%".concat(se,"%,form.ilike.%").concat(se,"%,batch_number.ilike.%").concat(se,"%"))),"lowStock"===be){const{data:e}=await Y.N.from("products").select("*").eq("organization_id",r).is("deleted_at",null),t=(null===e||void 0===e?void 0:e.filter(e=>e.stock<=(e.min_stock_level||10)).map(e=>e.id))||[];if(!(t.length>0))return J([]),he(0),void ie(!1);n=n.in("id",t)}else if("nearExpiry"===be){const t=parseInt(e.expiry_alert_days||"15"),r=new Date;r.setDate(r.getDate()+t);const o=r.toISOString().split("T")[0];n=n.not("expiry_date","is",null).lte("expiry_date",o)}const o=ae*de,i=o+de-1,{data:s,count:l,error:a}=await n.range(o,i);if(a)throw a;J(s||[]),he(l||0)}catch(t){console.error("Error fetching products:",t),B.oR.error("Failed to load products")}finally{ie(!1)}}(0,re.A)({"Alt+n":()=>Pe(),"Alt+f":()=>{var e;return null===(e=we.current)||void 0===e?void 0:e.focus()}},"Products Page"),(0,o.useEffect)(()=>{!async function(){const{data:{session:e}}=await Y.N.auth.getSession();if(!e)return;const t=e.user.id,{data:r}=await Y.N.from("suppliers").select("*").eq("organization_id",t).order("name");ee(r||[])}();const e=r.get("filter");e&&ve(e)},[]),(0,o.useEffect)(()=>{const e=setTimeout(()=>{Ce()},500);return()=>clearTimeout(e)},[se,ae,de,be]);const Pe=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(ge(t),ke({name:t.name||"",generic_name:t.generic_name||"",drug_type:t.drug_type||"",strength:t.strength||"",price:t.price||"",cost_price:t.cost_price||"",stock:t.stock||"",min_stock_level:t.min_stock_level||e.low_stock_threshold||"10",expiry_date:t.expiry_date||"",supplier_id:t.supplier_id||"",form:t.form||"",batch_number:t.batch_number||"",items_per_box:t.items_per_box||"1",price_per_box:t.price_per_box||"",selling_unit:t.selling_unit||"item"})):(ge(null),ke({name:"",generic_name:"",drug_type:"",strength:"",price:"",cost_price:"",stock:"",min_stock_level:e.low_stock_threshold||"10",expiry_date:"",supplier_id:"",form:"",batch_number:"",items_per_box:"1",price_per_box:"",selling_unit:"item"})),xe(!0)},Ie=()=>{xe(!1),ge(null)},Ne=e=>{if(!e)return null;const t=e.match(/(\d+)\s*(tablets?|items?|capsules?)/i);return t?parseInt(t[1]):null},ze=e=>{ke((0,n.A)((0,n.A)({},Se),{},{[e.target.name]:e.target.value}))},De=e=>{fe(e),je(!0)},We=X,Te=(0,s.A)(),Me=(0,l.A)(Te.breakpoints.down("sm"));return(0,q.jsxs)(a.A,{maxWidth:"xl",children:[(0,q.jsxs)(c.A,{display:"flex",flexDirection:Me?"column":"row",justifyContent:"space-between",alignItems:Me?"flex-start":"center",gap:2,mb:3,children:[(0,q.jsx)(d.A,{variant:"h4",fontWeight:700,color:"primary",children:"Products"}),(0,q.jsxs)(c.A,{display:"flex",gap:1,children:[(0,q.jsx)(u.A,{variant:"outlined",startIcon:(0,q.jsx)(W.A,{}),onClick:t,size:Me?"small":"medium",children:"Shortcuts"}),(0,q.jsx)(u.A,{variant:"contained",startIcon:(0,q.jsx)(T.A,{}),onClick:()=>Pe(),fullWidth:Me,children:"Add Product (Alt+n)"})]})]}),be&&(0,q.jsx)(c.A,{mb:2,children:(0,q.jsx)(p.A,{label:"lowStock"===be?"Low Stock Filter Active":"Near Expiry Filter Active",color:"lowStock"===be?"warning":"error",icon:(0,q.jsx)(M.A,{}),onDelete:()=>{ve(null),L({})},deleteIcon:(0,q.jsx)(E.A,{})})}),(0,q.jsx)(h.A,{sx:{mb:3},children:(0,q.jsx)(m.A,{children:(0,q.jsx)(x.A,{fullWidth:!0,inputRef:we,placeholder:"Search products by name, form, or batch number... (Alt+f)",value:se,onChange:e=>le(e.target.value),InputProps:{startAdornment:(0,q.jsx)(A.A,{position:"start",children:(0,q.jsx)(R.A,{})})}})})}),Me?(0,q.jsx)(c.A,{children:oe?(0,q.jsx)(d.A,{align:"center",children:"Loading..."}):0===We.length?(0,q.jsx)(d.A,{align:"center",children:"No products found"}):We.map(t=>{var r;const n=t.expiry_date?(0,G.go)(t.expiry_date,7,parseInt(e.expiry_alert_days||"15")):null,o=(0,G.V0)(t.stock,t.min_stock_level);return(0,q.jsx)(h.A,{variant:"outlined",sx:{mb:2},children:(0,q.jsxs)(m.A,{children:[(0,q.jsxs)(c.A,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1,children:[(0,q.jsxs)(c.A,{children:[(0,q.jsx)(d.A,{variant:"h6",fontWeight:600,children:t.name}),t.generic_name&&(0,q.jsx)(d.A,{variant:"caption",color:"text.secondary",display:"block",children:t.generic_name}),t.batch_number&&(0,q.jsx)(d.A,{variant:"caption",color:"text.secondary",children:t.batch_number})]}),(0,q.jsxs)(c.A,{children:[(0,q.jsx)(g.A,{size:"small",color:"primary",onClick:()=>Pe(t),children:(0,q.jsx)(F.A,{fontSize:"small"})}),(0,q.jsx)(g.A,{size:"small",color:"error",onClick:()=>De(t.id),children:(0,q.jsx)(O.A,{fontSize:"small"})})]})]}),(0,q.jsxs)(c.A,{display:"flex",flexWrap:"wrap",gap:1,mb:2,children:[t.drug_type&&(0,q.jsx)(p.A,{label:t.drug_type,size:"small",variant:"outlined",color:"primary"}),t.form&&(0,q.jsx)(p.A,{label:t.form,size:"small",variant:"outlined"}),(0,q.jsx)(p.A,{label:"".concat((0,Z.ZV)(t.stock)," units"),size:"small",color:o.color,icon:"out"===o.type?(0,q.jsx)(V,{}):"low"===o.type?(0,q.jsx)(M.A,{}):(0,q.jsx)(H.A,{})}),n&&(0,q.jsx)(_.A,{title:"Expires: ".concat((0,G.Yq)(t.expiry_date)),children:(0,q.jsx)(p.A,{label:n.label,size:"small",color:n.color})})]}),(0,q.jsxs)(c.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,q.jsxs)(c.A,{children:[(0,q.jsxs)(d.A,{variant:"body2",color:"text.secondary",children:["Price: ",(0,q.jsx)("strong",{children:(0,Z.vv)(t.price,e.currency_symbol)})]}),t.cost_price&&(0,q.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:["Cost: ",(0,Z.vv)(t.cost_price,e.currency_symbol)]})]}),(0,q.jsx)(d.A,{variant:"caption",color:"text.secondary",children:(null===(r=t.suppliers)||void 0===r?void 0:r.name)||"No Supplier"})]})]})},t.id)})}):(0,q.jsx)(h.A,{children:(0,q.jsx)(j.A,{sx:{overflowX:"auto",maxWidth:"100%"},children:(0,q.jsxs)(y.A,{sx:{minWidth:800},children:[(0,q.jsx)(f.A,{children:(0,q.jsxs)(b.A,{children:[(0,q.jsx)(v.A,{children:(0,q.jsx)("strong",{children:"Name"})}),(0,q.jsx)(v.A,{children:(0,q.jsx)("strong",{children:"Form"})}),(0,q.jsx)(v.A,{children:(0,q.jsx)("strong",{children:"Price"})}),(0,q.jsx)(v.A,{children:(0,q.jsx)("strong",{children:"Stock"})}),(0,q.jsx)(v.A,{children:(0,q.jsx)("strong",{children:"Expiry"})}),(0,q.jsx)(v.A,{children:(0,q.jsx)("strong",{children:"Supplier"})}),(0,q.jsx)(v.A,{align:"right",children:(0,q.jsx)("strong",{children:"Actions"})})]})}),(0,q.jsx)(S.A,{children:oe?(0,q.jsx)(b.A,{children:(0,q.jsx)(v.A,{colSpan:7,align:"center",children:"Loading..."})}):0===We.length?(0,q.jsx)(b.A,{children:(0,q.jsx)(v.A,{colSpan:7,align:"center",children:"No products found"})}):We.map(t=>{var r;const n=t.expiry_date?(0,G.go)(t.expiry_date,7,parseInt(e.expiry_alert_days||"15")):null,o=(0,G.V0)(t.stock,t.min_stock_level);return(0,q.jsxs)(b.A,{hover:!0,children:[(0,q.jsxs)(v.A,{children:[(0,q.jsx)(d.A,{variant:"body2",fontWeight:600,children:t.name}),t.generic_name&&(0,q.jsx)(d.A,{variant:"caption",color:"text.secondary",display:"block",children:t.generic_name}),t.batch_number&&(0,q.jsx)(d.A,{variant:"caption",color:"text.secondary",children:t.batch_number})]}),(0,q.jsxs)(v.A,{children:[t.form&&(0,q.jsx)(p.A,{label:t.form,size:"small",variant:"outlined",color:"primary",sx:{mr:.5}}),t.strength&&(0,q.jsx)(p.A,{label:t.strength,size:"small",variant:"outlined"})]}),(0,q.jsxs)(v.A,{children:[(0,q.jsx)(d.A,{variant:"body2",children:(0,Z.vv)(t.price,e.currency_symbol)}),t.cost_price&&(0,q.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:["Cost: ",(0,Z.vv)(t.cost_price,e.currency_symbol)]})]}),(0,q.jsx)(v.A,{children:(0,q.jsx)(p.A,{label:"".concat((0,Z.ZV)(t.stock)," units"),size:"small",color:o.color,icon:"out"===o.type?(0,q.jsx)(V,{}):"low"===o.type?(0,q.jsx)(M.A,{}):(0,q.jsx)(H.A,{})})}),(0,q.jsx)(v.A,{children:n?(0,q.jsx)(_.A,{title:"Expires: ".concat((0,G.Yq)(t.expiry_date)),children:(0,q.jsx)(p.A,{label:n.label,size:"small",color:n.color})}):(0,q.jsx)(d.A,{variant:"caption",color:"text.secondary",children:"No expiry"})}),(0,q.jsx)(v.A,{children:(0,q.jsx)(d.A,{variant:"caption",children:(null===(r=t.suppliers)||void 0===r?void 0:r.name)||"\u2014"})}),(0,q.jsxs)(v.A,{align:"right",children:[(0,q.jsx)(g.A,{size:"small",color:"primary",onClick:()=>Pe(t),children:(0,q.jsx)(F.A,{})}),(0,q.jsx)(g.A,{size:"small",color:"error",onClick:()=>De(t.id),children:(0,q.jsx)(O.A,{})})]})]},t.id)})})]})})}),(0,q.jsx)(k.A,{rowsPerPageOptions:[10,25,50,100],component:"div",count:pe,rowsPerPage:de,page:ae,onPageChange:(e,t)=>{ce(t)},onRowsPerPageChange:e=>{ue(parseInt(e.target.value,10)),ce(0)}}),(0,q.jsx)(w.A,{open:me,onClose:Ie,maxWidth:"md",fullWidth:!0,children:(0,q.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),Se.name&&Se.price)try{var t,r;const{data:{session:e}}=await Y.N.auth.getSession();if(!e)return void B.oR.error("Please log in to save changes");const o={name:Se.name.trim(),generic_name:(null===(t=Se.generic_name)||void 0===t?void 0:t.trim())||null,drug_type:Se.drug_type||null,strength:(null===(r=Se.strength)||void 0===r?void 0:r.trim())||null,price:parseFloat(Se.price),cost_price:Se.cost_price?parseFloat(Se.cost_price):null,stock:Se.stock?parseInt(Se.stock):0,min_stock_level:Se.min_stock_level?parseInt(Se.min_stock_level):10,expiry_date:Se.expiry_date||null,supplier_id:Se.supplier_id||null,items_per_box:Se.items_per_box?parseInt(Se.items_per_box):1,price_per_box:Se.price_per_box?parseFloat(Se.price_per_box):null,selling_unit:Se.selling_unit||"item",form:Se.form||null,batch_number:Se.batch_number||null};if(Ae){const{error:e}=await Y.N.from("products").update(o).eq("id",Ae.id);if(e)throw e;B.oR.success("Product updated successfully!")}else{const{error:t}=await Y.N.from("products").insert([(0,n.A)((0,n.A)({},o),{},{organization_id:e.user.id})]);if(t)throw t;B.oR.success("Product added successfully!")}Ie(),Ce()}catch(o){console.error("Error saving product:",o),B.oR.error("Failed to save product: "+(o.message||"Unknown error"))}else B.oR.error("Please fill in required fields")},children:[(0,q.jsx)(C.A,{children:Ae?"Edit Product":"Add New Product"}),(0,q.jsx)(P.A,{children:(0,q.jsxs)(I.Ay,{container:!0,spacing:2,sx:{mt:1},children:[!Ae&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(I.Ay,{item:!0,xs:12,children:[(0,q.jsxs)(c.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,q.jsx)(U.A,{color:"primary",fontSize:"small"}),(0,q.jsx)(d.A,{variant:"body2",color:"primary",fontWeight:600,children:"Search Medicine Database (Optional)"})]}),(0,q.jsx)(te,{onSelect:e=>{ke(t=>(0,n.A)((0,n.A)({},t),{},{name:e.brand_name||"",generic_name:e.generic_name||"",form:e.dosage_form||"",strength:e.strength||"",drug_type:e.dosage_form?e.dosage_form.charAt(0).toUpperCase()+e.dosage_form.slice(1):"",items_per_box:Ne(e.standard_packaging)||t.items_per_box})),B.oR.success("Auto-filled from ".concat(e.brand_name))},label:"Search by brand or generic name"})]}),(0,q.jsx)(I.Ay,{item:!0,xs:12,children:(0,q.jsx)(N.A,{})})]}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,required:!0,label:"Product Name",name:"name",value:Se.name,onChange:ze})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,label:"Generic Name",name:"generic_name",value:Se.generic_name,onChange:ze,placeholder:"e.g., Acetaminophen, Ibuprofen",helperText:"Scientific/generic name of the drug"})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,label:"Strength",name:"strength",value:Se.strength,onChange:ze,placeholder:"e.g., 500mg, 10ml"})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(x.A,{fullWidth:!0,select:!0,label:"Drug Type",name:"drug_type",value:Se.drug_type,onChange:ze,SelectProps:{native:!0},children:[(0,q.jsx)("option",{value:"",children:"Select Type"}),(0,q.jsx)("option",{value:"Tablet",children:"Tablet"}),(0,q.jsx)("option",{value:"Capsule",children:"Capsule"}),(0,q.jsx)("option",{value:"Syrup",children:"Syrup"}),(0,q.jsx)("option",{value:"Injection",children:"Injection"}),(0,q.jsx)("option",{value:"Cream",children:"Cream"}),(0,q.jsx)("option",{value:"Ointment",children:"Ointment"}),(0,q.jsx)("option",{value:"Drops",children:"Drops"}),(0,q.jsx)("option",{value:"Inhaler",children:"Inhaler"}),(0,q.jsx)("option",{value:"Powder",children:"Powder"}),(0,q.jsx)("option",{value:"Other",children:"Other"})]})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,label:"Form",name:"form",value:Se.form,onChange:ze,placeholder:"e.g., Tablet, Syrup, Injection"})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,required:!0,type:"number",label:"Selling Price",name:"price",value:Se.price,onChange:ze,InputProps:{startAdornment:(0,q.jsx)(A.A,{position:"start",children:e.currency_symbol})}})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,type:"number",label:"Cost Price",name:"cost_price",value:Se.cost_price,onChange:ze,InputProps:{startAdornment:(0,q.jsx)(A.A,{position:"start",children:e.currency_symbol})}})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,type:"number",label:"Stock Quantity",name:"stock",value:Se.stock,onChange:ze})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,type:"number",label:"Minimum Stock Level",name:"min_stock_level",value:Se.min_stock_level,onChange:ze,helperText:"Alert when stock falls below this"})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(x.A,{fullWidth:!0,type:"date",label:"Expiry Date",name:"expiry_date",value:Se.expiry_date,onChange:ze,InputLabelProps:{shrink:!0}})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsxs)(x.A,{fullWidth:!0,select:!0,label:"Supplier",name:"supplier_id",value:Se.supplier_id,onChange:ze,children:[(0,q.jsx)(z.A,{value:"",children:"None"}),$.map(e=>(0,q.jsx)(z.A,{value:e.id,children:e.name},e.id))]})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(x.A,{fullWidth:!0,type:"number",label:"Items per Box",name:"items_per_box",value:Se.items_per_box,onChange:ze,helperText:"Number of tablets/items in one box",inputProps:{min:1}})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsx)(x.A,{fullWidth:!0,type:"number",label:"Price per Box",name:"price_per_box",value:Se.price_per_box,onChange:e=>{if(ze(e),e.target.value&&Se.items_per_box){const t=parseFloat(e.target.value)/parseInt(Se.items_per_box);ke(e=>(0,n.A)((0,n.A)({},e),{},{price:t.toFixed(2)}))}},InputProps:{startAdornment:(0,q.jsx)(A.A,{position:"start",children:e.currency_symbol})},helperText:"Auto-calculates price per item"})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,sm:4,children:(0,q.jsxs)(x.A,{fullWidth:!0,select:!0,label:"Selling Unit",name:"selling_unit",value:Se.selling_unit,onChange:ze,helperText:"How this product is sold",children:[(0,q.jsx)(z.A,{value:"item",children:"Item Only"}),(0,q.jsx)(z.A,{value:"box",children:"Box Only"}),(0,q.jsx)(z.A,{value:"both",children:"Both Box & Item"})]})}),(0,q.jsx)(I.Ay,{item:!0,xs:12,children:(0,q.jsx)(x.A,{fullWidth:!0,label:"Batch Number",name:"batch_number",value:Se.batch_number,onChange:ze,placeholder:"Optional - for tracking batches"})})]})}),(0,q.jsxs)(D.A,{children:[(0,q.jsx)(u.A,{onClick:Ie,children:"Cancel"}),(0,q.jsxs)(u.A,{type:"submit",variant:"contained",children:[Ae?"Update":"Add"," Product"]})]})]})}),(0,q.jsx)(Q.A,{open:_e,onClose:()=>je(!1),onConfirm:async()=>{if(ye)try{const{error:e}=await Y.N.from("products").update({deleted_at:(new Date).toISOString()}).eq("id",ye);if(e)throw e;B.oR.success("Product deleted successfully!"),Ce()}catch(e){console.error("Error deleting product:",e),B.oR.error("Failed to delete product: "+(e.message||"Please try again"))}finally{je(!1),fe(null)}},title:"Delete Product",content:"Are you sure you want to delete this product? This action cannot be undone."})]})}},70141:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(59662),o=r(70579);const i=(0,n.A)((0,o.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},83560:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(59662),o=r(70579);const i=(0,n.A)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},98533:(e,t,r)=>{r.d(t,{A:()=>_});var n=r(98587),o=r(58168),i=r(65043),s=r(58387),l=r(98610),a=r(34535),c=r(61475),d=r(98206),u=r(85865),p=r(92532),h=r(72372);function m(e){return(0,h.Ay)("MuiDialogContentText",e)}(0,p.A)("MuiDialogContentText",["root"]);var x=r(70579);const A=["children","className"],g=(0,a.Ay)(u.A,{shouldForwardProp:e=>(0,c.A)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),_=i.forwardRef(function(e,t){const r=(0,d.b)({props:e,name:"MuiDialogContentText"}),{className:i}=r,a=(0,n.A)(r,A),c=(e=>{const{classes:t}=e,r=(0,l.A)({root:["root"]},m,t);return(0,o.A)({},t,r)})(a);return(0,x.jsx)(g,(0,o.A)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:a,className:(0,s.A)(c.root,i)},r,{classes:c}))})},98606:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(59662),o=r(70579);const i=(0,n.A)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle")}}]);
//# sourceMappingURL=83.3318bdce.chunk.js.map