{"version":3,"file":"static/js/173.381432a9.chunk.js","mappings":"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","sources":["../node_modules/@mui/icons-material/esm/Visibility.js","utils/formatters.js","../node_modules/@mui/icons-material/esm/Send.js","components/purchaseOrders/CreateEditPODialog.js","components/stock/ReceiveStockDialog.js","utils/poPdfGenerator.js","components/purchaseOrders/PODetailDialog.js","../node_modules/@mui/icons-material/esm/Share.js","utils/printPO.js","components/purchaseOrders/POReceiptModal.js","components/purchaseOrders/PurchaseOrdersPage.js","../node_modules/@mui/icons-material/esm/Add.js","../node_modules/@mui/icons-material/esm/Edit.js","utils/whatsappHelper.js","../node_modules/@mui/icons-material/esm/CheckCircle.js"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3\"\n}), 'Visibility');","/**\r\n * Format currency value\r\n * @param {number} value - Value to format\r\n * @param {string} symbol - Currency symbol (default: 'PKR')\r\n * @returns {string} Formatted currency string\r\n */\r\nexport function formatCurrency(value, symbol = 'PKR') {\r\n    if (value === null || value === undefined || isNaN(value)) {\r\n        return `${symbol} 0.00`;\r\n    }\r\n\r\n    const num = Number(value);\r\n    return `${symbol} ${num.toLocaleString('en-US', {\r\n        minimumFractionDigits: 2,\r\n        maximumFractionDigits: 2,\r\n    })}`;\r\n}\r\n\r\n/**\r\n * Format number with thousand separators\r\n * @param {number} value - Value to format\r\n * @returns {string} Formatted number string\r\n */\r\nexport function formatNumber(value) {\r\n    if (value === null || value === undefined || isNaN(value)) {\r\n        return '0';\r\n    }\r\n\r\n    return Number(value).toLocaleString('en-US');\r\n}\r\n\r\n/**\r\n * Format percentage\r\n * @param {number} value - Value to format (0-100)\r\n * @param {number} decimals - Number of decimal places (default: 1)\r\n * @returns {string} Formatted percentage string\r\n */\r\nexport function formatPercentage(value, decimals = 1) {\r\n    if (value === null || value === undefined || isNaN(value)) {\r\n        return '0%';\r\n    }\r\n\r\n    return `${Number(value).toFixed(decimals)}%`;\r\n}\r\n\r\n/**\r\n * Truncate text to specified length\r\n * @param {string} text - Text to truncate\r\n * @param {number} maxLength - Maximum length\r\n * @returns {string} Truncated text\r\n */\r\nexport function truncateText(text, maxLength = 50) {\r\n    if (!text) return '';\r\n    if (text.length <= maxLength) return text;\r\n    return text.substring(0, maxLength) + '...';\r\n}\r\n\r\n/**\r\n * Capitalize first letter of each word\r\n * @param {string} text - Text to capitalize\r\n * @returns {string} Capitalized text\r\n */\r\nexport function capitalizeWords(text) {\r\n    if (!text) return '';\r\n    return text\r\n        .toLowerCase()\r\n        .split(' ')\r\n        .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n        .join(' ');\r\n}\r\n\r\n/**\r\n * Format phone number\r\n * @param {string} phone - Phone number\r\n * @returns {string} Formatted phone number\r\n */\r\nexport function formatPhone(phone) {\r\n    if (!phone) return '';\r\n    // Remove all non-digit characters\r\n    const cleaned = phone.replace(/\\D/g, '');\r\n\r\n    // Format as: 0300-1234567\r\n    if (cleaned.length === 11 && cleaned.startsWith('0')) {\r\n        return `${cleaned.slice(0, 4)}-${cleaned.slice(4)}`;\r\n    }\r\n\r\n    return phone;\r\n}\r\n\r\n/**\r\n * Get initials from name\r\n * @param {string} name - Full name\r\n * @returns {string} Initials (max 2 letters)\r\n */\r\nexport function getInitials(name) {\r\n    if (!name) return '?';\r\n\r\n    const parts = name.trim().split(' ');\r\n    if (parts.length === 1) {\r\n        return parts[0].charAt(0).toUpperCase();\r\n    }\r\n\r\n    return (parts[0].charAt(0) + parts[parts.length - 1].charAt(0)).toUpperCase();\r\n}\r\n\r\n/**\r\n * Calculate profit margin percentage\r\n * @param {number} revenue - Total revenue\r\n * @param {number} cost - Total cost\r\n * @returns {number} Profit margin percentage\r\n */\r\nexport function calculateProfitMargin(revenue, cost) {\r\n    if (!revenue || revenue === 0) return 0;\r\n    const profit = revenue - (cost || 0);\r\n    return (profit / revenue) * 100;\r\n}\r\n\r\n/**\r\n * Generate random color for charts\r\n * @param {number} index - Index for consistent colors\r\n * @returns {string} Hex color code\r\n */\r\nexport function getChartColor(index) {\r\n    const colors = [\r\n        '#6366f1', // Indigo\r\n        '#ec4899', // Pink\r\n        '#10b981', // Green\r\n        '#f59e0b', // Amber\r\n        '#3b82f6', // Blue\r\n        '#8b5cf6', // Purple\r\n        '#ef4444', // Red\r\n        '#14b8a6', // Teal\r\n        '#f97316', // Orange\r\n        '#06b6d4', // Cyan\r\n    ];\r\n\r\n    return colors[index % colors.length];\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z\"\n}), 'Send');","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    TextField,\r\n    Grid,\r\n    MenuItem,\r\n    Box,\r\n    Typography,\r\n    IconButton,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Autocomplete,\r\n    Divider,\r\n} from '@mui/material';\r\nimport { Add, Delete, ShoppingCart } from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\n\r\nexport default function CreateEditPODialog({ open, onClose, purchaseOrder, suppliers }) {\r\n    const isEdit = !!purchaseOrder;\r\n\r\n    const [formData, setFormData] = useState({\r\n        supplier_id: '',\r\n        order_date: new Date().toISOString().split('T')[0],\r\n        notes: '',\r\n    });\r\n\r\n    const [items, setItems] = useState([]);\r\n    const [products, setProducts] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (open) {\r\n            fetchProducts();\r\n            if (isEdit) {\r\n                loadPOData();\r\n            } else {\r\n                resetForm();\r\n            }\r\n        }\r\n    }, [open, purchaseOrder]);\r\n\r\n    const fetchProducts = async () => {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session) return;\r\n\r\n        const { data } = await supabase\r\n            .from('products')\r\n            .select('*')\r\n            .eq('organization_id', session.user.id)\r\n            .is('deleted_at', null)\r\n            .order('name');\r\n\r\n        setProducts(data || []);\r\n    };\r\n\r\n    const loadPOData = async () => {\r\n        if (!purchaseOrder) return;\r\n\r\n        setFormData({\r\n            supplier_id: purchaseOrder.supplier_id || '',\r\n            order_date: purchaseOrder.order_date || new Date().toISOString().split('T')[0],\r\n            notes: purchaseOrder.notes || '',\r\n        });\r\n\r\n        // Fetch PO items\r\n        const { data } = await supabase\r\n            .from('purchase_order_items')\r\n            .select('*, products(name)')\r\n            .eq('purchase_order_id', purchaseOrder.id);\r\n\r\n        if (data) {\r\n            setItems(data.map(item => ({\r\n                product_id: item.product_id,\r\n                product_name: item.products?.name,\r\n                quantity_ordered: item.quantity_ordered,\r\n                boxes_ordered: item.boxes_ordered || '',\r\n                items_per_box: item.items_per_box || 1,\r\n            })));\r\n        }\r\n    };\r\n\r\n    const resetForm = () => {\r\n        setFormData({\r\n            supplier_id: '',\r\n            order_date: new Date().toISOString().split('T')[0],\r\n            notes: '',\r\n        });\r\n        setItems([]);\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        setFormData({\r\n            ...formData,\r\n            [e.target.name]: e.target.value,\r\n        });\r\n    };\r\n\r\n    const handleAddItem = () => {\r\n        setItems([...items, {\r\n            product_id: '',\r\n            product_name: '',\r\n            quantity_ordered: 1,\r\n            boxes_ordered: '',\r\n            items_per_box: 1,\r\n        }]);\r\n    };\r\n\r\n    const handleRemoveItem = (index) => {\r\n        setItems(items.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const handleItemChange = (index, field, value) => {\r\n        const newItems = [...items];\r\n        newItems[index][field] = value;\r\n\r\n        // If product changed, update product name and default items_per_box\r\n        if (field === 'product_id') {\r\n            const product = products.find(p => p.id === value);\r\n            if (product) {\r\n                newItems[index].product_name = product.name;\r\n                newItems[index].items_per_box = product.items_per_box || 1;\r\n                // Recalculate if boxes are already entered\r\n                if (newItems[index].boxes_ordered) {\r\n                    newItems[index].quantity_ordered = newItems[index].boxes_ordered * (product.items_per_box || 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto-calculate total quantity if boxes or items_per_box change\r\n        if (field === 'boxes_ordered' || field === 'items_per_box') {\r\n            const boxes = field === 'boxes_ordered' ? value : newItems[index].boxes_ordered;\r\n            const perBox = field === 'items_per_box' ? value : newItems[index].items_per_box;\r\n\r\n            if (boxes && perBox) {\r\n                newItems[index].quantity_ordered = parseInt(boxes) * parseInt(perBox);\r\n            }\r\n        }\r\n\r\n        setItems(newItems);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        // Validation\r\n        if (!formData.supplier_id) {\r\n            toast.error('Please select a supplier');\r\n            return;\r\n        }\r\n        if (items.length === 0) {\r\n            toast.error('Please add at least one item');\r\n            return;\r\n        }\r\n        if (items.some(item => !item.product_id || item.quantity_ordered <= 0)) {\r\n            toast.error('Please fill in all item details correctly');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) throw new Error('Not authenticated');\r\n\r\n            if (isEdit) {\r\n                // Update existing PO\r\n                const { error: poError } = await supabase\r\n                    .from('purchase_orders')\r\n                    .update({\r\n                        supplier_id: formData.supplier_id,\r\n                        order_date: formData.order_date,\r\n                        notes: formData.notes,\r\n                        updated_at: new Date().toISOString(),\r\n                    })\r\n                    .eq('id', purchaseOrder.id);\r\n\r\n                if (poError) throw poError;\r\n\r\n                // Delete existing items\r\n                await supabase\r\n                    .from('purchase_order_items')\r\n                    .delete()\r\n                    .eq('purchase_order_id', purchaseOrder.id);\r\n\r\n                // Insert new items\r\n                const { error: itemsError } = await supabase\r\n                    .from('purchase_order_items')\r\n                    .insert(items.map(item => ({\r\n                        purchase_order_id: purchaseOrder.id,\r\n                        product_id: item.product_id,\r\n                        quantity_ordered: item.quantity_ordered,\r\n                        boxes_ordered: item.boxes_ordered ? parseInt(item.boxes_ordered) : null,\r\n                        items_per_box: item.items_per_box ? parseInt(item.items_per_box) : 1,\r\n                        unit_price: 0,\r\n                    })));\r\n\r\n                if (itemsError) throw itemsError;\r\n\r\n                toast.success('PO updated successfully!');\r\n                onClose(); // Close without passing data for edits\r\n            } else {\r\n                // Generate PO number\r\n                const { data: poNumberData } = await supabase.rpc('generate_po_number');\r\n                const poNumber = poNumberData || `PO-${Date.now()}`;\r\n\r\n                // Create new PO\r\n                const { data: newPO, error: poError } = await supabase\r\n                    .from('purchase_orders')\r\n                    .insert([{\r\n                        po_number: poNumber,\r\n                        supplier_id: formData.supplier_id,\r\n                        currency_id: null,\r\n                        order_date: formData.order_date,\r\n                        status: 'draft',\r\n                        notes: formData.notes,\r\n                        created_by: session.user.id,\r\n                        organization_id: session.user.id,\r\n                        total_amount: 0,\r\n                        final_amount: 0,\r\n                    }])\r\n                    .select()\r\n                    .single();\r\n\r\n                if (poError) throw poError;\r\n\r\n                // Insert items\r\n                const { error: itemsError } = await supabase\r\n                    .from('purchase_order_items')\r\n                    .insert(items.map(item => ({\r\n                        purchase_order_id: newPO.id,\r\n                        product_id: item.product_id,\r\n                        quantity_ordered: item.quantity_ordered,\r\n                        boxes_ordered: item.boxes_ordered ? parseInt(item.boxes_ordered) : null,\r\n                        items_per_box: item.items_per_box ? parseInt(item.items_per_box) : 1,\r\n                        unit_price: 0,\r\n                    })));\r\n\r\n                if (itemsError) throw itemsError;\r\n\r\n                toast.success('Purchase Order created successfully!');\r\n\r\n                // Pass the created PO data back to parent for receipt modal\r\n                const itemsWithNames = items.map(item => ({\r\n                    ...item,\r\n                    product_name: products.find(p => p.id === item.product_id)?.name\r\n                }));\r\n\r\n                onClose(newPO, itemsWithNames, suppliers.find(s => s.id === formData.supplier_id));\r\n            }\r\n        } catch (error) {\r\n            console.error('Error saving PO:', error);\r\n            toast.error('Failed to save purchase order: ' + error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onClose={() => onClose()} maxWidth=\"md\" fullWidth>\r\n            <DialogTitle>\r\n                <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n                    <ShoppingCart color=\"primary\" />\r\n                    {isEdit ? 'Edit Purchase Order' : 'Create Purchase Order'}\r\n                </Box>\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <Grid container spacing={2} sx={{ mt: 1 }}>\r\n                    <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                            select\r\n                            fullWidth\r\n                            required\r\n                            label=\"Supplier\"\r\n                            name=\"supplier_id\"\r\n                            value={formData.supplier_id}\r\n                            onChange={handleChange}\r\n                        >\r\n                            {suppliers.map((supplier) => (\r\n                                <MenuItem key={supplier.id} value={supplier.id}>\r\n                                    {supplier.name}\r\n                                </MenuItem>\r\n                            ))}\r\n                        </TextField>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                            fullWidth\r\n                            required\r\n                            type=\"date\"\r\n                            label=\"Order Date\"\r\n                            name=\"order_date\"\r\n                            value={formData.order_date}\r\n                            onChange={handleChange}\r\n                            InputLabelProps={{ shrink: true }}\r\n                        />\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <Divider sx={{ my: 1 }} />\r\n                        <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\r\n                            <Typography variant=\"h6\">Items to Order</Typography>\r\n                            <Button startIcon={<Add />} onClick={handleAddItem}>\r\n                                Add Item\r\n                            </Button>\r\n                        </Box>\r\n                        <TableContainer>\r\n                            <Table size=\"small\">\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell><strong>Product</strong></TableCell>\r\n                                        <TableCell width=\"100\"><strong>Boxes</strong></TableCell>\r\n                                        <TableCell width=\"100\"><strong>Items/Box</strong></TableCell>\r\n                                        <TableCell width=\"120\"><strong>Total Items</strong></TableCell>\r\n                                        <TableCell width=\"50\"></TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {items.map((item, index) => (\r\n                                        <TableRow key={index}>\r\n                                            <TableCell>\r\n                                                <Autocomplete\r\n                                                    size=\"small\"\r\n                                                    options={products}\r\n                                                    getOptionLabel={(option) => option.name || ''}\r\n                                                    value={products.find(p => p.id === item.product_id) || null}\r\n                                                    onChange={(e, newValue) => {\r\n                                                        handleItemChange(index, 'product_id', newValue?.id || '');\r\n                                                    }}\r\n                                                    renderInput={(params) => (\r\n                                                        <TextField {...params} placeholder=\"Select product\" />\r\n                                                    )}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell>\r\n                                                <TextField\r\n                                                    size=\"small\"\r\n                                                    fullWidth\r\n                                                    type=\"number\"\r\n                                                    placeholder=\"Boxes\"\r\n                                                    value={item.boxes_ordered}\r\n                                                    onChange={(e) => handleItemChange(index, 'boxes_ordered', e.target.value)}\r\n                                                    inputProps={{ min: 1 }}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell>\r\n                                                <TextField\r\n                                                    size=\"small\"\r\n                                                    fullWidth\r\n                                                    type=\"number\"\r\n                                                    placeholder=\"Per Box\"\r\n                                                    value={item.items_per_box}\r\n                                                    onChange={(e) => handleItemChange(index, 'items_per_box', e.target.value)}\r\n                                                    inputProps={{ min: 1 }}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell>\r\n                                                <TextField\r\n                                                    size=\"small\"\r\n                                                    fullWidth\r\n                                                    type=\"number\"\r\n                                                    value={item.quantity_ordered}\r\n                                                    onChange={(e) => handleItemChange(index, 'quantity_ordered', e.target.value)}\r\n                                                    inputProps={{ min: 1 }}\r\n                                                    helperText=\"Total Units\"\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell>\r\n                                                <IconButton size=\"small\" color=\"error\" onClick={() => handleRemoveItem(index)}>\r\n                                                    <Delete fontSize=\"small\" />\r\n                                                </IconButton>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </TableContainer>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <TextField\r\n                            fullWidth\r\n                            multiline\r\n                            rows={2}\r\n                            label=\"Notes (Optional)\"\r\n                            name=\"notes\"\r\n                            value={formData.notes}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Any special instructions for the supplier...\"\r\n                        />\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <Box bgcolor=\"info.light\" p={2} borderRadius={1}>\r\n                            <Typography variant=\"body2\" color=\"info.dark\">\r\n                                <strong>Note:</strong> Prices will be entered when you receive the stock from the supplier.\r\n                            </Typography>\r\n                        </Box>\r\n                    </Grid>\r\n                </Grid>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={() => onClose()}>Cancel</Button>\r\n                <Button onClick={handleSubmit} variant=\"contained\" disabled={loading}>\r\n                    {isEdit ? 'Update Order' : 'Create Order'}\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    TextField,\r\n    Grid,\r\n    Box,\r\n    Typography,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Chip,\r\n} from '@mui/material';\r\nimport { LocalShipping, Inventory } from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\n\r\nexport default function ReceiveStockDialog({ open, onClose, purchaseOrder, poItems }) {\r\n    const [receivingData, setReceivingData] = useState([]);\r\n    const [receivedDate, setReceivedDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [notes, setNotes] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (open && poItems) {\r\n            fetchProductDetails();\r\n        }\r\n    }, [open, poItems]);\r\n\r\n    const fetchProductDetails = async () => {\r\n        try {\r\n            // Get all product IDs\r\n            const productIds = poItems.map(item => item.product_id);\r\n\r\n            // Fetch current product details (especially selling price)\r\n            const { data: products, error } = await supabase\r\n                .from('products')\r\n                .select('id, price, cost_price, items_per_box')\r\n                .in('id', productIds);\r\n\r\n            if (error) throw error;\r\n\r\n            // Map products for easy lookup\r\n            const productMap = {};\r\n            products?.forEach(p => {\r\n                productMap[p.id] = p;\r\n            });\r\n\r\n            // Initialize receiving data\r\n            setReceivingData(poItems.map(item => {\r\n                const product = productMap[item.product_id];\r\n                return {\r\n                    po_item_id: item.id,\r\n                    product_id: item.product_id,\r\n                    product_name: item.product_name || item.products?.name,\r\n                    quantity_ordered: item.quantity_ordered,\r\n                    quantity_already_received: item.quantity_received,\r\n                    quantity_remaining: item.quantity_ordered - item.quantity_received,\r\n                    quantity_to_receive: 0,\r\n                    unit_price: item.unit_price || product?.cost_price || 0, // Purchasing Price (per item)\r\n                    selling_price: product?.price || 0, // Selling Price (per item)\r\n                    boxes_received: '',\r\n                    items_per_box: item.items_per_box || product?.items_per_box || 1,\r\n                    cost_per_box: '',\r\n                    total_cost: '', // User entry: Total Purchasing Cost\r\n                    selling_price_per_box: '', // User entry: Selling Price per Box (MRP)\r\n                    total_selling_price: 0, // Calculated: selling_price_per_box * boxes_received\r\n                };\r\n            }));\r\n        } catch (error) {\r\n            console.error('Error fetching product details:', error);\r\n            toast.error('Failed to load product details');\r\n        }\r\n    };\r\n\r\n    const handleQuantityChange = (index, field, value) => {\r\n        const newData = [...receivingData];\r\n\r\n        if (field === 'boxes_received' || field === 'items_per_box') {\r\n            newData[index][field] = value;\r\n\r\n            const boxes = parseFloat(newData[index].boxes_received) || 0;\r\n            const perBox = parseFloat(newData[index].items_per_box) || 1;\r\n\r\n            // Auto-calculate total quantity\r\n            if (boxes > 0) {\r\n                const totalQty = Math.round(boxes * perBox);\r\n                const maxReceivable = newData[index].quantity_remaining;\r\n                newData[index].quantity_to_receive = Math.min(totalQty, maxReceivable);\r\n            }\r\n        } else {\r\n            // Direct quantity update\r\n            const maxReceivable = newData[index].quantity_remaining;\r\n            const qty = Math.min(parseInt(value) || 0, maxReceivable);\r\n            newData[index].quantity_to_receive = qty;\r\n        }\r\n\r\n        setReceivingData(newData);\r\n    };\r\n\r\n    const handlePriceChange = (index, field, value) => {\r\n        const newData = [...receivingData];\r\n        newData[index][field] = parseFloat(value) || 0;\r\n\r\n        const boxes = parseFloat(newData[index].boxes_received) || 0;\r\n        const perBox = parseFloat(newData[index].items_per_box) || 1;\r\n        const totalItems = boxes * perBox;\r\n\r\n        // Auto-calculate costs based on Total Cost\r\n        if (field === 'total_cost' || field === 'boxes_received' || field === 'items_per_box') {\r\n            const totalCost = parseFloat(field === 'total_cost' ? value : newData[index].total_cost) || 0;\r\n\r\n            if (boxes > 0) {\r\n                newData[index].cost_per_box = totalCost / boxes;\r\n                if (totalItems > 0) {\r\n                    newData[index].unit_price = totalCost / totalItems;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto-calculate selling price per item based on Selling Price/Box\r\n        if (field === 'selling_price_per_box' || field === 'items_per_box' || field === 'boxes_received') {\r\n            const sellBox = parseFloat(field === 'selling_price_per_box' ? value : newData[index].selling_price_per_box) || 0;\r\n\r\n            if (perBox > 0) {\r\n                newData[index].selling_price = sellBox / perBox;\r\n            }\r\n\r\n            // Calculate Total Selling Price\r\n            if (boxes > 0) {\r\n                newData[index].total_selling_price = sellBox * boxes;\r\n            }\r\n        }\r\n\r\n        setReceivingData(newData);\r\n    };\r\n\r\n    const handleReceiveAll = (index) => {\r\n        const newData = [...receivingData];\r\n        newData[index].quantity_to_receive = newData[index].quantity_remaining;\r\n        setReceivingData(newData);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        const itemsToReceive = receivingData.filter(item => item.quantity_to_receive > 0);\r\n\r\n        if (itemsToReceive.length === 0) {\r\n            toast.error('Please enter quantities to receive');\r\n            return;\r\n        }\r\n\r\n        // Validate prices are entered\r\n        const itemsWithoutPrice = itemsToReceive.filter(item => item.unit_price <= 0 || item.selling_price <= 0);\r\n        if (itemsWithoutPrice.length > 0) {\r\n            toast.error('Please enter both purchasing and selling prices for all items being received');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) throw new Error('Not authenticated');\r\n\r\n            // Process each item\r\n            for (const item of itemsToReceive) {\r\n                // Create stock receipt\r\n                const { data: stockReceipt, error: receiptError } = await supabase\r\n                    .from('stock_receipts')\r\n                    .insert([{\r\n                        product_id: item.product_id,\r\n                        quantity: item.quantity_to_receive,\r\n                        received_date: receivedDate,\r\n                        notes,\r\n                        purchase_order_id: purchaseOrder.id,\r\n                        organization_id: session.user.id // Ensure org_id is set\r\n                    }])\r\n                    .select()\r\n                    .single();\r\n\r\n                if (receiptError) throw receiptError;\r\n\r\n                // Fetch current stock to ensure accuracy\r\n                const { data: currentProduct, error: fetchError } = await supabase\r\n                    .from('products')\r\n                    .select('stock')\r\n                    .eq('id', item.product_id)\r\n                    .single();\r\n\r\n                if (fetchError) throw fetchError;\r\n\r\n                const newStock = (currentProduct?.stock || 0) + parseInt(item.quantity_to_receive);\r\n\r\n                // Update product stock, cost price, selling price, and box details\r\n                const { error: updateError } = await supabase\r\n                    .from('products')\r\n                    .update({\r\n                        stock: newStock,\r\n                        cost_price: item.unit_price, // Update cost price\r\n                        price: item.selling_price,   // Update selling price (per item)\r\n                        items_per_box: item.items_per_box, // Update items per box\r\n                        price_per_box: item.selling_price_per_box // Update MRP/Selling Price per Box\r\n                    })\r\n                    .eq('id', item.product_id);\r\n\r\n                if (updateError) throw updateError;\r\n\r\n                // Update PO item with received quantity and price\r\n                const { error: poItemError } = await supabase\r\n                    .from('purchase_order_items')\r\n                    .update({\r\n                        quantity_received: item.quantity_already_received + item.quantity_to_receive,\r\n                        unit_price: item.unit_price, // Save the purchasing price\r\n                    })\r\n                    .eq('id', item.po_item_id);\r\n\r\n                if (poItemError) throw poItemError;\r\n\r\n                // Record in receiving history\r\n                await supabase\r\n                    .from('po_receiving_history')\r\n                    .insert([{\r\n                        purchase_order_id: purchaseOrder.id,\r\n                        po_item_id: item.po_item_id,\r\n                        quantity_received: item.quantity_to_receive,\r\n                        received_date: receivedDate,\r\n                        received_by: session.user.id,\r\n                        stock_receipt_id: stockReceipt.id,\r\n                        notes,\r\n                        boxes_received: item.boxes_received ? parseInt(item.boxes_received) : null,\r\n                    }]);\r\n            }\r\n\r\n            // Check if PO is fully received\r\n            const allReceived = receivingData.every(item =>\r\n                (item.quantity_already_received + item.quantity_to_receive) >= item.quantity_ordered\r\n            );\r\n\r\n            if (allReceived) {\r\n                await supabase\r\n                    .from('purchase_orders')\r\n                    .update({ status: 'received' })\r\n                    .eq('id', purchaseOrder.id);\r\n            } else {\r\n                await supabase\r\n                    .from('purchase_orders')\r\n                    .update({ status: 'partially_received' })\r\n                    .eq('id', purchaseOrder.id);\r\n            }\r\n\r\n            toast.success('Stock received successfully!');\r\n            onClose();\r\n        } catch (error) {\r\n            console.error('Error receiving stock:', error);\r\n            toast.error('Failed to receive stock: ' + error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const totalToReceive = receivingData.reduce((sum, item) => sum + item.quantity_to_receive, 0);\r\n    const totalAmount = receivingData.reduce((sum, item) => sum + (parseFloat(item.total_cost) || 0), 0);\r\n\r\n    return (\r\n        <Dialog open={open} onClose={onClose} maxWidth=\"xl\" fullWidth>\r\n            <DialogTitle>\r\n                <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n                    <LocalShipping color=\"primary\" />\r\n                    Receive Stock - PO: {purchaseOrder?.po_number}\r\n                </Box>\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <Grid container spacing={2} sx={{ mt: 1 }}>\r\n                    <Grid item xs={12}>\r\n                        <TextField\r\n                            fullWidth\r\n                            type=\"date\"\r\n                            label=\"Received Date\"\r\n                            value={receivedDate}\r\n                            onChange={(e) => setReceivedDate(e.target.value)}\r\n                            InputLabelProps={{ shrink: true }}\r\n                        />\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <TableContainer sx={{ overflowX: 'auto', maxHeight: '60vh' }}>\r\n                            <Table size=\"small\" stickyHeader>\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell>Product</TableCell>\r\n                                        <TableCell align=\"center\">Ordered</TableCell>\r\n                                        <TableCell align=\"center\">Received</TableCell>\r\n                                        <TableCell align=\"center\">Remaining</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>Boxes Received</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>Items/Box</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>Total Cost</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#e3f2fd' }}>MRP/Box</TableCell>\r\n\r\n                                        {/* System Calculated Fields */}\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Total Items</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Cost/Box</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Cost/Item</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Sale/Item</TableCell>\r\n                                        <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>Total Selling</TableCell>\r\n                                        <TableCell></TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {receivingData.map((item, index) => (\r\n                                        <TableRow key={index}>\r\n                                            <TableCell>{item.product_name}</TableCell>\r\n                                            <TableCell align=\"center\">\r\n                                                <Chip label={item.quantity_ordered} size=\"small\" />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\">\r\n                                                <Chip\r\n                                                    label={item.quantity_already_received}\r\n                                                    size=\"small\"\r\n                                                    color={item.quantity_already_received > 0 ? 'success' : 'default'}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\">\r\n                                                <Chip\r\n                                                    label={item.quantity_remaining}\r\n                                                    size=\"small\"\r\n                                                    color={item.quantity_remaining > 0 ? 'warning' : 'success'}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    placeholder=\"Boxes\"\r\n                                                    value={item.boxes_received}\r\n                                                    onChange={(e) => handleQuantityChange(index, 'boxes_received', e.target.value)}\r\n                                                    inputProps={{ min: 0, style: { width: '60px', textAlign: 'center' } }}\r\n                                                    disabled={item.quantity_remaining === 0}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    placeholder=\"/Box\"\r\n                                                    value={item.items_per_box}\r\n                                                    onChange={(e) => handleQuantityChange(index, 'items_per_box', e.target.value)}\r\n                                                    inputProps={{ min: 1, style: { width: '50px', textAlign: 'center' } }}\r\n                                                    disabled={item.quantity_remaining === 0}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    placeholder=\"Total\"\r\n                                                    value={item.total_cost}\r\n                                                    onChange={(e) => handlePriceChange(index, 'total_cost', e.target.value)}\r\n                                                    inputProps={{ min: 0, step: 0.01, style: { width: '80px', textAlign: 'center' } }}\r\n                                                />\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5faff' }}>\r\n                                                <TextField\r\n                                                    type=\"number\"\r\n                                                    size=\"small\"\r\n                                                    value={item.selling_price_per_box}\r\n                                                    onChange={(e) => handlePriceChange(index, 'selling_price_per_box', e.target.value)}\r\n                                                    placeholder=\"MRP\"\r\n                                                    inputProps={{\r\n                                                        min: 0,\r\n                                                        step: 0.01,\r\n                                                        style: { width: '80px', textAlign: 'center' }\r\n                                                    }}\r\n                                                />\r\n                                            </TableCell>\r\n\r\n                                            {/* Calculated Values */}\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\" fontWeight={600}>\r\n                                                    {item.quantity_to_receive}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\">\r\n                                                    {item.cost_per_box ? parseFloat(item.cost_per_box).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\">\r\n                                                    {item.unit_price ? parseFloat(item.unit_price).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\">\r\n                                                    {item.selling_price ? parseFloat(item.selling_price).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell align=\"center\" sx={{ bgcolor: '#f5f5f5' }}>\r\n                                                <Typography variant=\"body2\" fontWeight={600} color=\"success.main\">\r\n                                                    {item.total_selling_price ? parseFloat(item.total_selling_price).toFixed(2) : '-'}\r\n                                                </Typography>\r\n                                            </TableCell>\r\n                                            <TableCell>\r\n                                                {item.quantity_remaining > 0 && (\r\n                                                    <Button\r\n                                                        size=\"small\"\r\n                                                        onClick={() => handleReceiveAll(index)}\r\n                                                    >\r\n                                                        All\r\n                                                    </Button>\r\n                                                )}\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </TableContainer>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <Box bgcolor=\"primary.main\" color=\"white\" p={2} borderRadius={1}>\r\n                            <Grid container>\r\n                                <Grid item xs={6}>\r\n                                    <Typography variant=\"h6\">\r\n                                        Total Items: {totalToReceive}\r\n                                    </Typography>\r\n                                </Grid>\r\n                                <Grid item xs={6}>\r\n                                    <Typography variant=\"h6\" align=\"right\">\r\n                                        Total Cost: Rs {totalAmount.toFixed(2)}\r\n                                    </Typography>\r\n                                </Grid>\r\n                            </Grid>\r\n                        </Box>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12}>\r\n                        <TextField\r\n                            fullWidth\r\n                            multiline\r\n                            rows={2}\r\n                            label=\"Delivery Notes\"\r\n                            value={notes}\r\n                            onChange={(e) => setNotes(e.target.value)}\r\n                            placeholder=\"Optional notes about this delivery (condition, packaging, etc.)\"\r\n                        />\r\n                    </Grid>\r\n                </Grid>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={onClose}>Cancel</Button>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    startIcon={<Inventory />}\r\n                    onClick={handleSubmit}\r\n                    disabled={loading || totalToReceive === 0}\r\n                >\r\n                    Receive Stock\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n","import jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\nexport const generatePOPDF = async (po, poItems, settings) => {\r\n    try {\r\n        const doc = new jsPDF();\r\n\r\n        // Default values to prevent crashes\r\n        const storeName = settings?.store_name || 'Medical Store';\r\n        const poNumber = po?.po_number || 'DRAFT';\r\n        const orderDate = po?.order_date ? new Date(po.order_date).toLocaleDateString() : new Date().toLocaleDateString();\r\n        const supplierName = po?.suppliers?.name || 'N/A';\r\n        const supplierPhone = po?.suppliers?.phone || '';\r\n        const items = Array.isArray(poItems) ? poItems : [];\r\n\r\n        // Header - Store Name\r\n        doc.setFontSize(20);\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text(storeName, 105, 20, { align: 'center' });\r\n\r\n        // Store details\r\n        doc.setFontSize(10);\r\n        doc.setFont(undefined, 'normal');\r\n        let yPos = 28;\r\n\r\n        if (settings?.address) {\r\n            doc.text(settings.address, 105, yPos, { align: 'center' });\r\n            yPos += 5;\r\n        }\r\n        if (settings?.phone) {\r\n            doc.text(`Phone: ${settings.phone}`, 105, yPos, { align: 'center' });\r\n            yPos += 5;\r\n        }\r\n        if (settings?.owner_name) {\r\n            doc.text(`Owner: ${settings.owner_name}`, 105, yPos, { align: 'center' });\r\n            yPos += 5;\r\n        }\r\n\r\n        // Divider line\r\n        doc.setLineWidth(0.5);\r\n        doc.line(14, yPos + 3, 196, yPos + 3);\r\n\r\n        // Title\r\n        doc.setFontSize(16);\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text('PURCHASE ORDER', 105, yPos + 12, { align: 'center' });\r\n\r\n        // PO Info Box\r\n        const infoY = yPos + 22;\r\n        doc.setFontSize(11);\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text('PO Details:', 14, infoY);\r\n\r\n        doc.setFont(undefined, 'normal');\r\n        doc.text(`PO Number: ${poNumber}`, 14, infoY + 7);\r\n        doc.text(`Order Date: ${orderDate}`, 14, infoY + 14);\r\n\r\n        // Supplier Info (right side)\r\n        doc.setFont(undefined, 'bold');\r\n        doc.text('Supplier:', 120, infoY);\r\n        doc.setFont(undefined, 'normal');\r\n\r\n        doc.text(supplierName, 120, infoY + 7);\r\n\r\n        if (supplierPhone) {\r\n            doc.text(`Phone: ${supplierPhone}`, 120, infoY + 14);\r\n        }\r\n\r\n        // Items Table\r\n        const tableColumn = [\"#\", \"Product\", \"Quantity (Boxes)\"];\r\n        const tableRows = items.map((item, index) => {\r\n            // Handle both data formats safely\r\n            let productName = 'N/A';\r\n            if (item.product_name) productName = item.product_name;\r\n            else if (item.products?.name) productName = item.products.name;\r\n\r\n            const quantity = item.quantity_ordered || 0;\r\n\r\n            return [\r\n                (index + 1).toString(),\r\n                productName,\r\n                quantity.toString()\r\n            ];\r\n        });\r\n\r\n        autoTable(doc, {\r\n            head: [tableColumn],\r\n            body: tableRows,\r\n            startY: infoY + 25,\r\n            theme: 'striped',\r\n            headStyles: {\r\n                fillColor: [41, 128, 185],\r\n                fontStyle: 'bold',\r\n                fontSize: 11\r\n            },\r\n            styles: {\r\n                fontSize: 10\r\n            },\r\n            columnStyles: {\r\n                0: { cellWidth: 15 },\r\n                1: { cellWidth: 125 },\r\n                2: { cellWidth: 40, halign: 'center' }\r\n            }\r\n        });\r\n\r\n        // Notes\r\n        let finalY = (doc.lastAutoTable && doc.lastAutoTable.finalY) || (infoY + 30) + 10;\r\n        if (po?.notes) {\r\n            doc.setFontSize(10);\r\n            doc.setFont(undefined, 'bold');\r\n            doc.text('Notes:', 14, finalY);\r\n            doc.setFont(undefined, 'normal');\r\n            const splitText = doc.splitTextToSize(po.notes, 180);\r\n            doc.text(splitText, 14, finalY + 6);\r\n            finalY += 6 + (splitText.length * 5);\r\n        }\r\n\r\n        // Digital Signature Area\r\n        finalY += 15;\r\n        if (finalY > 250) {\r\n            doc.addPage();\r\n            finalY = 20;\r\n        }\r\n\r\n        doc.setFontSize(10);\r\n        doc.setFont(undefined, 'normal');\r\n\r\n        // Signature boxes\r\n        doc.text('Prepared By:', 14, finalY);\r\n        doc.line(14, finalY + 15, 80, finalY + 15); // Line for signature\r\n        doc.setFontSize(9);\r\n        doc.text('Signature & Date', 30, finalY + 20);\r\n\r\n        doc.setFontSize(10);\r\n        doc.text('Approved By:', 120, finalY);\r\n        doc.line(120, finalY + 15, 186, finalY + 15); // Line for signature\r\n        doc.setFontSize(9);\r\n        doc.text('Signature & Date', 135, finalY + 20);\r\n\r\n        // Footer\r\n        const pageHeight = doc.internal.pageSize.height;\r\n        doc.setFontSize(9);\r\n        doc.setFont(undefined, 'italic');\r\n        doc.setTextColor(100, 100, 100);\r\n\r\n        const footerY = pageHeight - 20;\r\n        if (settings?.footer_text) {\r\n            doc.text(settings.footer_text, 105, footerY, { align: 'center' });\r\n        } else {\r\n            doc.text('Thank you for your service!', 105, footerY, { align: 'center' });\r\n        }\r\n\r\n        // Branding footer - REMOVED for white-label\r\n        // doc.setFontSize(8);\r\n        // doc.setTextColor(150, 150, 150); \r\n        // doc.text('Receipt designed and generated by MedixFlow | +923089020131', 105, footerY + 6, { align: 'center' });\r\n\r\n        // Page number\r\n        doc.setFontSize(8);\r\n        doc.text(`Page 1`, 105, footerY + 10, { align: 'center' });\r\n\r\n        return doc.output('blob');\r\n    } catch (error) {\r\n        console.error('PDF Generation Error:', error);\r\n        // Fallback: return a simple PDF with error message so app doesn't crash\r\n        const doc = new jsPDF();\r\n        doc.text('Error generating PDF receipt.', 10, 10);\r\n        doc.text(error.message, 10, 20);\r\n        return doc.output('blob');\r\n    }\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    Box,\r\n    Typography,\r\n    Grid,\r\n    Chip,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Divider,\r\n    IconButton,\r\n    Tooltip,\r\n} from '@mui/material';\r\nimport {\r\n    Send,\r\n    Download,\r\n    LocalShipping,\r\n    Close,\r\n} from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { formatCurrency } from '../../utils/formatters';\r\nimport ReceiveStockDialog from '../stock/ReceiveStockDialog';\r\nimport { generatePOPDF } from '../../utils/poPdfGenerator';\r\nimport { openWhatsApp } from '../../utils/whatsappHelper';\r\n\r\nexport default function PODetailDialog({ open, onClose, purchaseOrder, onRefresh }) {\r\n    const [poDetails, setPODetails] = useState(null);\r\n    const [poItems, setPOItems] = useState([]);\r\n    const [receivingHistory, setReceivingHistory] = useState([]);\r\n    const [receiveDialogOpen, setReceiveDialogOpen] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (open && purchaseOrder) {\r\n            fetchPODetails();\r\n        }\r\n    }, [open, purchaseOrder]);\r\n\r\n    const fetchPODetails = async () => {\r\n        if (!purchaseOrder) return;\r\n\r\n        try {\r\n            // Fetch PO with all relations\r\n            const { data: po, error: poError } = await supabase\r\n                .from('purchase_orders')\r\n                .select(`\r\n                    *,\r\n                    suppliers(name, phone, supplier_contacts(*))\r\n                `)\r\n                .eq('id', purchaseOrder.id)\r\n                .single();\r\n\r\n            if (poError) throw poError;\r\n            setPODetails(po);\r\n\r\n            // Fetch PO items\r\n            const { data: items, error: itemsError } = await supabase\r\n                .from('purchase_order_items')\r\n                .select('*, products(name)')\r\n                .eq('purchase_order_id', purchaseOrder.id);\r\n\r\n            if (itemsError) throw itemsError;\r\n            setPOItems(items || []);\r\n\r\n            // Fetch receiving history\r\n            const { data: history, error: historyError } = await supabase\r\n                .from('po_receiving_history')\r\n                .select('*')\r\n                .eq('purchase_order_id', purchaseOrder.id)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (historyError) throw historyError;\r\n            setReceivingHistory(history || []);\r\n        } catch (error) {\r\n            console.error('Error fetching PO details:', error);\r\n            toast.error('Failed to load PO details');\r\n        }\r\n    };\r\n\r\n    const handleSendToSupplier = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            const { data: settingsData } = await supabase\r\n                .from('settings')\r\n                .select('*')\r\n                .eq('organization_id', session.user.id)\r\n                .single();\r\n\r\n            // Generate and Download PDF\r\n            try {\r\n                const pdfBlob = await generatePOPDF(poDetails, poItems, settingsData);\r\n                const url = URL.createObjectURL(pdfBlob);\r\n                const link = document.createElement('a');\r\n                link.href = url;\r\n                link.download = `${poDetails.po_number}.pdf`;\r\n                link.click();\r\n                URL.revokeObjectURL(url);\r\n                toast.info('PDF downloaded! Please attach it to the WhatsApp chat.');\r\n            } catch (pdfError) {\r\n                console.error('PDF Error:', pdfError);\r\n                toast.warning('Could not generate PDF, but opening WhatsApp...');\r\n            }\r\n\r\n            // Update status to sent\r\n            const { error } = await supabase\r\n                .from('purchase_orders')\r\n                .update({\r\n                    status: 'sent',\r\n                    sent_at: new Date().toISOString(),\r\n                })\r\n                .eq('id', purchaseOrder.id);\r\n\r\n            if (error) throw error;\r\n\r\n            // Get primary contact\r\n            const primaryContact = poDetails.suppliers?.supplier_contacts?.find(c => c.is_primary);\r\n            const phone = primaryContact?.phone || poDetails.suppliers?.phone;\r\n\r\n            if (phone) {\r\n                const message = `Hello! Please find the Purchase Order ${poDetails.po_number}. We need these items as soon as possible. Thank you!`;\r\n                setTimeout(() => openWhatsApp(phone, message), 1000);\r\n            } else {\r\n                toast.warning('No phone number found for supplier');\r\n            }\r\n\r\n            toast.success('PO marked as sent!');\r\n            onRefresh();\r\n            fetchPODetails();\r\n        } catch (error) {\r\n            console.error('Error sending PO:', error);\r\n            toast.error('Failed to send PO');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDownloadPDF = async () => {\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            const { data: settingsData } = await supabase\r\n                .from('settings')\r\n                .select('*')\r\n                .eq('organization_id', session.user.id)\r\n                .single();\r\n\r\n            const pdfBlob = await generatePOPDF(poDetails, poItems, settingsData);\r\n            const url = URL.createObjectURL(pdfBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `${poDetails.po_number}.pdf`;\r\n            link.click();\r\n            URL.revokeObjectURL(url);\r\n            toast.success('PDF downloaded!');\r\n        } catch (error) {\r\n            console.error('Error generating PDF:', error);\r\n            toast.error('Failed to generate PDF');\r\n        }\r\n    };\r\n\r\n    const handleReceiveStock = () => {\r\n        setReceiveDialogOpen(true);\r\n    };\r\n\r\n    const handleReceiveDialogClose = () => {\r\n        setReceiveDialogOpen(false);\r\n        fetchPODetails();\r\n        onRefresh();\r\n    };\r\n\r\n    if (!poDetails) return null;\r\n\r\n    const getStatusColor = (status) => {\r\n        const colors = {\r\n            draft: 'default',\r\n            sent: 'primary',\r\n            partially_received: 'secondary',\r\n            received: 'success',\r\n        };\r\n        return colors[status] || 'default';\r\n    };\r\n\r\n    const getStatusLabel = (status) => {\r\n        const labels = {\r\n            draft: 'Draft',\r\n            sent: 'Sent',\r\n            partially_received: 'Receiving',\r\n            received: 'Completed',\r\n        };\r\n        return labels[status] || status;\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Dialog open={open} onClose={onClose} maxWidth=\"md\" fullWidth>\r\n                <DialogTitle>\r\n                    <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                        <Typography variant=\"h6\">Purchase Order: {poDetails.po_number}</Typography>\r\n                        <IconButton onClick={onClose}>\r\n                            <Close />\r\n                        </IconButton>\r\n                    </Box>\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                    <Grid container spacing={2}>\r\n                        {/* Status and Dates */}\r\n                        <Grid item xs={12}>\r\n                            <Box display=\"flex\" gap={1} flexWrap=\"wrap\">\r\n                                <Chip\r\n                                    label={getStatusLabel(poDetails.status)}\r\n                                    color={getStatusColor(poDetails.status)}\r\n                                />\r\n                                <Chip label={`Order: ${new Date(poDetails.order_date).toLocaleDateString()}`} variant=\"outlined\" />\r\n                                {poDetails.expected_delivery_date && (\r\n                                    <Chip label={`Expected: ${new Date(poDetails.expected_delivery_date).toLocaleDateString()}`} variant=\"outlined\" />\r\n                                )}\r\n                            </Box>\r\n                        </Grid>\r\n\r\n                        {/* Supplier Info */}\r\n                        <Grid item xs={12}>\r\n                            <Typography variant=\"subtitle2\" color=\"text.secondary\">Supplier</Typography>\r\n                            <Typography variant=\"h6\">{poDetails.suppliers?.name}</Typography>\r\n                            {poDetails.suppliers?.phone && (\r\n                                <Typography variant=\"body2\" color=\"text.secondary\">Phone: {poDetails.suppliers.phone}</Typography>\r\n                            )}\r\n                        </Grid>\r\n\r\n                        {/* Items */}\r\n                        <Grid item xs={12}>\r\n                            <Divider sx={{ my: 1 }} />\r\n                            <Typography variant=\"h6\" gutterBottom>Items</Typography>\r\n                            <TableContainer>\r\n                                <Table size=\"small\">\r\n                                    <TableHead>\r\n                                        <TableRow>\r\n                                            <TableCell>Product</TableCell>\r\n                                            <TableCell align=\"center\">Ordered</TableCell>\r\n                                            <TableCell align=\"center\">Received</TableCell>\r\n                                            {poDetails.status !== 'draft' && (\r\n                                                <>\r\n                                                    <TableCell align=\"right\">Unit Price</TableCell>\r\n                                                    <TableCell align=\"right\">Total</TableCell>\r\n                                                </>\r\n                                            )}\r\n                                        </TableRow>\r\n                                    </TableHead>\r\n                                    <TableBody>\r\n                                        {poItems.map((item) => (\r\n                                            <TableRow key={item.id}>\r\n                                                <TableCell>{item.products?.name}</TableCell>\r\n                                                <TableCell align=\"center\">\r\n                                                    <Chip\r\n                                                        label={item.boxes_ordered\r\n                                                            ? `${item.boxes_ordered} Boxes (${item.quantity_ordered})`\r\n                                                            : item.quantity_ordered\r\n                                                        }\r\n                                                        size=\"small\"\r\n                                                    />\r\n                                                </TableCell>\r\n                                                <TableCell align=\"center\">\r\n                                                    <Chip\r\n                                                        label={item.quantity_received}\r\n                                                        size=\"small\"\r\n                                                        color={item.quantity_received >= item.quantity_ordered ? 'success' : 'default'}\r\n                                                    />\r\n                                                </TableCell>\r\n                                                {poDetails.status !== 'draft' && (\r\n                                                    <>\r\n                                                        <TableCell align=\"right\">\r\n                                                            {item.unit_price > 0 ? `Rs ${formatCurrency(item.unit_price, '')}` : ''}\r\n                                                        </TableCell>\r\n                                                        <TableCell align=\"right\">\r\n                                                            {item.unit_price > 0 ? `Rs ${formatCurrency(item.quantity_ordered * item.unit_price, '')}` : ''}\r\n                                                        </TableCell>\r\n                                                    </>\r\n                                                )}\r\n                                            </TableRow>\r\n                                        ))}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </TableContainer>\r\n                        </Grid>\r\n\r\n                        {/* Receiving History */}\r\n                        {receivingHistory.length > 0 && (\r\n                            <Grid item xs={12}>\r\n                                <Divider sx={{ my: 1 }} />\r\n                                <Typography variant=\"h6\" gutterBottom>Receiving History</Typography>\r\n                                {receivingHistory.map((history) => (\r\n                                    <Box key={history.id} sx={{ mb: 1, p: 1, bgcolor: 'grey.50', borderRadius: 1 }}>\r\n                                        <Typography variant=\"body2\">\r\n                                            <strong>{new Date(history.received_date).toLocaleDateString()}:</strong>\r\n                                            {' '}Received {history.quantity_received} units\r\n                                            {history.notes && ` - ${history.notes}`}\r\n                                        </Typography>\r\n                                    </Box>\r\n                                ))}\r\n                            </Grid>\r\n                        )}\r\n\r\n                        {/* Notes */}\r\n                        {poDetails.notes && (\r\n                            <Grid item xs={12}>\r\n                                <Typography variant=\"subtitle2\" color=\"text.secondary\">Notes</Typography>\r\n                                <Typography variant=\"body2\">{poDetails.notes}</Typography>\r\n                            </Grid>\r\n                        )}\r\n                    </Grid>\r\n                </DialogContent>\r\n                <DialogActions sx={{ flexWrap: 'wrap', gap: 1, p: 2 }}>\r\n                    <Box flex={1} display=\"flex\" gap={1}>\r\n                        <Tooltip title=\"Download PDF\">\r\n                            <IconButton color=\"primary\" onClick={handleDownloadPDF}>\r\n                                <Download />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </Box>\r\n                    <Box display=\"flex\" gap={1} flexWrap=\"wrap\">\r\n                        {poDetails.status === 'draft' && (\r\n                            <Button\r\n                                startIcon={<Send />}\r\n                                variant=\"contained\"\r\n                                onClick={handleSendToSupplier}\r\n                                disabled={loading}\r\n                            >\r\n                                Send to Supplier\r\n                            </Button>\r\n                        )}\r\n                        {(poDetails.status === 'sent' || poDetails.status === 'partially_received') && (\r\n                            <Button\r\n                                startIcon={<LocalShipping />}\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={handleReceiveStock}\r\n                            >\r\n                                Receive Stock\r\n                            </Button>\r\n                        )}\r\n                        <Button onClick={onClose}>Close</Button>\r\n                    </Box>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <ReceiveStockDialog\r\n                open={receiveDialogOpen}\r\n                onClose={handleReceiveDialogClose}\r\n                purchaseOrder={poDetails}\r\n                poItems={poItems}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92\"\n}), 'Share');","import { formatCurrency } from './formatters';\r\n\r\nexport const printPO = (po, items, settings) => {\r\n    try {\r\n        const storeName = settings?.store_name || 'Medical Store';\r\n        const currency = settings?.currency_symbol || 'Rs';\r\n        const poNumber = po?.po_number || 'DRAFT';\r\n        const orderDate = po?.order_date ? new Date(po.order_date).toLocaleDateString() : new Date().toLocaleDateString();\r\n        const supplierName = po?.suppliers?.name || 'N/A';\r\n        const supplierPhone = po?.suppliers?.phone || '';\r\n\r\n        // Create receipt HTML\r\n        const receiptHTML = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>PO #${poNumber}</title>\r\n    <style>\r\n        @media print {\r\n            @page {\r\n                size: 80mm auto;\r\n                margin: 5mm;\r\n            }\r\n            body {\r\n                margin: 0;\r\n                padding: 0;\r\n            }\r\n        }\r\n        \r\n        body {\r\n            font-family: 'Courier New', monospace;\r\n            width: 80mm;\r\n            margin: 0 auto;\r\n            padding: 10px;\r\n            font-size: 12px;\r\n        }\r\n        \r\n        .header {\r\n            text-align: center;\r\n            margin-bottom: 15px;\r\n            border-bottom: 2px dashed #000;\r\n            padding-bottom: 10px;\r\n        }\r\n       \r\n        .store-name {\r\n            font-size: 18px;\r\n            font-weight: bold;\r\n            margin-bottom: 5px;\r\n        }\r\n        \r\n        .receipt-title {\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n            margin-bottom: 5px;\r\n        }\r\n        \r\n        .info-row {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            font-size: 11px;\r\n            margin-bottom: 2px;\r\n        }\r\n        \r\n        .items-table {\r\n            width: 100%;\r\n            margin: 10px 0;\r\n            border-collapse: collapse;\r\n        }\r\n        \r\n        .items-table th {\r\n            text-align: left;\r\n            border-bottom: 1px solid #000;\r\n            padding: 5px 2px;\r\n            font-size: 10px;\r\n        }\r\n        \r\n        .items-table td {\r\n            padding: 5px 2px;\r\n            font-size: 10px;\r\n            vertical-align: top;\r\n        }\r\n        \r\n        .item-name {\r\n            max-width: 40mm;\r\n            word-wrap: break-word;\r\n        }\r\n        \r\n        .text-center {\r\n            text-align: center;\r\n        }\r\n        \r\n        .text-right {\r\n            text-align: right;\r\n        }\r\n        \r\n        .footer {\r\n            text-align: center;\r\n            margin-top: 15px;\r\n            padding-top: 10px;\r\n            border-top: 2px dashed #000;\r\n            font-size: 10px;\r\n            color: #555;\r\n        }\r\n        \r\n        .branding {\r\n            margin-top: 10px;\r\n            font-size: 9px;\r\n            color: #888;\r\n            font-style: italic;\r\n        }\r\n\r\n        .notes {\r\n            margin-top: 10px;\r\n            border-top: 1px dashed #000;\r\n            padding-top: 5px;\r\n            font-size: 11px;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <div class=\"store-name\">${storeName}</div>\r\n        ${settings?.address ? `<div style=\"font-size: 10px;\">${settings.address}</div>` : ''}\r\n        ${settings?.phone ? `<div style=\"font-size: 10px;\">Phone: ${settings.phone}</div>` : ''}\r\n        <div class=\"receipt-title\" style=\"margin-top: 10px;\">PURCHASE ORDER</div>\r\n    </div>\r\n\r\n    <div class=\"info-row\">\r\n        <span>PO #:</span>\r\n        <span>${poNumber}</span>\r\n    </div>\r\n    <div class=\"info-row\">\r\n        <span>Date:</span>\r\n        <span>${orderDate}</span>\r\n    </div>\r\n    <div class=\"info-row\">\r\n        <span>Supplier:</span>\r\n        <span>${supplierName}</span>\r\n    </div>\r\n    ${supplierPhone ? `\r\n    <div class=\"info-row\">\r\n        <span>Supplier Ph:</span>\r\n        <span>${supplierPhone}</span>\r\n    </div>` : ''}\r\n    \r\n    <table class=\"items-table\">\r\n        <thead>\r\n            <tr>\r\n                <th>Item</th>\r\n                <th class=\"text-right\">Qty (Boxes)</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ${items.map(item => {\r\n            // Handle both data formats safely\r\n            let productName = 'N/A';\r\n            if (item.product_name) productName = item.product_name;\r\n            else if (item.products?.name) productName = item.products.name;\r\n\r\n            const quantity = item.quantity_ordered || 0;\r\n\r\n            return `\r\n                <tr>\r\n                    <td class=\"item-name\">${productName}</td>\r\n                    <td class=\"text-right\">${quantity}</td>\r\n                </tr>\r\n                `;\r\n        }).join('')}\r\n        </tbody>\r\n    </table>\r\n    \r\n    ${po.notes ? `\r\n    <div class=\"notes\">\r\n        <strong>Notes:</strong><br/>\r\n        ${po.notes}\r\n    </div>\r\n    ` : ''}\r\n    \r\n    <div class=\"footer\">\r\n        ${settings?.footer_text || 'Thank you for your service!'}\r\n        <div class=\"branding\">\r\n            \r\n        </div>\r\n    </div>\r\n    \r\n    <script>\r\n        // Auto-close window after printing or canceling\r\n        window.onafterprint = function() {\r\n            window.close();\r\n        };\r\n        \r\n        // Trigger print dialog immediately\r\n        window.onload = function() {\r\n            window.print();\r\n        };\r\n    </script>\r\n</body>\r\n</html>\r\n        `;\r\n\r\n        // Open in new window and print\r\n        const printWindow = window.open('', '_blank', 'width=400,height=600');\r\n        if (printWindow) {\r\n            printWindow.document.write(receiptHTML);\r\n            printWindow.document.close();\r\n            return true;\r\n        } else {\r\n            console.error('Could not open print window. Popup blocked?');\r\n            return false;\r\n        }\r\n    } catch (error) {\r\n        console.error('PO printing failed:', error);\r\n        return false;\r\n    }\r\n};\r\n","import React from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Button,\r\n    Box,\r\n    Typography,\r\n    IconButton,\r\n    Divider,\r\n    useTheme,\r\n    useMediaQuery,\r\n    Paper,\r\n    Table,\r\n    TableBody,\r\n    TableRow,\r\n    TableCell,\r\n    TableHead,\r\n    TableContainer,\r\n} from '@mui/material';\r\nimport {\r\n    Close,\r\n    Download,\r\n    Print,\r\n    WhatsApp,\r\n    Share,\r\n    CheckCircle,\r\n} from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { generatePOPDF } from '../../utils/poPdfGenerator';\r\nimport { openWhatsApp } from '../../utils/whatsappHelper';\r\nimport { printPO } from '../../utils/printPO';\r\nimport html2canvas from 'html2canvas';\r\n\r\nexport default function POReceiptModal({ open, onClose, purchaseOrder, poItems, supplier, settings }) {\r\n    const theme = useTheme();\r\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\r\n\r\n    // Return null if no data\r\n    if (!purchaseOrder || !poItems || !supplier) {\r\n        return null;\r\n    }\r\n\r\n    const handleDownloadPDF = async () => {\r\n        try {\r\n            const pdfBlob = await generatePOPDF(purchaseOrder, poItems, settings);\r\n            const url = URL.createObjectURL(pdfBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `${purchaseOrder.po_number}.pdf`;\r\n            link.click();\r\n            URL.revokeObjectURL(url);\r\n            toast.success('PDF downloaded!');\r\n        } catch (error) {\r\n            console.error('Error generating PDF:', error);\r\n            toast.error('Failed to generate PDF: ' + error.message);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        const success = printPO(purchaseOrder, poItems, settings);\r\n        if (!success) {\r\n            toast.error('Failed to open print window. Please allow popups.');\r\n        }\r\n    };\r\n\r\n    const handleShare = async () => {\r\n        try {\r\n            const message = `Purchase Order: ${purchaseOrder.po_number}\\n\\nSupplier: ${supplier?.name}\\nDate: ${new Date(purchaseOrder.order_date).toLocaleDateString()}\\n\\nItems:\\n${poItems.map(item => `- ${item.product_name} x${item.quantity_ordered}`).join('\\n')}`;\r\n\r\n            if (navigator.share) {\r\n                await navigator.share({\r\n                    title: `PO ${purchaseOrder.po_number}`,\r\n                    text: message,\r\n                });\r\n            } else {\r\n                // Fallback to copy\r\n                await navigator.clipboard.writeText(message);\r\n                toast.success('Order details copied to clipboard!');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error sharing:', error);\r\n        }\r\n    };\r\n\r\n    const handleGenerateImage = async () => {\r\n        try {\r\n            const element = document.getElementById('po-receipt-content');\r\n            if (!element) return null;\r\n\r\n            const canvas = await html2canvas(element, {\r\n                scale: 2,\r\n                backgroundColor: '#ffffff',\r\n                logging: false,\r\n            });\r\n\r\n            return new Promise((resolve) => {\r\n                canvas.toBlob((blob) => {\r\n                    resolve(blob);\r\n                }, 'image/png');\r\n            });\r\n        } catch (error) {\r\n            console.error('Error generating image:', error);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    const handleWhatsApp = async () => {\r\n        const phone = supplier?.phone || supplier?.supplier_contacts?.find(c => c.is_primary)?.phone;\r\n        if (!phone) {\r\n            toast.error('No phone number found for supplier');\r\n            return;\r\n        }\r\n\r\n        const loadingToast = toast.loading('Generating receipt image...');\r\n\r\n        try {\r\n            const imageBlob = await handleGenerateImage();\r\n            if (!imageBlob) {\r\n                throw new Error('Failed to generate image');\r\n            }\r\n\r\n            const imageFile = new File(\r\n                [imageBlob],\r\n                `PO-${purchaseOrder.po_number}.png`,\r\n                { type: 'image/png' }\r\n            );\r\n\r\n            // Mobile: Use Web Share API for seamless sharing\r\n            if (navigator.share && navigator.canShare && navigator.canShare({ files: [imageFile] })) {\r\n                toast.update(loadingToast, {\r\n                    render: 'Opening share menu...',\r\n                    type: 'info',\r\n                    isLoading: false,\r\n                    autoClose: 2000\r\n                });\r\n\r\n                await navigator.share({\r\n                    title: `PO ${purchaseOrder.po_number}`,\r\n                    text: `Purchase Order: ${purchaseOrder.po_number}\\n\\nPlease find the order details in the attached image.\\n\\nThank you!`,\r\n                    files: [imageFile]\r\n                });\r\n\r\n                toast.success('Shared successfully!');\r\n            } else {\r\n                // Desktop: Download and open WhatsApp Web\r\n                const url = URL.createObjectURL(imageBlob);\r\n                const link = document.createElement('a');\r\n                link.href = url;\r\n                link.download = `PO-${purchaseOrder.po_number}.png`;\r\n                link.click();\r\n                URL.revokeObjectURL(url);\r\n\r\n                toast.update(loadingToast, {\r\n                    render: 'Image downloaded! Opening WhatsApp - please attach it.',\r\n                    type: 'success',\r\n                    isLoading: false,\r\n                    autoClose: 5000\r\n                });\r\n\r\n                const message = `Purchase Order: ${purchaseOrder.po_number}\\n\\nPlease find the order details in the downloaded image file.\\n\\nThank you!`;\r\n\r\n                setTimeout(() => {\r\n                    openWhatsApp(phone, message);\r\n                }, 1000);\r\n            }\r\n        } catch (e) {\r\n            console.error('Error handling WhatsApp share:', e);\r\n\r\n            if (e.name === 'AbortError') {\r\n                toast.dismiss(loadingToast);\r\n                return;\r\n            }\r\n\r\n            toast.update(loadingToast, {\r\n                render: 'Failed to share. Opening WhatsApp with text only.',\r\n                type: 'warning',\r\n                isLoading: false,\r\n                autoClose: 3000\r\n            });\r\n\r\n            const message = `Purchase Order: ${purchaseOrder.po_number}\\n\\nItems:\\n${poItems.map(item => `- ${item.product_name} x${item.quantity_ordered}`).join('\\n')}\\n\\nPlease confirm availability.`;\r\n            openWhatsApp(phone, message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onClose={onClose} maxWidth=\"sm\" fullWidth>\r\n            <DialogTitle>\r\n                <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                    <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n                        <CheckCircle color=\"success\" />\r\n                        <Typography variant=\"h6\">Purchase Order Created!</Typography>\r\n                    </Box>\r\n                    <IconButton onClick={onClose} size=\"small\">\r\n                        <Close />\r\n                    </IconButton>\r\n                </Box>\r\n            </DialogTitle>\r\n\r\n            <DialogContent>\r\n                {/* Professional Receipt Card */}\r\n                <Paper\r\n                    id=\"po-receipt-content\"\r\n                    elevation={3}\r\n                    sx={{ p: 3, bgcolor: 'grey.50', border: '1px solid', borderColor: 'grey.300' }}\r\n                >\r\n                    {/* Header */}\r\n                    <Box textAlign=\"center\" mb={2}>\r\n                        <Typography variant=\"h5\" fontWeight={700} color=\"primary\" gutterBottom>\r\n                            {settings?.store_name || 'Medical Store'}\r\n                        </Typography>\r\n                        {settings?.address && (\r\n                            <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                {settings.address}\r\n                            </Typography>\r\n                        )}\r\n                        {settings?.phone && (\r\n                            <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                Phone: {settings.phone}\r\n                            </Typography>\r\n                        )}\r\n                        {settings?.owner_name && (\r\n                            <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                Owner: {settings.owner_name}\r\n                            </Typography>\r\n                        )}\r\n                    </Box>\r\n\r\n                    <Divider sx={{ my: 2, borderColor: 'primary.main', borderWidth: 1 }} />\r\n\r\n                    {/* PO Title */}\r\n                    <Box textAlign=\"center\" my={2}>\r\n                        <Typography variant=\"h6\" fontWeight={700} color=\"text.primary\">\r\n                            PURCHASE ORDER\r\n                        </Typography>\r\n                        <Typography variant=\"h4\" fontWeight={700} color=\"primary\" mt={1}>\r\n                            {purchaseOrder.po_number}\r\n                        </Typography>\r\n                    </Box>\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    {/* Details Table */}\r\n                    <Table size=\"small\">\r\n                        <TableBody>\r\n                            <TableRow>\r\n                                <TableCell sx={{ fontWeight: 600, border: 'none', py: 0.5 }}>Date:</TableCell>\r\n                                <TableCell sx={{ border: 'none', py: 0.5 }}>\r\n                                    {new Date(purchaseOrder.order_date).toLocaleDateString()}\r\n                                </TableCell>\r\n                            </TableRow>\r\n                            <TableRow>\r\n                                <TableCell sx={{ fontWeight: 600, border: 'none', py: 0.5 }}>Supplier:</TableCell>\r\n                                <TableCell sx={{ border: 'none', py: 0.5 }}>{supplier?.name}</TableCell>\r\n                            </TableRow>\r\n                            {supplier?.phone && (\r\n                                <TableRow>\r\n                                    <TableCell sx={{ fontWeight: 600, border: 'none', py: 0.5 }}>Supplier Phone:</TableCell>\r\n                                    <TableCell sx={{ border: 'none', py: 0.5 }}>{supplier.phone}</TableCell>\r\n                                </TableRow>\r\n                            )}\r\n                        </TableBody>\r\n                    </Table>\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    {/* Items with Headers */}\r\n                    <Box mb={2}>\r\n                        <Typography variant=\"subtitle2\" fontWeight={700} color=\"text.secondary\" gutterBottom>\r\n                            Items Ordered:\r\n                        </Typography>\r\n                        <TableContainer sx={{ bgcolor: 'white', borderRadius: 1, border: '1px solid', borderColor: 'grey.300' }}>\r\n                            <Table size=\"small\">\r\n                                <TableHead>\r\n                                    <TableRow sx={{ bgcolor: 'grey.100' }}>\r\n                                        <TableCell sx={{ fontWeight: 700 }}>Product</TableCell>\r\n                                        <TableCell align=\"right\" sx={{ fontWeight: 700 }}>Quantity</TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {poItems.map((item, index) => (\r\n                                        <TableRow key={index} hover>\r\n                                            <TableCell>{item.product_name}</TableCell>\r\n                                            <TableCell align=\"right\">\r\n                                                <strong>\r\n                                                    {item.boxes_ordered\r\n                                                        ? `${item.boxes_ordered} Boxes (${item.quantity_ordered} items)`\r\n                                                        : `${item.quantity_ordered} items`\r\n                                                    }\r\n                                                </strong>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </TableContainer>\r\n                    </Box>\r\n\r\n                    {/* Notes */}\r\n                    {purchaseOrder.notes && (\r\n                        <Box mb={2}>\r\n                            <Typography variant=\"subtitle2\" fontWeight={700} color=\"text.secondary\" gutterBottom>\r\n                                Notes:\r\n                            </Typography>\r\n                            <Box sx={{ bgcolor: 'info.lighter', p: 1.5, borderRadius: 1, border: '1px dashed', borderColor: 'info.main' }}>\r\n                                <Typography variant=\"body2\">{purchaseOrder.notes}</Typography>\r\n                            </Box>\r\n                        </Box>\r\n                    )}\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    {/* Signature Area */}\r\n                    <Box mt={3}>\r\n                        <Typography variant=\"caption\" color=\"text.secondary\" display=\"block\" gutterBottom>\r\n                            Digital Signature:\r\n                        </Typography>\r\n                        <Box\r\n                            sx={{\r\n                                border: '2px dashed',\r\n                                borderColor: 'grey.400',\r\n                                borderRadius: 1,\r\n                                p: 2,\r\n                                textAlign: 'center',\r\n                                bgcolor: 'grey.100'\r\n                            }}\r\n                        >\r\n                            <Typography variant=\"body2\" color=\"text.secondary\" fontStyle=\"italic\">\r\n                                Authorized by: {settings?.owner_name || 'Store Owner'}\r\n                            </Typography>\r\n                            <Typography variant=\"caption\" color=\"text.secondary\">\r\n                                {new Date().toLocaleString()}\r\n                            </Typography>\r\n                        </Box>\r\n                    </Box>\r\n\r\n                    {/* Footer */}\r\n                    {settings?.footer_text && (\r\n                        <Box mt={2} textAlign=\"center\">\r\n                            <Typography variant=\"caption\" color=\"text.secondary\" fontStyle=\"italic\">\r\n                                {settings.footer_text}\r\n                            </Typography>\r\n                        </Box>\r\n                    )}\r\n\r\n                    {/* Branding */}\r\n                    <Box mt={2} textAlign=\"center\" pt={2} borderTop=\"1px dashed #ccc\">\r\n                        <Typography variant=\"caption\" color=\"text.secondary\" fontStyle=\"italic\">\r\n                            Receipt designed and generated by <strong>MedixFlow</strong>\r\n                        </Typography>\r\n                        <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\r\n                            Contact: +923089020131\r\n                        </Typography>\r\n                    </Box>\r\n                </Paper>\r\n            </DialogContent>\r\n\r\n            <DialogActions sx={{ p: 2, flexDirection: 'column', gap: 1, bgcolor: 'grey.50' }}>\r\n                <Box display=\"flex\" gap={1} width=\"100%\" flexWrap=\"wrap\" justifyContent=\"center\">\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        startIcon={<WhatsApp />}\r\n                        onClick={handleWhatsApp}\r\n                        fullWidth={isMobile}\r\n                        sx={{ bgcolor: '#25D366', '&:hover': { bgcolor: '#1fb855' } }}\r\n                    >\r\n                        Send via WhatsApp\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Download />}\r\n                        onClick={handleDownloadPDF}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        Download PDF\r\n                    </Button>\r\n                </Box>\r\n                <Box display=\"flex\" gap={1} width=\"100%\" flexWrap=\"wrap\" justifyContent=\"center\">\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Print />}\r\n                        onClick={handlePrint}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        Print\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Share />}\r\n                        onClick={handleShare}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        Share\r\n                    </Button>\r\n                </Box>\r\n                <Button onClick={onClose} fullWidth variant=\"text\" sx={{ mt: 1 }}>\r\n                    Close\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport {\r\n    Container,\r\n    Card,\r\n    CardContent,\r\n    Typography,\r\n    Button,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Box,\r\n    Chip,\r\n    TextField,\r\n    InputAdornment,\r\n    MenuItem,\r\n    IconButton,\r\n    Tooltip,\r\n    useTheme,\r\n    useMediaQuery,\r\n    TablePagination,\r\n} from '@mui/material';\r\nimport {\r\n    Add,\r\n    Search,\r\n    Visibility,\r\n    Edit,\r\n    Send,\r\n    CheckCircle,\r\n    Cancel,\r\n    LocalShipping,\r\n    PendingActions,\r\n    Delete,\r\n    Keyboard,\r\n} from '@mui/icons-material';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { formatCurrency } from '../../utils/formatters';\r\nimport CreateEditPODialog from './CreateEditPODialog';\r\nimport PODetailDialog from './PODetailDialog';\r\nimport POReceiptModal from './POReceiptModal';\r\nimport useSettings from '../../hooks/useSettings';\r\nimport useKeyboardShortcuts from '../../hooks/useKeyboardShortcuts';\r\nimport { useKeyboard } from '../../contexts/KeyboardContext';\r\n\r\nexport default function PurchaseOrdersPage() {\r\n    const { settings } = useSettings();\r\n    const { toggleHelp } = useKeyboard();\r\n    const theme = useTheme();\r\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\r\n\r\n    const [purchaseOrders, setPurchaseOrders] = useState([]);\r\n    const [suppliers, setSuppliers] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Filter states\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('all');\r\n    const [supplierFilter, setSupplierFilter] = useState('all');\r\n\r\n    // Pagination states\r\n    const [page, setPage] = useState(0);\r\n    const [rowsPerPage, setRowsPerPage] = useState(25);\r\n    const [totalCount, setTotalCount] = useState(0);\r\n\r\n    // Dialog states\r\n    const [createDialogOpen, setCreateDialogOpen] = useState(false);\r\n    const [detailDialogOpen, setDetailDialogOpen] = useState(false);\r\n    const [selectedPO, setSelectedPO] = useState(null);\r\n    const [receiptModalOpen, setReceiptModalOpen] = useState(false);\r\n    const [receiptData, setReceiptData] = useState({ po: null, items: [], supplier: null });\r\n\r\n    const searchInputRef = useRef(null);\r\n\r\n    useKeyboardShortcuts({\r\n        'Alt+n': () => handleCreateNew(),\r\n        'Alt+f': () => searchInputRef.current?.focus(),\r\n    }, 'Purchase Orders Page');\r\n\r\n    useEffect(() => {\r\n        fetchPurchaseOrders();\r\n        fetchSuppliers();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const delayDebounceFn = setTimeout(() => {\r\n            fetchPurchaseOrders();\r\n        }, 500);\r\n\r\n        return () => clearTimeout(delayDebounceFn);\r\n    }, [searchQuery, statusFilter, supplierFilter, page, rowsPerPage]);\r\n\r\n    useEffect(() => {\r\n        fetchSuppliers();\r\n    }, []);\r\n\r\n    const fetchPurchaseOrders = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) return;\r\n\r\n            let query = supabase\r\n                .from('purchase_orders')\r\n                .select(`\r\n                    *,\r\n                    suppliers(name, phone, supplier_contacts(*))\r\n                `, { count: 'exact' })\r\n                .eq('organization_id', session.user.id)\r\n                .is('deleted_at', null)\r\n                .order('created_at', { ascending: false });\r\n\r\n            // Apply filters\r\n            if (searchQuery) {\r\n                query = query.ilike('po_number', `%${searchQuery}%`);\r\n            }\r\n\r\n            if (statusFilter !== 'all') {\r\n                query = query.eq('status', statusFilter);\r\n            }\r\n\r\n            if (supplierFilter !== 'all') {\r\n                query = query.eq('supplier_id', supplierFilter);\r\n            }\r\n\r\n            const from = page * rowsPerPage;\r\n            const to = from + rowsPerPage - 1;\r\n\r\n            const { data, count, error } = await query.range(from, to);\r\n\r\n            if (error) throw error;\r\n            setPurchaseOrders(data || []);\r\n            setTotalCount(count || 0);\r\n        } catch (error) {\r\n            console.error('Error fetching POs:', error);\r\n            toast.error('Failed to load purchase orders');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const fetchSuppliers = async () => {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session) return;\r\n\r\n        const { data, error } = await supabase\r\n            .from('suppliers')\r\n            .select('*, supplier_contacts(*)')\r\n            .eq('organization_id', session.user.id)\r\n            .is('deleted_at', null)\r\n            .order('name');\r\n\r\n        if (error) {\r\n            console.error('Error fetching suppliers:', error);\r\n        } else {\r\n            setSuppliers(data || []);\r\n        }\r\n    };\r\n\r\n    const handleChangePage = (event, newPage) => {\r\n        setPage(newPage);\r\n    };\r\n\r\n    const handleChangeRowsPerPage = (event) => {\r\n        setRowsPerPage(parseInt(event.target.value, 10));\r\n        setPage(0);\r\n    };\r\n\r\n    const getStatusColor = (status) => {\r\n        const colors = {\r\n            draft: 'default',\r\n            sent: 'primary',\r\n            partially_received: 'secondary',\r\n            received: 'success',\r\n        };\r\n        return colors[status] || 'default';\r\n    };\r\n\r\n    const getStatusIcon = (status) => {\r\n        const icons = {\r\n            draft: <Edit fontSize=\"small\" />,\r\n            sent: <Send fontSize=\"small\" />,\r\n            partially_received: <LocalShipping fontSize=\"small\" />,\r\n            received: <CheckCircle fontSize=\"small\" />,\r\n        };\r\n        return icons[status];\r\n    };\r\n\r\n    const getStatusLabel = (status) => {\r\n        const labels = {\r\n            draft: 'Draft',\r\n            sent: 'Sent',\r\n            partially_received: 'Receiving',\r\n            received: 'Completed',\r\n        };\r\n        return labels[status] || status;\r\n    };\r\n\r\n    const handleViewDetails = (po) => {\r\n        setSelectedPO(po);\r\n        setDetailDialogOpen(true);\r\n    };\r\n\r\n    const handleEdit = (po) => {\r\n        setSelectedPO(po);\r\n        setCreateDialogOpen(true);\r\n    };\r\n\r\n    const handleCreateNew = () => {\r\n        setSelectedPO(null);\r\n        setCreateDialogOpen(true);\r\n    };\r\n\r\n    const handleDialogClose = (newPO, items, supplier) => {\r\n        setCreateDialogOpen(false);\r\n\r\n        // If PO was created (not edited), show receipt modal\r\n        if (newPO && items && supplier) {\r\n            setReceiptData({ po: newPO, items, supplier });\r\n            setReceiptModalOpen(true);\r\n        }\r\n\r\n        setSelectedPO(null);\r\n        fetchPurchaseOrders();\r\n    };\r\n\r\n    const handleDelete = async (po) => {\r\n        if (!window.confirm(`Are you sure you want to delete PO ${po.po_number}?`)) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const { error } = await supabase\r\n                .from('purchase_orders')\r\n                .update({ deleted_at: new Date().toISOString() })\r\n                .eq('id', po.id);\r\n\r\n            if (error) throw error;\r\n\r\n            toast.success('Purchase order deleted!');\r\n            fetchPurchaseOrders();\r\n        } catch (error) {\r\n            console.error('Error deleting PO:', error);\r\n            toast.error('Failed to delete purchase order');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Container maxWidth=\"xl\">\r\n            <Box\r\n                display=\"flex\"\r\n                flexDirection={isMobile ? 'column' : 'row'}\r\n                justifyContent=\"space-between\"\r\n                alignItems={isMobile ? 'flex-start' : 'center'}\r\n                gap={2}\r\n                mb={3}\r\n            >\r\n                <Typography variant=\"h4\" fontWeight={700} color=\"primary\">\r\n                    Purchase Orders\r\n                </Typography>\r\n                <Box display=\"flex\" gap={1}>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        startIcon={<Keyboard />}\r\n                        onClick={toggleHelp}\r\n                        size={isMobile ? 'small' : 'medium'}\r\n                    >\r\n                        Shortcuts\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        startIcon={<Add />}\r\n                        onClick={handleCreateNew}\r\n                        fullWidth={isMobile}\r\n                    >\r\n                        New Purchase Order (Alt+n)\r\n                    </Button>\r\n                </Box>\r\n            </Box>\r\n\r\n            {/* Filters */}\r\n            <Card sx={{ mb: 3 }}>\r\n                <CardContent>\r\n                    <Box display=\"flex\" gap={2} flexWrap=\"wrap\">\r\n                        <TextField\r\n                            label=\"Search PO (Alt+f)\"\r\n                            inputRef={searchInputRef}\r\n                            value={searchQuery}\r\n                            onChange={(e) => setSearchQuery(e.target.value)}\r\n                            size=\"small\"\r\n                            sx={{ minWidth: 250 }}\r\n                            InputProps={{\r\n                                startAdornment: (\r\n                                    <InputAdornment position=\"start\">\r\n                                        <Search />\r\n                                    </InputAdornment>\r\n                                ),\r\n                            }}\r\n                        />\r\n                        <TextField\r\n                            select\r\n                            label=\"Status\"\r\n                            value={statusFilter}\r\n                            onChange={(e) => setStatusFilter(e.target.value)}\r\n                            size=\"small\"\r\n                            sx={{ minWidth: 150 }}\r\n                        >\r\n                            <MenuItem value=\"all\">All Status</MenuItem>\r\n                            <MenuItem value=\"draft\">Draft</MenuItem>\r\n                            <MenuItem value=\"sent\">Sent</MenuItem>\r\n                            <MenuItem value=\"partially_received\">Receiving</MenuItem>\r\n                            <MenuItem value=\"received\">Completed</MenuItem>\r\n                        </TextField>\r\n                        <TextField\r\n                            select\r\n                            label=\"Supplier\"\r\n                            value={supplierFilter}\r\n                            onChange={(e) => setSupplierFilter(e.target.value)}\r\n                            size=\"small\"\r\n                            sx={{ minWidth: 200 }}\r\n                        >\r\n                            <MenuItem value=\"all\">All Suppliers</MenuItem>\r\n                            {suppliers.map((supplier) => (\r\n                                <MenuItem key={supplier.id} value={supplier.id}>\r\n                                    {supplier.name}\r\n                                </MenuItem>\r\n                            ))}\r\n                        </TextField>\r\n                    </Box>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Purchase Orders Table */}\r\n            <Card>\r\n                <TableContainer sx={{ overflowX: 'auto', maxWidth: '100%' }}>\r\n                    <Table sx={{ minWidth: 900 }}>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell><strong>PO Number</strong></TableCell>\r\n                                <TableCell><strong>Supplier</strong></TableCell>\r\n                                <TableCell><strong>Order Date</strong></TableCell>\r\n                                <TableCell><strong>Status</strong></TableCell>\r\n                                <TableCell align=\"right\"><strong>Total Amount</strong></TableCell>\r\n                                <TableCell align=\"right\"><strong>Actions</strong></TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {loading ? (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={6} align=\"center\">Loading...</TableCell>\r\n                                </TableRow>\r\n                            ) : purchaseOrders.length === 0 ? (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={6} align=\"center\">\r\n                                        No purchase orders found\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            ) : (\r\n                                purchaseOrders.map((po) => (\r\n                                    <TableRow key={po.id} hover>\r\n                                        <TableCell>\r\n                                            <Typography variant=\"body2\" fontWeight={600}>\r\n                                                {po.po_number}\r\n                                            </Typography>\r\n                                        </TableCell>\r\n                                        <TableCell>{po.suppliers?.name || ''}</TableCell>\r\n                                        <TableCell>\r\n                                            {new Date(po.order_date).toLocaleDateString()}\r\n                                        </TableCell>\r\n                                        <TableCell>\r\n                                            <Chip\r\n                                                icon={getStatusIcon(po.status)}\r\n                                                label={getStatusLabel(po.status)}\r\n                                                color={getStatusColor(po.status)}\r\n                                                size=\"small\"\r\n                                            />\r\n                                        </TableCell>\r\n                                        <TableCell align=\"right\">\r\n                                            <Typography variant=\"body2\" fontWeight={600}>\r\n                                                {settings?.currency_symbol || 'Rs'}\r\n                                                {formatCurrency(po.final_amount || po.total_amount, '')}\r\n                                            </Typography>\r\n                                        </TableCell>\r\n                                        <TableCell align=\"right\">\r\n                                            <Box display=\"flex\" gap={1} justifyContent=\"flex-end\">\r\n                                                <Tooltip title=\"View Details\">\r\n                                                    <IconButton\r\n                                                        size=\"small\"\r\n                                                        color=\"primary\"\r\n                                                        onClick={() => handleViewDetails(po)}\r\n                                                    >\r\n                                                        <Visibility fontSize=\"small\" />\r\n                                                    </IconButton>\r\n                                                </Tooltip>\r\n                                                {po.status === 'draft' && (\r\n                                                    <>\r\n                                                        <Tooltip title=\"Edit\">\r\n                                                            <IconButton\r\n                                                                size=\"small\"\r\n                                                                color=\"secondary\"\r\n                                                                onClick={() => handleEdit(po)}\r\n                                                            >\r\n                                                                <Edit fontSize=\"small\" />\r\n                                                            </IconButton>\r\n                                                        </Tooltip>\r\n                                                        <Tooltip title=\"Delete\">\r\n                                                            <IconButton\r\n                                                                size=\"small\"\r\n                                                                color=\"error\"\r\n                                                                onClick={() => handleDelete(po)}\r\n                                                            >\r\n                                                                <Delete fontSize=\"small\" />\r\n                                                            </IconButton>\r\n                                                        </Tooltip>\r\n                                                    </>\r\n                                                )}\r\n                                            </Box>\r\n                                        </TableCell>\r\n                                    </TableRow>\r\n                                ))\r\n                            )}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n            </Card>\r\n\r\n            <TablePagination\r\n                rowsPerPageOptions={[10, 25, 50, 100]}\r\n                component=\"div\"\r\n                count={totalCount}\r\n                rowsPerPage={rowsPerPage}\r\n                page={page}\r\n                onPageChange={handleChangePage}\r\n                onRowsPerPageChange={handleChangeRowsPerPage}\r\n            />\r\n\r\n            {/* Dialogs */}\r\n            <CreateEditPODialog\r\n                open={createDialogOpen}\r\n                onClose={handleDialogClose}\r\n                purchaseOrder={selectedPO}\r\n                suppliers={suppliers}\r\n            />\r\n\r\n            <PODetailDialog\r\n                open={detailDialogOpen}\r\n                onClose={() => setDetailDialogOpen(false)}\r\n                purchaseOrder={selectedPO}\r\n                onRefresh={fetchPurchaseOrders}\r\n            />\r\n\r\n            <POReceiptModal\r\n                open={receiptModalOpen}\r\n                onClose={() => setReceiptModalOpen(false)}\r\n                purchaseOrder={receiptData.po}\r\n                poItems={receiptData.items}\r\n                supplier={receiptData.supplier}\r\n                settings={settings}\r\n            />\r\n        </Container>\r\n    );\r\n}\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z\"\n}), 'Add');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z\"\n}), 'Edit');","/**\r\n * Generates a WhatsApp URL for ordering a product\r\n * @param {string} phone - Supplier's phone number\r\n * @param {string} productName - Name of the product\r\n * @param {number} currentStock - Current stock level\r\n * @param {string} storeName - Name of the medical store (optional)\r\n * @returns {string|null} - WhatsApp URL or null if no phone provided\r\n */\r\nexport const generateWhatsAppLink = (phone, productName, currentStock, storeName = 'Medical Store') => {\r\n    if (!phone) return null;\r\n\r\n    // Remove non-numeric characters from phone\r\n    const cleanPhone = phone.replace(/\\D/g, '');\r\n\r\n    const message = `Hi, this is ${storeName}. We need to order \"${productName}\". Current stock is ${currentStock}. Please let us know availability and price.`;\r\n\r\n    const encodedMessage = encodeURIComponent(message);\r\n\r\n    return `https://wa.me/${cleanPhone}?text=${encodedMessage}`;\r\n};\r\n\r\n/**\r\n * Opens WhatsApp in a new tab\r\n * @param {string} phone - Supplier's phone number\r\n * @param {string} productName - Name of the product\r\n * @param {number} currentStock - Current stock level\r\n * @param {string} storeName - Name of the medical store\r\n */\r\nexport const openWhatsAppOrder = (phone, productName, currentStock, storeName) => {\r\n    const url = generateWhatsAppLink(phone, productName, currentStock, storeName);\r\n    if (url) {\r\n        window.open(url, '_blank');\r\n    } else {\r\n        alert('Supplier phone number is missing!');\r\n    }\r\n};\r\n\r\n/**\r\n * Opens WhatsApp with a custom message\r\n * @param {string} phone - Phone number\r\n * @param {string} message - Message to send\r\n */\r\nexport const openWhatsApp = (phone, message) => {\r\n    if (!phone) {\r\n        alert('Phone number is missing!');\r\n        return;\r\n    }\r\n\r\n    // Remove non-numeric characters from phone\r\n    const cleanPhone = phone.replace(/\\D/g, '');\r\n    const encodedMessage = encodeURIComponent(message);\r\n    const url = `https://wa.me/${cleanPhone}?text=${encodedMessage}`;\r\n\r\n    window.open(url, '_blank');\r\n};\r\n\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z\"\n}), 'CheckCircle');"],"names":["createSvgIcon","_jsx","d","formatCurrency","value","symbol","arguments","length","undefined","isNaN","concat","num","Number","toLocaleString","minimumFractionDigits","maximumFractionDigits","formatNumber","formatPercentage","decimals","toFixed","CreateEditPODialog","_ref","open","onClose","purchaseOrder","suppliers","isEdit","formData","setFormData","useState","supplier_id","order_date","Date","toISOString","split","notes","items","setItems","products","setProducts","loading","setLoading","useEffect","fetchProducts","loadPOData","resetForm","async","data","session","supabase","auth","getSession","from","select","eq","user","id","is","order","map","item","_item$products","product_id","product_name","name","quantity_ordered","boxes_ordered","items_per_box","handleChange","e","_objectSpread","target","handleItemChange","index","field","newItems","product","find","p","boxes","perBox","parseInt","_jsxs","Dialog","maxWidth","fullWidth","children","DialogTitle","Box","display","alignItems","gap","ShoppingCart","color","DialogContent","Grid","container","spacing","sx","mt","xs","sm","TextField","required","label","onChange","supplier","MenuItem","type","InputLabelProps","shrink","Divider","my","justifyContent","mb","Typography","variant","Button","startIcon","Add","onClick","handleAddItem","TableContainer","Table","size","TableHead","TableRow","TableCell","width","TableBody","Autocomplete","options","getOptionLabel","option","newValue","renderInput","params","placeholder","inputProps","min","helperText","IconButton","filter","_","i","handleRemoveItem","Delete","fontSize","multiline","rows","bgcolor","borderRadius","DialogActions","some","toast","error","Error","poError","update","updated_at","delete","itemsError","insert","purchase_order_id","unit_price","success","poNumberData","rpc","poNumber","now","newPO","po_number","currency_id","status","created_by","organization_id","total_amount","final_amount","single","itemsWithNames","_products$find","s","console","message","disabled","ReceiveStockDialog","poItems","receivingData","setReceivingData","receivedDate","setReceivedDate","setNotes","fetchProductDetails","productIds","in","productMap","forEach","po_item_id","quantity_already_received","quantity_received","quantity_remaining","quantity_to_receive","cost_price","selling_price","price","boxes_received","cost_per_box","total_cost","selling_price_per_box","total_selling_price","handleQuantityChange","newData","parseFloat","totalQty","Math","round","maxReceivable","qty","handlePriceChange","totalItems","totalCost","sellBox","totalToReceive","reduce","sum","totalAmount","LocalShipping","overflowX","maxHeight","stickyHeader","align","Chip","style","textAlign","step","fontWeight","handleReceiveAll","Inventory","itemsToReceive","stockReceipt","receiptError","quantity","received_date","currentProduct","fetchError","newStock","stock","updateError","price_per_box","poItemError","received_by","stock_receipt_id","every","generatePOPDF","po","settings","_po$suppliers","_po$suppliers2","doc","jsPDF","storeName","store_name","orderDate","toLocaleDateString","supplierName","supplierPhone","phone","Array","isArray","setFontSize","setFont","text","yPos","address","owner_name","setLineWidth","line","infoY","tableColumn","tableRows","productName","toString","autoTable","head","body","startY","theme","headStyles","fillColor","fontStyle","styles","columnStyles","cellWidth","halign","finalY","lastAutoTable","splitText","splitTextToSize","addPage","pageHeight","internal","pageSize","height","setTextColor","footerY","footer_text","output","PODetailDialog","_poDetails$suppliers3","_poDetails$suppliers4","onRefresh","poDetails","setPODetails","setPOItems","receivingHistory","setReceivingHistory","receiveDialogOpen","setReceiveDialogOpen","fetchPODetails","history","historyError","ascending","_Fragment","Close","flexWrap","draft","sent","partially_received","received","getStatusColor","expected_delivery_date","gutterBottom","flex","Tooltip","title","settingsData","pdfBlob","url","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","Download","Send","_poDetails$suppliers","_poDetails$suppliers$","_poDetails$suppliers2","info","pdfError","warning","sent_at","primaryContact","supplier_contacts","c","is_primary","setTimeout","openWhatsApp","handleReceiveStock","handleReceiveDialogClose","printPO","currency_symbol","receiptHTML","join","printWindow","window","write","close","POReceiptModal","useTheme","isMobile","useMediaQuery","breakpoints","down","CheckCircle","Paper","elevation","border","borderColor","borderWidth","py","hover","pt","borderTop","flexDirection","WhatsApp","_supplier$supplier_co","_supplier$supplier_co2","loadingToast","imageBlob","element","getElementById","canvas","html2canvas","scale","backgroundColor","logging","Promise","resolve","toBlob","blob","handleGenerateImage","imageFile","File","navigator","share","canShare","files","render","isLoading","autoClose","dismiss","Print","handlePrint","Share","clipboard","writeText","PurchaseOrdersPage","useSettings","toggleHelp","useKeyboard","purchaseOrders","setPurchaseOrders","setSuppliers","searchQuery","setSearchQuery","statusFilter","setStatusFilter","supplierFilter","setSupplierFilter","page","setPage","rowsPerPage","setRowsPerPage","totalCount","setTotalCount","createDialogOpen","setCreateDialogOpen","detailDialogOpen","setDetailDialogOpen","selectedPO","setSelectedPO","receiptModalOpen","setReceiptModalOpen","receiptData","setReceiptData","searchInputRef","useRef","useKeyboardShortcuts","Alt+n","handleCreateNew","Alt+f","_searchInputRef$curre","current","focus","fetchPurchaseOrders","fetchSuppliers","delayDebounceFn","clearTimeout","query","count","ilike","to","range","getStatusLabel","Container","Keyboard","Card","CardContent","inputRef","minWidth","InputProps","startAdornment","InputAdornment","position","Search","colSpan","icon","Edit","handleViewDetails","Visibility","handleEdit","confirm","deleted_at","handleDelete","TablePagination","rowsPerPageOptions","component","onPageChange","handleChangePage","event","newPage","onRowsPerPageChange","handleDialogClose","openWhatsAppOrder","currentStock","cleanPhone","replace","encodedMessage","encodeURIComponent","generateWhatsAppLink","alert"],"sourceRoot":""}