{"version":3,"file":"static/js/568.4391879a.chunk.js","mappings":"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","sources":["components/sales/DailySales.js","components/sales/SalesPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Card,\r\n    CardContent,\r\n    Typography,\r\n    Box,\r\n    Button,\r\n    Divider,\r\n    CircularProgress,\r\n} from '@mui/material';\r\nimport { ReceiptLong, Download, TableChart } from '@mui/icons-material';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { formatCurrency } from '../../utils/formatters';\r\nimport { toast } from 'react-toastify';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport useSettings from '../../hooks/useSettings';\r\n\r\nexport default function DailySales() {\r\n    const { settings } = useSettings();\r\n    const [todaySales, setTodaySales] = useState([]);\r\n    const [totalAmount, setTotalAmount] = useState(0);\r\n    const [loading, setLoading] = useState(true);\r\n    const [downloading, setDownloading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchTodaySales();\r\n\r\n        // Listen for auth changes (in case session isn't ready on mount)\r\n        const { data: { subscription: authSubscription } } = supabase.auth.onAuthStateChange((event, session) => {\r\n            if (event === 'SIGNED_IN' || session) {\r\n                fetchTodaySales();\r\n            }\r\n        });\r\n\r\n        // Subscribe to realtime changes\r\n        const subscription = supabase\r\n            .channel('public:sales')\r\n            .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'sales' }, () => {\r\n                // Always fetch on new sale to be safe and ensure UI is in sync\r\n                fetchTodaySales();\r\n            })\r\n            .subscribe();\r\n\r\n        return () => {\r\n            subscription.unsubscribe();\r\n            authSubscription.unsubscribe();\r\n        };\r\n    }, []);\r\n\r\n    async function fetchTodaySales() {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session) return;\r\n        const orgId = session.user.id;\r\n\r\n        // Calculate today's date in local time (YYYY-MM-DD)\r\n        const now = new Date();\r\n        const year = now.getFullYear();\r\n        const month = String(now.getMonth() + 1).padStart(2, '0');\r\n        const day = String(now.getDate()).padStart(2, '0');\r\n        const today = `${year}-${month}-${day}`;\r\n\r\n        const { data, error } = await supabase\r\n            .from('sales')\r\n            .select('*, products(name)')\r\n            .eq('organization_id', orgId)\r\n            .eq('sale_date', today)\r\n            .is('deleted_at', null);\r\n\r\n        if (error) {\r\n            console.error('Error fetching today sales:', error);\r\n            return;\r\n        }\r\n\r\n        setTodaySales(data || []);\r\n        const total = (data || []).reduce((sum, sale) => sum + (sale.quantity * sale.price_at_sale), 0);\r\n        setTotalAmount(total);\r\n        setLoading(false);\r\n    }\r\n\r\n    const handleDownloadPDF = async () => {\r\n        if (todaySales.length === 0) {\r\n            toast.info('No sales to report for today.');\r\n            return;\r\n        }\r\n\r\n        setDownloading(true);\r\n        try {\r\n            const doc = new jsPDF();\r\n            const today = new Date().toLocaleDateString();\r\n            const storeName = settings?.store_name || 'Medical Store';\r\n            const currency = settings?.currency_symbol || '$';\r\n\r\n            // Header\r\n            doc.setFontSize(20);\r\n            doc.text(storeName, 105, 15, { align: 'center' });\r\n            doc.setFontSize(14);\r\n            doc.text(`Daily Sales Report - ${today}`, 105, 25, { align: 'center' });\r\n\r\n            // Summary\r\n            doc.setFontSize(12);\r\n            doc.text(`Total Sales Count: ${todaySales.length}`, 14, 35);\r\n            doc.text(`Total Revenue: ${formatCurrency(totalAmount, currency)}`, 14, 42);\r\n\r\n            // Table\r\n            const tableColumn = [\"Time\", \"Product\", \"Qty\", \"Unit\", \"Price\", \"Total\"];\r\n            const tableRows = todaySales.map(sale => [\r\n                new Date(sale.created_at).toLocaleTimeString(),\r\n                sale.products?.name || 'Unknown Product',\r\n                sale.quantity,\r\n                sale.selling_unit === 'box' ? 'Box' : 'Item',\r\n                formatCurrency(sale.price_at_sale, currency),\r\n                formatCurrency(sale.quantity * sale.price_at_sale, currency)\r\n            ]);\r\n\r\n            // Use autoTable as a function\r\n            autoTable(doc, {\r\n                head: [tableColumn],\r\n                body: tableRows,\r\n                startY: 50,\r\n                styles: { fontSize: 10 },\r\n                headStyles: { fillColor: [99, 102, 241] },\r\n            });\r\n\r\n            // Footer\r\n            const finalY = (doc.lastAutoTable && doc.lastAutoTable.finalY) || 50;\r\n            doc.setFontSize(10);\r\n            doc.text('_______________________', 150, finalY + 30);\r\n            doc.text('Authorized Signature', 150, finalY + 40);\r\n\r\n            doc.save(`daily_sales_${today.replace(/\\//g, '-')}.pdf`);\r\n            toast.success('PDF downloaded successfully!');\r\n        } catch (error) {\r\n            console.error('Error generating PDF:', error);\r\n            toast.error(`Failed to generate PDF: ${error.message}`);\r\n        } finally {\r\n            setDownloading(false);\r\n        }\r\n    };\r\n\r\n    const handleDownloadCSV = () => {\r\n        if (todaySales.length === 0) {\r\n            toast.info('No sales to export for today.');\r\n            return;\r\n        }\r\n\r\n        setDownloading(true);\r\n        try {\r\n            const today = new Date().toLocaleDateString();\r\n            const currency = settings?.currency_symbol || '$';\r\n\r\n            // CSV Headers\r\n            let csvContent = \"Time,Product,Quantity,Unit,Price,Total,Payment Method,Customer\\n\";\r\n\r\n            // CSV Rows\r\n            todaySales.forEach(sale => {\r\n                const time = new Date(sale.created_at).toLocaleTimeString();\r\n                const product = (sale.products?.name || 'Unknown Product').replace(/\"/g, '\"\"'); // Escape quotes\r\n                const qty = sale.quantity;\r\n                const unit = sale.selling_unit === 'box' ? 'Box' : 'Item';\r\n                const price = sale.price_at_sale;\r\n                const total = qty * price;\r\n                const payment = sale.payment_method || 'N/A';\r\n                const customer = sale.customers?.name || 'Walk-in';\r\n\r\n                csvContent += `\"${time}\",\"${product}\",${qty},\"${unit}\",${price},${total},\"${payment}\",\"${customer}\"\\n`;\r\n            });\r\n\r\n            // Add summary rows\r\n            csvContent += `\\n\"Summary\",,,,,,\\n`;\r\n            csvContent += `\"Total Transactions\",${todaySales.length},,,,,\\n`;\r\n            csvContent += `\"Total Revenue\",${totalAmount},,,,,\\n`;\r\n\r\n            // Create and download\r\n            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n            const link = document.createElement('a');\r\n            const url = URL.createObjectURL(blob);\r\n            link.setAttribute('href', url);\r\n            link.setAttribute('download', `daily_sales_${today.replace(/\\//g, '-')}.csv`);\r\n            link.style.visibility = 'hidden';\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n\r\n            toast.success('CSV downloaded successfully!');\r\n        } catch (error) {\r\n            console.error('Error generating CSV:', error);\r\n            toast.error(`Failed to generate CSV: ${error.message}`);\r\n        } finally {\r\n            setDownloading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Card sx={{ height: '100%', background: 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)', color: 'white' }}>\r\n            <CardContent>\r\n                <Box display=\"flex\" alignItems=\"center\" gap={1} mb={2}>\r\n                    <ReceiptLong />\r\n                    <Typography variant=\"h6\" fontWeight={600}>\r\n                        Today's Sales\r\n                    </Typography>\r\n                </Box>\r\n\r\n                <Typography variant=\"h3\" fontWeight={700} mb={1}>\r\n                    {formatCurrency(totalAmount, settings.currency_symbol)}\r\n                </Typography>\r\n\r\n                <Typography variant=\"body2\" sx={{ opacity: 0.8, mb: 3 }}>\r\n                    {todaySales.length} transactions today\r\n                </Typography>\r\n\r\n                <Divider sx={{ borderColor: 'rgba(255,255,255,0.2)', mb: 2 }} />\r\n\r\n                <Box display=\"flex\" gap={1}>\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        color=\"secondary\"\r\n                        fullWidth\r\n                        size=\"large\"\r\n                        sx={{ minHeight: 48 }}\r\n                        startIcon={downloading ? <CircularProgress size={20} color=\"inherit\" /> : <Download />}\r\n                        onClick={handleDownloadPDF}\r\n                        disabled={loading || todaySales.length === 0 || downloading}\r\n                    >\r\n                        PDF\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        size=\"large\"\r\n                        sx={{\r\n                            minHeight: 48,\r\n                            borderColor: 'white',\r\n                            color: 'white',\r\n                            '&:hover': {\r\n                                borderColor: 'white',\r\n                                backgroundColor: 'rgba(255,255,255,0.1)',\r\n                            }\r\n                        }}\r\n                        startIcon={downloading ? <CircularProgress size={20} color=\"inherit\" /> : <TableChart />}\r\n                        onClick={handleDownloadCSV}\r\n                        disabled={loading || todaySales.length === 0 || downloading}\r\n                    >\r\n                        CSV\r\n                    </Button>\r\n                </Box>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","import React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport {\r\n    Container,\r\n    Card,\r\n    CardContent,\r\n    Typography,\r\n    TextField,\r\n    Button,\r\n    Grid,\r\n    Box,\r\n    Autocomplete,\r\n    IconButton,\r\n    Chip,\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    CircularProgress,\r\n    Paper,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    InputAdornment,\r\n    Divider\r\n} from '@mui/material';\r\nimport {\r\n    Add,\r\n    Delete,\r\n    ShoppingCart,\r\n    Search,\r\n    Save,\r\n    Keyboard,\r\n    Close\r\n} from '@mui/icons-material';\r\nimport {\r\n    useReactTable,\r\n    getCoreRowModel,\r\n    flexRender,\r\n} from '@tanstack/react-table';\r\nimport { toast } from 'react-toastify';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { formatCurrency } from '../../utils/formatters';\r\nimport useSettings from '../../hooks/useSettings';\r\nimport useKeyboardShortcuts from '../../hooks/useKeyboardShortcuts';\r\nimport DailySales from './DailySales';\r\nimport ReceiptModal from '../shared/ReceiptModal';\r\n\r\nexport default function SalesPage() {\r\n    const { settings } = useSettings();\r\n    const [searchParams] = useSearchParams();\r\n\r\n    // -- State --\r\n    const [products, setProducts] = useState([]);\r\n    const [customers, setCustomers] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [receiptModalOpen, setReceiptModalOpen] = useState(false);\r\n    const [receiptData, setReceiptData] = useState({ invoice: null, items: [] });\r\n    const [helpOpen, setHelpOpen] = useState(false);\r\n\r\n    // Cart & Selection\r\n    const [cart, setCart] = useState([]);\r\n    const [selectedCustomer, setSelectedCustomer] = useState(null);\r\n    const [selectedProduct, setSelectedProduct] = useState(null);\r\n\r\n    // Form Data (Global for sale)\r\n    const [globalDiscount, setGlobalDiscount] = useState('0');\r\n    const [paymentMethod, setPaymentMethod] = useState('cash');\r\n    const [saleDate, setSaleDate] = useState(searchParams.get('date') || new Date().toISOString().split('T')[0]);\r\n    const [notes, setNotes] = useState('');\r\n\r\n    // Refs for focus management\r\n    const searchInputRef = useRef(null);\r\n    const discountInputRef = useRef(null);\r\n    const payButtonRef = useRef(null);\r\n    const customerInputRef = useRef(null);\r\n\r\n    // -- Effects --\r\n    useEffect(() => {\r\n        fetchCustomers();\r\n        // Focus search on mount\r\n        if (searchInputRef.current) {\r\n            searchInputRef.current.focus();\r\n        }\r\n    }, []);\r\n\r\n    // -- Data Fetching --\r\n    async function fetchCustomers() {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (!session) return;\r\n        const orgId = session.user.id;\r\n\r\n        const { data } = await supabase\r\n            .from('customers')\r\n            .select('*')\r\n            .eq('organization_id', orgId)\r\n            .is('deleted_at', null)\r\n            .order('name');\r\n        setCustomers(data || []);\r\n    }\r\n\r\n    const searchProducts = async (query) => {\r\n        if (!query || query.length < 2) {\r\n            setProducts([]);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data, error } = await supabase\r\n                .rpc('search_products', {\r\n                    search_term: query,\r\n                    p_limit: 50\r\n                });\r\n\r\n            if (error) throw error;\r\n            setProducts(data || []);\r\n        } catch (error) {\r\n            console.error('Error searching products:', error);\r\n            setProducts([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // -- Cart Logic --\r\n    const addToCart = (product) => {\r\n        if (!product) return;\r\n\r\n        // Default to item unit\r\n        const sellingUnit = product.selling_unit === 'box' ? 'box' : 'item';\r\n        const price = sellingUnit === 'box'\r\n            ? (product.price_per_box || (product.price * (product.items_per_box || 1)))\r\n            : product.price;\r\n\r\n        setCart(prev => {\r\n            const existingIndex = prev.findIndex(item => item.product.id === product.id && item.selling_unit === sellingUnit);\r\n            if (existingIndex >= 0) {\r\n                const newCart = [...prev];\r\n                const newQty = newCart[existingIndex].quantity + 1;\r\n\r\n                // Check Stock\r\n                const totalItemsRequested = newCart[existingIndex].selling_unit === 'box'\r\n                    ? newQty * (product.items_per_box || 1)\r\n                    : newQty;\r\n\r\n                if (totalItemsRequested > product.stock) {\r\n                    toast.error(`Out of Stock! Only ${product.stock} items available.`);\r\n                    return prev;\r\n                }\r\n\r\n                newCart[existingIndex].quantity = newQty;\r\n                newCart[existingIndex].total = newCart[existingIndex].quantity * newCart[existingIndex].price;\r\n                return newCart;\r\n            } else {\r\n                // Check Stock for new item\r\n                const itemsRequested = sellingUnit === 'box' ? (product.items_per_box || 1) : 1;\r\n                if (itemsRequested > product.stock) {\r\n                    toast.error(`Out of Stock! Only ${product.stock} items available.`);\r\n                    return prev;\r\n                }\r\n\r\n                return [...prev, {\r\n                    product,\r\n                    quantity: 1,\r\n                    price: parseFloat(price),\r\n                    selling_unit: sellingUnit,\r\n                    total: parseFloat(price)\r\n                }];\r\n            }\r\n        });\r\n\r\n        // Reset selection and focus back to search\r\n        setSelectedProduct(null);\r\n        if (searchInputRef.current) searchInputRef.current.focus();\r\n        toast.success(`Added ${product.name}`);\r\n    };\r\n\r\n    const updateCartItem = (index, field, value) => {\r\n        setCart(prev => {\r\n            const newCart = [...prev];\r\n            const item = newCart[index];\r\n\r\n            if (field === 'quantity') {\r\n                const qty = parseInt(value) || 0;\r\n\r\n                // Validate Stock\r\n                const actualQty = item.selling_unit === 'box'\r\n                    ? qty * (item.product.items_per_box || 1)\r\n                    : qty;\r\n\r\n                if (actualQty > item.product.stock) {\r\n                    toast.error(`Cannot add more than ${item.product.stock} items.`);\r\n                    // Don't update\r\n                    return prev;\r\n                }\r\n\r\n                item.quantity = qty;\r\n                item.total = qty * item.price;\r\n            } else if (field === 'price') {\r\n                const price = parseFloat(value) || 0;\r\n                item.price = price;\r\n                item.total = item.quantity * price;\r\n            } else if (field === 'selling_unit') {\r\n                const newUnit = value;\r\n                item.selling_unit = newUnit;\r\n\r\n                // Recalculate price based on new unit\r\n                if (newUnit === 'box') {\r\n                    item.price = parseFloat(item.product.price_per_box || (item.product.price * (item.product.items_per_box || 1)));\r\n                } else {\r\n                    item.price = parseFloat(item.product.price);\r\n                }\r\n                item.total = item.quantity * item.price;\r\n            }\r\n\r\n            return newCart;\r\n        });\r\n    };\r\n\r\n    const removeFromCart = (index) => {\r\n        setCart(prev => prev.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const calculateTotal = () => {\r\n        const subtotal = cart.reduce((sum, item) => sum + item.total, 0);\r\n        return subtotal - (parseFloat(globalDiscount) || 0);\r\n    };\r\n\r\n    // -- Checkout Logic --\r\n    const handleCheckout = async () => {\r\n        if (cart.length === 0) {\r\n            toast.error('Cart is empty');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n            if (!session) throw new Error('Not authenticated');\r\n\r\n            const totalAmount = calculateTotal();\r\n            const discount = parseFloat(globalDiscount) || 0;\r\n\r\n            // 1. Create Invoice\r\n            const { data: invoice, error: invoiceError } = await supabase\r\n                .from('invoices')\r\n                .insert([{\r\n                    customer_id: selectedCustomer?.id || null,\r\n                    total_amount: totalAmount,\r\n                    discount: discount,\r\n                    payment_method: paymentMethod,\r\n                    notes: notes,\r\n                    organization_id: session.user.id\r\n                }])\r\n                .select()\r\n                .single();\r\n\r\n            if (invoiceError) throw invoiceError;\r\n\r\n            // 2. Create Sales Records\r\n            const salesData = cart.map(item => ({\r\n                invoice_id: invoice.id,\r\n                product_id: item.product.id,\r\n                quantity: item.quantity,\r\n                price_at_sale: item.price,\r\n                sale_date: saleDate,\r\n                organization_id: session.user.id,\r\n                selling_unit: item.selling_unit,\r\n                items_per_box: item.product.items_per_box\r\n            }));\r\n\r\n            const { error: salesError } = await supabase.from('sales').insert(salesData);\r\n            if (salesError) throw salesError;\r\n\r\n            // 3. Update Stock\r\n            for (const item of cart) {\r\n                const actualQty = item.selling_unit === 'box'\r\n                    ? item.quantity * (item.product.items_per_box || 1)\r\n                    : item.quantity;\r\n\r\n                await supabase.rpc('decrease_stock', {\r\n                    p_id: item.product.id,\r\n                    q_sold: actualQty\r\n                });\r\n            }\r\n\r\n            // 4. Success\r\n            toast.success('Sale completed!');\r\n            setReceiptData({\r\n                invoice: { ...invoice },\r\n                items: cart.map(i => ({ ...i, products: i.product }))\r\n            });\r\n            setReceiptModalOpen(true);\r\n\r\n            // Reset\r\n            setCart([]);\r\n            setGlobalDiscount('0');\r\n            setNotes('');\r\n            setSelectedCustomer(null);\r\n            if (searchInputRef.current) searchInputRef.current.focus();\r\n\r\n        } catch (error) {\r\n            console.error('Checkout error:', error);\r\n            toast.error(error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleUnit = (index) => {\r\n        if (index < 0 || index >= cart.length) return;\r\n        const item = cart[index];\r\n        const newUnit = item.selling_unit === 'box' ? 'item' : 'box';\r\n        updateCartItem(index, 'selling_unit', newUnit);\r\n    };\r\n\r\n    const handleInputKeyDown = (e, index) => {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            // On Enter, move focus back to search to add next item\r\n            searchInputRef.current?.focus();\r\n        }\r\n    };\r\n\r\n    // -- Keyboard Shortcuts --\r\n    useKeyboardShortcuts({\r\n        'F2': () => searchInputRef.current?.focus(),\r\n        'F3': () => customerInputRef.current?.focus(),\r\n        'F4': () => handleCheckout(), // Pay / Checkout\r\n        'F8': () => toggleUnit(cart.length - 1), // Toggle Unit of last item\r\n        'F9': () => discountInputRef.current?.focus(),\r\n        'Escape': () => {\r\n            setSelectedProduct(null);\r\n            if (document.activeElement === searchInputRef.current) {\r\n                searchInputRef.current.blur();\r\n            } else {\r\n                searchInputRef.current?.focus();\r\n            }\r\n        },\r\n        'Shift+?': () => setHelpOpen(true)\r\n    });\r\n\r\n    // -- Table Config --\r\n    const columns = useMemo(() => [\r\n        {\r\n            header: 'Product',\r\n            accessorKey: 'product.name',\r\n            cell: info => (\r\n                <Box>\r\n                    <Typography variant=\"body2\" fontWeight=\"bold\">{info.getValue()}</Typography>\r\n                    <Typography variant=\"caption\" color=\"text.secondary\">\r\n                        Stock: {info.row.original.product.stock} | Exp: {info.row.original.product.expiry_date || 'N/A'}\r\n                    </Typography>\r\n                </Box>\r\n            )\r\n        },\r\n        {\r\n            header: 'Stock',\r\n            accessorKey: 'product.stock',\r\n            cell: info => (\r\n                <Typography variant=\"body2\" color={info.getValue() < 10 ? 'error' : 'text.primary'}>\r\n                    {info.getValue()}\r\n                </Typography>\r\n            )\r\n        },\r\n        {\r\n            header: 'Unit',\r\n            accessorKey: 'selling_unit',\r\n            cell: info => (\r\n                <Chip\r\n                    label={info.getValue().toUpperCase()}\r\n                    size=\"small\"\r\n                    color={info.getValue() === 'box' ? 'secondary' : 'default'}\r\n                    variant=\"outlined\"\r\n                    onClick={() => {\r\n                        const currentUnit = info.getValue();\r\n                        const newUnit = currentUnit === 'box' ? 'item' : 'box';\r\n                        updateCartItem(info.row.index, 'selling_unit', newUnit);\r\n                    }}\r\n                    sx={{ cursor: 'pointer', minWidth: 60 }}\r\n                />\r\n            )\r\n        },\r\n        {\r\n            header: 'Price',\r\n            accessorKey: 'price',\r\n            cell: info => (\r\n                <TextField\r\n                    type=\"number\"\r\n                    variant=\"standard\"\r\n                    size=\"small\"\r\n                    value={info.getValue()}\r\n                    onChange={e => updateCartItem(info.row.index, 'price', e.target.value)}\r\n                    onKeyDown={(e) => handleInputKeyDown(e, info.row.index)}\r\n                    InputProps={{ disableUnderline: true }}\r\n                    sx={{ width: 80 }}\r\n                />\r\n            )\r\n        },\r\n        {\r\n            header: 'Qty',\r\n            accessorKey: 'quantity',\r\n            cell: info => (\r\n                <TextField\r\n                    type=\"number\"\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    autoFocus={info.row.index === cart.length - 1} // Auto-focus new rows\r\n                    value={info.getValue()}\r\n                    onChange={e => updateCartItem(info.row.index, 'quantity', e.target.value)}\r\n                    onKeyDown={(e) => handleInputKeyDown(e, info.row.index)}\r\n                    sx={{ width: 80 }}\r\n                    inputProps={{ min: 1 }}\r\n                />\r\n            )\r\n        },\r\n        {\r\n            header: 'Total',\r\n            accessorKey: 'total',\r\n            cell: info => (\r\n                <Typography fontWeight=\"bold\">\r\n                    {formatCurrency(info.getValue(), settings.currency_symbol)}\r\n                </Typography>\r\n            )\r\n        },\r\n        {\r\n            id: 'actions',\r\n            cell: info => (\r\n                <IconButton color=\"error\" size=\"small\" onClick={() => removeFromCart(info.row.index)}>\r\n                    <Delete fontSize=\"small\" />\r\n                </IconButton>\r\n            )\r\n        }\r\n    ], [cart, settings.currency_symbol]);\r\n\r\n    const table = useReactTable({\r\n        data: cart,\r\n        columns,\r\n        getCoreRowModel: getCoreRowModel(),\r\n    });\r\n\r\n    return (\r\n        <Container maxWidth=\"xl\" sx={{ pb: 4 }}>\r\n            {/* Header & Search */}\r\n            <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\r\n                <Typography variant=\"h5\" fontWeight={700} color=\"primary\">\r\n                    Sales Terminal\r\n                </Typography>\r\n                <Button startIcon={<Keyboard />} onClick={() => setHelpOpen(true)} size=\"small\">\r\n                    Shortcuts\r\n                </Button>\r\n            </Box>\r\n\r\n            <Grid container spacing={2}>\r\n                {/* Left: Sales Table & Search */}\r\n                <Grid item xs={12} lg={8} order={{ xs: 2, lg: 1 }}> {/* On mobile, show summary/actions FIRST, then table */}\r\n                    <Paper sx={{ p: 2, mb: 2 }}>\r\n                        <Grid container spacing={2} alignItems=\"center\">\r\n                            <Grid item xs={12} md={8}>\r\n                                <Autocomplete\r\n                                    id=\"product-search\"\r\n                                    options={products}\r\n                                    getOptionLabel={(option) => option.name}\r\n                                    filterOptions={(x) => x}\r\n                                    value={selectedProduct}\r\n                                    onChange={(e, val) => {\r\n                                        if (val) addToCart(val);\r\n                                    }}\r\n                                    onInputChange={(e, val) => {\r\n                                        if (e?.type === 'change') searchProducts(val);\r\n                                    }}\r\n                                    renderInput={(params) => (\r\n                                        <TextField\r\n                                            {...params}\r\n                                            inputRef={searchInputRef}\r\n                                            label=\"Scan Barcode or Search Product (F2)\"\r\n                                            placeholder=\"Type product name...\"\r\n                                            fullWidth\r\n                                            size=\"small\" // detailedness\r\n                                            InputProps={{\r\n                                                ...params.InputProps,\r\n                                                startAdornment: (\r\n                                                    <InputAdornment position=\"start\">\r\n                                                        <Search color=\"action\" />\r\n                                                    </InputAdornment>\r\n                                                ),\r\n                                                endAdornment: (\r\n                                                    <>\r\n                                                        {loading ? <CircularProgress size={20} /> : null}\r\n                                                        {params.InputProps.endAdornment}\r\n                                                    </>\r\n                                                )\r\n                                            }}\r\n                                        />\r\n                                    )}\r\n                                    renderOption={(props, option) => (\r\n                                        <li {...props}>\r\n                                            <Box display=\"flex\" justifyContent=\"space-between\" width=\"100%\">\r\n                                                <Box>\r\n                                                    <Typography variant=\"body1\">{option.name}</Typography>\r\n                                                    <Typography variant=\"caption\" color=\"text.secondary\">\r\n                                                        {option.category}\r\n                                                    </Typography>\r\n                                                </Box>\r\n                                                <Box textAlign=\"right\">\r\n                                                    <Typography variant=\"body2\" color={option.stock < 10 ? 'error.main' : 'success.main'}>\r\n                                                        {option.stock} in stock\r\n                                                    </Typography>\r\n                                                    <Typography variant=\"body2\" fontWeight=\"bold\">\r\n                                                        {formatCurrency(option.price, settings.currency_symbol)}\r\n                                                    </Typography>\r\n                                                </Box>\r\n                                            </Box>\r\n                                        </li>\r\n                                    )}\r\n                                />\r\n                            </Grid>\r\n                            <Grid item xs={12} md={4}>\r\n                                <Autocomplete\r\n                                    options={customers}\r\n                                    getOptionLabel={(option) => option.name}\r\n                                    value={selectedCustomer}\r\n                                    onChange={(e, val) => setSelectedCustomer(val)}\r\n                                    renderInput={(params) => <TextField {...params} inputRef={customerInputRef} label=\"Customer (Optional) (F3)\" fullWidth size=\"small\" />}\r\n                                />\r\n                            </Grid>\r\n                        </Grid>\r\n                    </Paper>\r\n\r\n                    {/* Table Container Wrapper for Horizontal Scroll */}\r\n                    <Paper sx={{ width: '100%', overflow: 'hidden' }}>\r\n                        <Box sx={{ overflowX: 'auto', width: '100%' }}>\r\n                            <TableContainer sx={{ maxHeight: '60vh', minWidth: 650 }}> {/* Ensure minWidth to force scroll on small screens */}\r\n                                <Table stickyHeader size=\"small\">\r\n                                    <TableHead>\r\n                                        {table.getHeaderGroups().map(headerGroup => (\r\n                                            <TableRow key={headerGroup.id}>\r\n                                                {headerGroup.headers.map(header => (\r\n                                                    <TableCell key={header.id} sx={{ fontWeight: 'bold', bgcolor: 'background.default', whiteSpace: 'nowrap' }}>\r\n                                                        {flexRender(header.column.columnDef.header, header.getContext())}\r\n                                                    </TableCell>\r\n                                                ))}\r\n                                            </TableRow>\r\n                                        ))}\r\n                                    </TableHead>\r\n                                    <TableBody>\r\n                                        {table.getRowModel().rows.length === 0 ? (\r\n                                            <TableRow>\r\n                                                <TableCell colSpan={7} align=\"center\" sx={{ py: 8 }}>\r\n                                                    <Typography color=\"text.secondary\">\r\n                                                        No items in cart. Search to add products.\r\n                                                    </Typography>\r\n                                                </TableCell>\r\n                                            </TableRow>\r\n                                        ) : (\r\n                                            table.getRowModel().rows.map(row => (\r\n                                                <TableRow key={row.id} hover>\r\n                                                    {row.getVisibleCells().map(cell => (\r\n                                                        <TableCell key={cell.id}>\r\n                                                            {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                                                        </TableCell>\r\n                                                    ))}\r\n                                                </TableRow>\r\n                                            ))\r\n                                        )}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </TableContainer>\r\n                        </Box>\r\n                    </Paper>\r\n                </Grid>\r\n\r\n                {/* Right: Totals & Actions */}\r\n                <Grid item xs={12} lg={4} order={{ xs: 1, lg: 2 }}>\r\n                    <Box sx={{ display: 'flex', flexDirection: 'column', height: '100%', gap: 2 }}>\r\n                        {/* Summary Card */}\r\n                        <Card elevation={3} sx={{ display: 'flex', flexDirection: 'column', borderRadius: 2 }}>\r\n                            <CardContent sx={{ p: 3 }}>\r\n                                <Typography variant=\"h6\" fontWeight={600} gutterBottom color=\"primary.main\">\r\n                                    Sale Summary\r\n                                </Typography>\r\n                                <Box my={3}>\r\n                                    <Grid container spacing={2}>\r\n                                        <Grid item xs={6}>\r\n                                            <Typography variant=\"body1\" color=\"text.secondary\">Subtotal</Typography>\r\n                                        </Grid>\r\n                                        <Grid item xs={6} textAlign=\"right\">\r\n                                            <Typography variant=\"h6\" fontWeight={500}>\r\n                                                {formatCurrency(cart.reduce((s, i) => s + i.total, 0), settings.currency_symbol)}\r\n                                            </Typography>\r\n                                        </Grid>\r\n                                        <Grid item xs={12}>\r\n                                            <TextField\r\n                                                label=\"Discount (F9)\"\r\n                                                fullWidth\r\n                                                size=\"small\"\r\n                                                type=\"number\"\r\n                                                value={globalDiscount}\r\n                                                onChange={e => setGlobalDiscount(e.target.value)}\r\n                                                inputRef={discountInputRef}\r\n                                                InputLabelProps={{ shrink: true }}\r\n                                                sx={{ mt: 1 }}\r\n                                            />\r\n                                        </Grid>\r\n                                        <Grid item xs={12}>\r\n                                            <TextField\r\n                                                select\r\n                                                label=\"Payment Method\"\r\n                                                fullWidth\r\n                                                size=\"small\"\r\n                                                SelectProps={{ native: true }}\r\n                                                value={paymentMethod}\r\n                                                onChange={e => setPaymentMethod(e.target.value)}\r\n                                                sx={{ mt: 1 }}\r\n                                            >\r\n                                                <option value=\"cash\">Cash</option>\r\n                                                <option value=\"card\">Card</option>\r\n                                                <option value=\"online\">Online</option>\r\n                                            </TextField>\r\n                                        </Grid>\r\n                                        <Grid item xs={12}>\r\n                                            <Divider sx={{ my: 2 }} />\r\n                                            <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                                                <Typography variant=\"h5\" fontWeight={700} color=\"text.primary\">Total</Typography>\r\n                                                <Typography variant=\"h4\" fontWeight={800} color=\"primary.main\">\r\n                                                    {formatCurrency(calculateTotal(), settings.currency_symbol)}\r\n                                                </Typography>\r\n                                            </Box>\r\n                                        </Grid>\r\n                                    </Grid>\r\n                                </Box>\r\n\r\n                                <Button\r\n                                    variant=\"contained\"\r\n                                    color=\"primary\"\r\n                                    fullWidth\r\n                                    size=\"large\"\r\n                                    startIcon={<ShoppingCart />}\r\n                                    onClick={handleCheckout}\r\n                                    disabled={cart.length === 0 || loading}\r\n                                    ref={payButtonRef}\r\n                                    sx={{\r\n                                        py: 2,\r\n                                        fontSize: '1.2rem',\r\n                                        fontWeight: 'bold',\r\n                                        borderRadius: 2,\r\n                                        boxShadow: 4,\r\n                                        textTransform: 'none'\r\n                                    }}\r\n                                >\r\n                                    {loading ? 'Processing...' : 'Complete Sale (F4)'}\r\n                                </Button>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Daily Sales Widget */}\r\n                        <Box sx={{ flexGrow: 1, display: { xs: 'none', md: 'block' } }}> {/* Hide Daily Sales on Mobile to save space? Or maybe keep it but below. Let's hide it for now on xs if it's too long, or keep it. User said \"Sales page... make it user friendly\". Stacking order change helps. */}\r\n                            <DailySales />\r\n                        </Box>\r\n                        {/* Show Daily Sales on mobile but maybe collapsed or after table? Actually user might want to see history. I will leave it visible but it will be at bottom due to Grid order if I don't change it. Wait, I set order 1 for right col on mobile. So it will be at TOP.\r\n                         Let's refining:\r\n                         Mobile: Summary -> Search/Table -> DailySales?\r\n                         Currently:\r\n                         Grid container\r\n                           - Left (Table) order 2\r\n                           - Right (Summary) order 1\r\n                         So Summary comes first.\r\n                         Inside Right Grid: Summary Card -> Daily Sales.\r\n                         So on Mobile: Summary Card -> Daily Sales -> Search/Table.\r\n                         This might be too much scrolling to get to the table.\r\n                         Better Mobile Order: Summary Card -> Search/Table -> Daily Sales.\r\n                         To achieve this, I need to split the Right Grid or duplicate/hide components.\r\n                         For now, let's keep the user request \"make it user friendly\" in mind. The most important thing is SCROLLING table. I've handled that.\r\n                         I'll stick to the standard logic: Summary visible is good. But let's hide Daily Sales on extra small screens to avoid clutter at the top, or move it to bottom if possible.\r\n                         Actually, standard POS usually has the \"Cart\" (Table) on the left and \"Summary\" on the right.\r\n                         On Mobile, you usually want to see the \"Cart\" and add items, then scroll down to pay.\r\n                         So maybe my re-ordering was wrong for a POS?\r\n                         If I put Summary first, I can't see what I'm typing.\r\n                         Reverting order slightly:\r\n                         Mobile: Search/Table (Order 1) -> Summary (Order 2).\r\n                         Let's check the request: \"only table is scrolable to left and right not the entire page\".\r\n                         OK, I will use `minWidth` on TableContainer and `overflowX: auto` on the wrapper box.\r\n                         I'll revert the order change to keep it standard (Left then Right) because searching/adding items is the primary action.\r\n                         */}\r\n                    </Box>\r\n                </Grid>\r\n                {/* Re-evaluating text above. I will keep Standard Order (Product Search First). */}\r\n            </Grid>\r\n\r\n            {/* Mobile Daily Sales (if needed elsewhere or kept in flow) */}\r\n            <Box mt={2} display={{ xs: 'block', md: 'none' }}>\r\n                <DailySales />\r\n            </Box>\r\n\r\n            {/* Help Dialog */}\r\n            <Dialog open={helpOpen} onClose={() => setHelpOpen(false)}>\r\n                <DialogTitle>Keyboard Shortcuts</DialogTitle>\r\n                <DialogContent>\r\n                    <Grid container spacing={2}>\r\n                        <Grid item xs={6}><Chip label=\"F2\" size=\"small\" /></Grid>\r\n                        <Grid item xs={6}><Typography>Focus Search Bar</Typography></Grid>\r\n\r\n                        <Grid item xs={6}><Chip label=\"F3\" size=\"small\" /></Grid>\r\n                        <Grid item xs={6}><Typography>Select Customer</Typography></Grid>\r\n\r\n                        <Grid item xs={6}><Chip label=\"F4\" size=\"small\" /></Grid>\r\n                        <Grid item xs={6}><Typography>Complete Sale / Pay</Typography></Grid>\r\n\r\n                        <Grid item xs={6}><Chip label=\"F9\" size=\"small\" /></Grid>\r\n                        <Grid item xs={6}><Typography>Focus Discount Field</Typography></Grid>\r\n\r\n                        <Grid item xs={6}><Chip label=\"F8\" size=\"small\" /></Grid>\r\n                        <Grid item xs={6}><Typography>Toggle Unit (Item/Box)</Typography></Grid>\r\n\r\n                        <Grid item xs={6}><Chip label=\"Esc\" size=\"small\" /></Grid>\r\n                        <Grid item xs={6}><Typography>Clear Selection / Blur</Typography></Grid>\r\n                    </Grid>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => setHelpOpen(false)}>Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <ReceiptModal\r\n                open={receiptModalOpen}\r\n                onClose={() => setReceiptModalOpen(false)}\r\n                invoice={receiptData.invoice}\r\n                items={receiptData.items}\r\n                settings={settings}\r\n            />\r\n        </Container>\r\n    );\r\n}\r\n"],"names":["DailySales","settings","useSettings","todaySales","setTodaySales","useState","totalAmount","setTotalAmount","loading","setLoading","downloading","setDownloading","async","fetchTodaySales","data","session","supabase","auth","getSession","orgId","user","id","now","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","today","concat","error","from","select","eq","is","console","total","reduce","sum","sale","quantity","price_at_sale","useEffect","subscription","authSubscription","onAuthStateChange","event","channel","on","schema","table","subscribe","unsubscribe","_jsx","Card","sx","height","background","color","children","_jsxs","CardContent","Box","display","alignItems","gap","mb","ReceiptLong","Typography","variant","fontWeight","formatCurrency","currency_symbol","opacity","length","Divider","borderColor","Button","fullWidth","size","minHeight","startIcon","CircularProgress","Download","onClick","doc","jsPDF","toLocaleDateString","storeName","store_name","currency","setFontSize","text","align","tableColumn","tableRows","map","_sale$products","created_at","toLocaleTimeString","products","name","selling_unit","autoTable","head","body","startY","styles","fontSize","headStyles","fillColor","finalY","lastAutoTable","save","replace","toast","success","message","info","disabled","backgroundColor","TableChart","handleDownloadCSV","csvContent","forEach","_sale$products2","_sale$customers","time","product","qty","unit","price","payment","payment_method","customer","customers","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","appendChild","click","removeChild","SalesPage","searchParams","useSearchParams","setProducts","setCustomers","receiptModalOpen","setReceiptModalOpen","receiptData","setReceiptData","invoice","items","helpOpen","setHelpOpen","cart","setCart","selectedCustomer","setSelectedCustomer","selectedProduct","setSelectedProduct","globalDiscount","setGlobalDiscount","paymentMethod","setPaymentMethod","saleDate","setSaleDate","get","toISOString","split","notes","setNotes","searchInputRef","useRef","discountInputRef","payButtonRef","customerInputRef","order","fetchCustomers","current","focus","updateCartItem","index","field","value","prev","newCart","item","parseInt","items_per_box","stock","parseFloat","newUnit","price_per_box","calculateTotal","handleCheckout","Error","discount","invoiceError","insert","customer_id","total_amount","organization_id","single","salesData","invoice_id","product_id","sale_date","salesError","actualQty","rpc","p_id","q_sold","_objectSpread","i","handleInputKeyDown","e","_searchInputRef$curre","key","preventDefault","useKeyboardShortcuts","F2","_searchInputRef$curre2","F3","_customerInputRef$cur","F4","F8","toggleUnit","F9","_discountInputRef$cur","Escape","_searchInputRef$curre3","activeElement","blur","Shift+?","columns","useMemo","header","accessorKey","cell","getValue","row","original","expiry_date","Chip","label","toUpperCase","cursor","minWidth","TextField","onChange","target","onKeyDown","InputProps","disableUnderline","width","autoFocus","inputProps","min","IconButton","removeFromCart","filter","_","Delete","useReactTable","getCoreRowModel","Container","maxWidth","pb","justifyContent","Keyboard","Grid","container","spacing","xs","lg","Paper","p","md","Autocomplete","options","getOptionLabel","option","filterOptions","x","val","sellingUnit","existingIndex","findIndex","newQty","addToCart","onInputChange","query","search_term","p_limit","searchProducts","renderInput","params","inputRef","placeholder","startAdornment","InputAdornment","position","Search","endAdornment","_Fragment","renderOption","props","category","textAlign","overflow","overflowX","TableContainer","maxHeight","Table","stickyHeader","TableHead","getHeaderGroups","headerGroup","TableRow","headers","TableCell","bgcolor","whiteSpace","flexRender","column","columnDef","getContext","TableBody","getRowModel","rows","colSpan","py","hover","getVisibleCells","flexDirection","elevation","borderRadius","gutterBottom","my","s","InputLabelProps","shrink","mt","SelectProps","native","ShoppingCart","ref","boxShadow","textTransform","flexGrow","Dialog","open","onClose","DialogTitle","DialogContent","DialogActions","ReceiptModal"],"sourceRoot":""}