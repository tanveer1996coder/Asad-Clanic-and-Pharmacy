"use strict";(self.webpackChunksupabase_sales_app=self.webpackChunksupabase_sales_app||[]).push([[678],{83678:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var s=n(89379),r=n(65043),o=n(35475),i=n(73216),a=n(96446),l=n(85865),c=n(43845),d=n(5146),u=n(17392),h=n(19252),x=n(11906),m=n(68903),p=n(63336),y=n(27108),g=n(51787),A=n(81637),f=n(79650),j=n(71806),v=n(84882),b=n(28076),_=n(10039),w=n(73460),S=n(12110),C=n(26494),k=n(39336),F=n(90035),R=n(26600),z=n(35316),N=n(29347),I=n(51387),D=n(17673),W=n(79484),q=n(99010),P=n(58931),T=n(47111),E=n(47503),V=n(27001),O=n(12807),L=n(11737),K=n(90990),U=n(44676),B=n(47968),M=n(31308),H=n(37762),Q=n(64857),Y=n(70579);function G(){const{settings:e}=(0,L.A)(),[t,n]=(0,r.useState)([]),[s,o]=(0,r.useState)(0),[i,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1);async function h(){const{data:{session:e}}=await V.N.auth.getSession();if(!e)return;const t=e.user.id,s=new Date,r=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0"),l="".concat(r,"-").concat(i,"-").concat(a),{data:d,error:u}=await V.N.from("sales").select("*, products(name)").eq("organization_id",t).eq("sale_date",l).is("deleted_at",null);if(u)return void console.error("Error fetching today sales:",u);n(d||[]);const h=(d||[]).reduce((e,t)=>e+t.quantity*t.price_at_sale,0);o(h),c(!1)}(0,r.useEffect)(()=>{h();const{data:{subscription:e}}=V.N.auth.onAuthStateChange((e,t)=>{("SIGNED_IN"===e||t)&&h()}),t=V.N.channel("public:sales").on("postgres_changes",{event:"INSERT",schema:"public",table:"sales"},()=>{h()}).subscribe();return()=>{t.unsubscribe(),e.unsubscribe()}},[]);return(0,Y.jsx)(S.A,{sx:{height:"100%",background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white"},children:(0,Y.jsxs)(C.A,{children:[(0,Y.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,mb:2,children:[(0,Y.jsx)(U.A,{}),(0,Y.jsx)(l.A,{variant:"h6",fontWeight:600,children:"Today's Sales"})]}),(0,Y.jsx)(l.A,{variant:"h3",fontWeight:700,mb:1,children:(0,O.vv)(s,e.currency_symbol)}),(0,Y.jsxs)(l.A,{variant:"body2",sx:{opacity:.8,mb:3},children:[t.length," transactions today"]}),(0,Y.jsx)(k.A,{sx:{borderColor:"rgba(255,255,255,0.2)",mb:2}}),(0,Y.jsxs)(a.A,{display:"flex",gap:1,children:[(0,Y.jsx)(x.A,{variant:"contained",color:"secondary",fullWidth:!0,size:"large",sx:{minHeight:48},startIcon:d?(0,Y.jsx)(A.A,{size:20,color:"inherit"}):(0,Y.jsx)(B.A,{}),onClick:async()=>{if(0!==t.length){u(!0);try{const n=new H.Ay,r=(new Date).toLocaleDateString(),o=(null===e||void 0===e?void 0:e.store_name)||"Medical Store",i=(null===e||void 0===e?void 0:e.currency_symbol)||"$";n.setFontSize(20),n.text(o,105,15,{align:"center"}),n.setFontSize(14),n.text("Daily Sales Report - ".concat(r),105,25,{align:"center"}),n.setFontSize(12),n.text("Total Sales Count: ".concat(t.length),14,35),n.text("Total Revenue: ".concat((0,O.vv)(s,i)),14,42);const a=["Time","Product","Qty","Unit","Price","Total"],l=t.map(e=>{var t;return[new Date(e.created_at).toLocaleTimeString(),(null===(t=e.products)||void 0===t?void 0:t.name)||"Unknown Product",e.quantity,"box"===e.selling_unit?"Box":"Item",(0,O.vv)(e.price_at_sale,i),(0,O.vv)(e.quantity*e.price_at_sale,i)]});(0,Q.Ay)(n,{head:[a],body:l,startY:50,styles:{fontSize:10},headStyles:{fillColor:[99,102,241]}});const c=n.lastAutoTable&&n.lastAutoTable.finalY||50;n.setFontSize(10),n.text("_______________________",150,c+30),n.text("Authorized Signature",150,c+40),n.save("daily_sales_".concat(r.replace(/\//g,"-"),".pdf")),E.oR.success("PDF downloaded successfully!")}catch(n){console.error("Error generating PDF:",n),E.oR.error("Failed to generate PDF: ".concat(n.message))}finally{u(!1)}}else E.oR.info("No sales to report for today.")},disabled:i||0===t.length||d,children:"PDF"}),(0,Y.jsx)(x.A,{variant:"outlined",fullWidth:!0,size:"large",sx:{minHeight:48,borderColor:"white",color:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255,255,255,0.1)"}},startIcon:d?(0,Y.jsx)(A.A,{size:20,color:"inherit"}):(0,Y.jsx)(M.A,{}),onClick:()=>{if(0!==t.length){u(!0);try{const n=(new Date).toLocaleDateString();null===e||void 0===e||e.currency_symbol;let r="Time,Product,Quantity,Unit,Price,Total,Payment Method,Customer\n";t.forEach(e=>{var t,n;const s=new Date(e.created_at).toLocaleTimeString(),o=((null===(t=e.products)||void 0===t?void 0:t.name)||"Unknown Product").replace(/"/g,'""'),i=e.quantity,a="box"===e.selling_unit?"Box":"Item",l=e.price_at_sale,c=i*l,d=e.payment_method||"N/A",u=(null===(n=e.customers)||void 0===n?void 0:n.name)||"Walk-in";r+='"'.concat(s,'","').concat(o,'",').concat(i,',"').concat(a,'",').concat(l,",").concat(c,',"').concat(d,'","').concat(u,'"\n')}),r+='\n"Summary",,,,,,\n',r+='"Total Transactions",'.concat(t.length,",,,,,\n"),r+='"Total Revenue",'.concat(s,",,,,,\n");const o=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),a=URL.createObjectURL(o);i.setAttribute("href",a),i.setAttribute("download","daily_sales_".concat(n.replace(/\//g,"-"),".csv")),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),E.oR.success("CSV downloaded successfully!")}catch(n){console.error("Error generating CSV:",n),E.oR.error("Failed to generate CSV: ".concat(n.message))}finally{u(!1)}}else E.oR.info("No sales to export for today.")},disabled:i||0===t.length||d,children:"CSV"})]})]})})}var X=n(88249),$=n(15626);function J(e){let{open:t,onClose:n,onCustomerAdded:o,initialName:i=""}=e;const[c,u]=(0,r.useState)({name:i,phone:"",address:""}),[h,p]=(0,r.useState)(!1),y=e=>{u((0,s.A)((0,s.A)({},c),{},{[e.target.name]:e.target.value}))},g=async e=>{if(e.preventDefault(),c.name.trim()){p(!0);try{const{data:{session:e}}=await V.N.auth.getSession();if(!e)throw new Error("Not authenticated");const{data:t,error:s}=await V.N.from("customers").insert([{name:c.name.trim(),phone:c.phone.trim()||null,address:c.address.trim()||null,organization_id:e.user.id}]).select().single();if(s)throw s;E.oR.success("Customer added successfully!"),o(t),n()}catch(t){console.error("Error adding customer:",t),E.oR.error("Failed to add customer: "+t.message)}finally{p(!1)}}else E.oR.error("Customer name is required")},A=e=>{if("Enter"===e.key&&!e.shiftKey){e.preventDefault();const t=e.target.form,n=Array.prototype.indexOf.call(t,e.target),s=t.elements[n+1];s&&"submit"!==s.type?s.focus():g(e)}};return(0,Y.jsx)(F.A,{open:t,onClose:n,maxWidth:"sm",fullWidth:!0,children:(0,Y.jsxs)("form",{onSubmit:g,children:[(0,Y.jsx)(R.A,{children:(0,Y.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,children:[(0,Y.jsx)($.A,{color:"primary"}),"Add New Customer"]})}),(0,Y.jsxs)(z.A,{children:[(0,Y.jsx)(l.A,{variant:"body2",color:"text.secondary",mb:2,children:"Quickly add a new customer to complete your sale."}),(0,Y.jsxs)(m.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,Y.jsx)(m.Ay,{item:!0,xs:12,children:(0,Y.jsx)(d.A,{fullWidth:!0,required:!0,autoFocus:!0,label:"Customer Name",name:"name",value:c.name,onChange:y,onKeyDown:A,placeholder:"Enter customer name"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:12,children:(0,Y.jsx)(d.A,{fullWidth:!0,label:"Phone Number",name:"phone",value:c.phone,onChange:y,onKeyDown:A,placeholder:"Optional"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:12,children:(0,Y.jsx)(d.A,{fullWidth:!0,label:"Address",name:"address",value:c.address,onChange:y,onKeyDown:A,placeholder:"Optional",multiline:!0,rows:2})})]})]}),(0,Y.jsxs)(N.A,{children:[(0,Y.jsx)(x.A,{onClick:n,disabled:h,children:"Cancel"}),(0,Y.jsx)(x.A,{type:"submit",variant:"contained",disabled:h,children:h?"Saving...":"Add Customer"})]})]})})}function Z(){var e;const{settings:t}=(0,L.A)(),[n]=(0,o.ok)(),U=(0,i.zy)(),[B,M]=(0,r.useState)([]),[H,Q]=(0,r.useState)([]),[$,Z]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(!1),[ne,se]=(0,r.useState)({invoice:null,items:[]}),[re,oe]=(0,r.useState)(!1),[ie,ae]=(0,r.useState)(!1),[le,ce]=(0,r.useState)(""),[de,ue]=(0,r.useState)([]),[he,xe]=(0,r.useState)(null),[me,pe]=(0,r.useState)(null),[ye,ge]=(0,r.useState)("0"),[Ae,fe]=(0,r.useState)("cash"),[je,ve]=(0,r.useState)(n.get("date")||(new Date).toISOString().split("T")[0]),[be,_e]=(0,r.useState)(""),we=(0,r.useRef)(null),Se=(0,r.useRef)(null),Ce=(0,r.useRef)(null),ke=(0,r.useRef)(null);(0,r.useEffect)(()=>{!async function(){const{data:{session:e}}=await V.N.auth.getSession();if(!e)return;const t=e.user.id,{data:n}=await V.N.from("customers").select("*").eq("organization_id",t).is("deleted_at",null).order("name");Q(n||[])}(),we.current&&we.current.focus()},[]),(0,r.useEffect)(()=>{var e;const t=null===(e=U.state)||void 0===e?void 0:e.reorderInvoiceId;t&&0===de.length&&Fe(t)},[null===(e=U.state)||void 0===e?void 0:e.reorderInvoiceId]);const Fe=async e=>{try{const{data:{session:t}}=await V.N.auth.getSession();if(!t)return;const{data:n,error:s}=await V.N.from("sales").select("*, products(*)").eq("invoice_id",e).is("deleted_at",null);if(s)throw s;if(n&&n.length>0){const e=n.map(e=>{const t=e.products;return t?{product:t,quantity:e.quantity,price:parseFloat(e.price_at_sale),selling_unit:e.selling_unit||"item",total:e.quantity*parseFloat(e.price_at_sale)}:null}).filter(e=>null!==e);ue(e),E.oR.success("Loaded ".concat(e.length," items from previous invoice. You can now edit and complete the sale."))}else E.oR.warning("No items found for this invoice.")}catch(t){console.error("Error loading invoice items:",t),E.oR.error("Failed to load invoice items")}},Re=(e,t,n)=>{ue(s=>{const r=[...s],o=r[e];if("quantity"===t){const e=parseInt(n)||0;if(("box"===o.selling_unit?e*(o.product.items_per_box||1):e)>o.product.stock)return E.oR.error("Cannot add more than ".concat(o.product.stock," items.")),s;o.quantity=e,o.total=e*o.price}else if("price"===t){const e=parseFloat(n)||0;o.price=e,o.total=o.quantity*e}else if("selling_unit"===t){const e=n;o.selling_unit=e,o.price="box"===e?parseFloat(o.product.price_per_box||o.product.price*(o.product.items_per_box||1)):parseFloat(o.product.price),o.total=o.quantity*o.price}return r})},ze=()=>de.reduce((e,t)=>e+t.total,0)-(parseFloat(ye)||0),Ne=async()=>{if(0!==de.length){Z(!0);try{const{data:{session:e}}=await V.N.auth.getSession();if(!e)throw new Error("Not authenticated");const t=ze(),n=parseFloat(ye)||0,{data:r,error:o}=await V.N.from("invoices").insert([{customer_id:(null===he||void 0===he?void 0:he.id)||null,total_amount:t,discount:n,payment_method:Ae,notes:be,organization_id:e.user.id}]).select().single();if(o)throw o;const i=de.map(t=>({invoice_id:r.id,product_id:t.product.id,quantity:t.quantity,price_at_sale:t.price,sale_date:je,organization_id:e.user.id,selling_unit:t.selling_unit,items_per_box:t.product.items_per_box})),{error:a}=await V.N.from("sales").insert(i);if(a)throw a;for(const s of de){const e="box"===s.selling_unit?s.quantity*(s.product.items_per_box||1):s.quantity;await V.N.rpc("decrease_stock",{p_id:s.product.id,q_sold:e})}E.oR.success("Sale completed!"),se({invoice:(0,s.A)({},r),items:de.map(e=>(0,s.A)((0,s.A)({},e),{},{products:e.product}))}),te(!0),ue([]),ge("0"),_e(""),xe(null),we.current&&we.current.focus()}catch(e){console.error("Checkout error:",e),E.oR.error(e.message)}finally{Z(!1)}}else E.oR.error("Cart is empty")},Ie=(e,t)=>{var n;"Enter"===e.key&&(e.preventDefault(),null===(n=we.current)||void 0===n||n.focus())};(0,K.A)({F2:()=>{var e;return null===(e=we.current)||void 0===e?void 0:e.focus()},F3:()=>{var e;return null===(e=ke.current)||void 0===e?void 0:e.focus()},F4:()=>Ne(),F8:()=>(e=>{if(e<0||e>=de.length)return;const t="box"===de[e].selling_unit?"item":"box";Re(e,"selling_unit",t)})(de.length-1),F9:()=>{var e;return null===(e=Se.current)||void 0===e?void 0:e.focus()},Escape:()=>{var e;(pe(null),document.activeElement===we.current)?we.current.blur():null===(e=we.current)||void 0===e||e.focus()},"Shift+?":()=>oe(!0)});const De=(0,r.useMemo)(()=>[{header:"Product",accessorKey:"product.name",cell:e=>(0,Y.jsxs)(a.A,{children:[(0,Y.jsx)(l.A,{variant:"body2",fontWeight:"bold",children:e.getValue()}),(0,Y.jsxs)(l.A,{variant:"caption",color:"text.secondary",children:["Stock: ",e.row.original.product.stock," | Exp: ",e.row.original.product.expiry_date||"N/A"]})]})},{header:"Stock",accessorKey:"product.stock",cell:e=>(0,Y.jsx)(l.A,{variant:"body2",color:e.getValue()<10?"error":"text.primary",children:e.getValue()})},{header:"Unit",accessorKey:"selling_unit",cell:e=>(0,Y.jsx)(c.A,{label:e.getValue().toUpperCase(),size:"small",color:"box"===e.getValue()?"secondary":"default",variant:"outlined",onClick:()=>{const t="box"===e.getValue()?"item":"box";Re(e.row.index,"selling_unit",t)},sx:{cursor:"pointer",minWidth:60}})},{header:"Price",accessorKey:"price",cell:e=>(0,Y.jsx)(d.A,{type:"number",variant:"standard",size:"small",value:e.getValue(),onChange:t=>Re(e.row.index,"price",t.target.value),onKeyDown:t=>Ie(t,e.row.index),InputProps:{disableUnderline:!0},sx:{width:80}})},{header:"Qty",accessorKey:"quantity",cell:e=>(0,Y.jsx)(d.A,{type:"number",variant:"outlined",size:"small",autoFocus:e.row.index===de.length-1,value:e.getValue(),onChange:t=>Re(e.row.index,"quantity",t.target.value),onKeyDown:t=>Ie(t,e.row.index),sx:{width:80},inputProps:{min:1}})},{header:"Total",accessorKey:"total",cell:e=>(0,Y.jsx)(l.A,{fontWeight:"bold",children:(0,O.vv)(e.getValue(),t.currency_symbol)})},{id:"actions",cell:e=>(0,Y.jsx)(u.A,{color:"error",size:"small",onClick:()=>{return t=e.row.index,void ue(e=>e.filter((e,n)=>n!==t));var t},children:(0,Y.jsx)(I.A,{fontSize:"small"})})}],[de,t.currency_symbol]),We=(0,P.N4)({data:de,columns:De,getCoreRowModel:(0,T.HT)()});return(0,Y.jsxs)(h.A,{maxWidth:"xl",sx:{pb:4},children:[(0,Y.jsxs)(a.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,Y.jsx)(l.A,{variant:"h5",fontWeight:700,color:"primary",children:"Sales Terminal"}),(0,Y.jsx)(x.A,{startIcon:(0,Y.jsx)(D.A,{}),onClick:()=>oe(!0),size:"small",children:"Shortcuts"})]}),(0,Y.jsxs)(m.Ay,{container:!0,spacing:2,children:[(0,Y.jsxs)(m.Ay,{item:!0,xs:12,lg:8,order:{xs:2,lg:1},children:[" ",(0,Y.jsx)(p.A,{sx:{p:2,mb:2},children:(0,Y.jsxs)(m.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,Y.jsx)(m.Ay,{item:!0,xs:12,md:8,children:(0,Y.jsx)(y.A,{id:"product-search",options:B,getOptionLabel:e=>e.name,filterOptions:e=>e,value:me,onChange:(e,t)=>{t&&(e=>{if(!e)return;const t="box"===e.selling_unit?"box":"item",n="box"===t?e.price_per_box||e.price*(e.items_per_box||1):e.price;ue(s=>{const r=s.findIndex(n=>n.product.id===e.id&&n.selling_unit===t);if(r>=0){const t=[...s],n=t[r].quantity+1;return("box"===t[r].selling_unit?n*(e.items_per_box||1):n)>e.stock?(E.oR.error("Out of Stock! Only ".concat(e.stock," items available.")),s):(t[r].quantity=n,t[r].total=t[r].quantity*t[r].price,t)}return("box"===t&&e.items_per_box||1)>e.stock?(E.oR.error("Out of Stock! Only ".concat(e.stock," items available.")),s):[...s,{product:e,quantity:1,price:parseFloat(n),selling_unit:t,total:parseFloat(n)}]}),pe(null),we.current&&we.current.focus(),E.oR.success("Added ".concat(e.name))})(t)},onInputChange:(e,t)=>{"change"===(null===e||void 0===e?void 0:e.type)&&(async e=>{if(!e||e.length<2)M([]);else{Z(!0);try{const{data:t,error:n}=await V.N.rpc("search_products",{search_term:e,p_limit:50});if(n)throw n;M(t||[])}catch(t){console.error("Error searching products:",t),M([])}finally{Z(!1)}}})(t)},renderInput:e=>(0,Y.jsx)(d.A,(0,s.A)((0,s.A)({},e),{},{inputRef:we,label:"Scan Barcode or Search Product (F2)",placeholder:"Type product name...",fullWidth:!0,size:"small",InputProps:(0,s.A)((0,s.A)({},e.InputProps),{},{startAdornment:(0,Y.jsx)(g.A,{position:"start",children:(0,Y.jsx)(W.A,{color:"action"})}),endAdornment:(0,Y.jsxs)(Y.Fragment,{children:[$?(0,Y.jsx)(A.A,{size:20}):null,e.InputProps.endAdornment]})})})),renderOption:(e,n)=>(0,Y.jsx)("li",(0,s.A)((0,s.A)({},e),{},{children:(0,Y.jsxs)(a.A,{display:"flex",justifyContent:"space-between",width:"100%",children:[(0,Y.jsxs)(a.A,{children:[(0,Y.jsx)(l.A,{variant:"body1",children:n.name}),(0,Y.jsx)(l.A,{variant:"caption",color:"text.secondary",children:n.category})]}),(0,Y.jsxs)(a.A,{textAlign:"right",children:[(0,Y.jsxs)(l.A,{variant:"body2",color:n.stock<10?"error.main":"success.main",children:[n.stock," in stock"]}),(0,Y.jsx)(l.A,{variant:"body2",fontWeight:"bold",children:(0,O.vv)(n.price,t.currency_symbol)})]})]})}))})}),(0,Y.jsx)(m.Ay,{item:!0,xs:12,md:4,children:(0,Y.jsx)(y.A,{freeSolo:!0,options:H,getOptionLabel:e=>"string"===typeof e?e:e.name,value:he,onChange:(e,t)=>{"string"===typeof t?(ce(t),ae(!0)):xe(t)},onInputChange:(e,t,n)=>{"input"===n&&t&&!H.some(e=>e.name.toLowerCase()===t.toLowerCase())&&ce(t)},filterOptions:(e,t)=>{const n=e.filter(e=>e.name.toLowerCase().includes(t.inputValue.toLowerCase()));return""===t.inputValue||e.some(e=>e.name.toLowerCase()===t.inputValue.toLowerCase())||n.push({name:'\u2795 Add "'.concat(t.inputValue,'"'),id:"__add_new__",isAddNew:!0,inputValue:t.inputValue}),n},renderOption:(e,t)=>t.isAddNew?(0,Y.jsx)("li",(0,s.A)((0,s.A)({},e),{},{onClick:()=>{ce(t.inputValue),ae(!0)},children:(0,Y.jsx)(a.A,{display:"flex",alignItems:"center",gap:1,width:"100%",children:(0,Y.jsx)(l.A,{variant:"body2",color:"primary",fontWeight:600,children:t.name})})})):(0,Y.jsx)("li",(0,s.A)((0,s.A)({},e),{},{children:t.name})),renderInput:e=>(0,Y.jsx)(d.A,(0,s.A)((0,s.A)({},e),{},{inputRef:ke,label:"Customer (Optional) (F3)",fullWidth:!0,size:"small",helperText:"Type new name to add customer"}))})})]})}),(0,Y.jsx)(p.A,{sx:{width:"100%",overflow:"hidden"},children:(0,Y.jsx)(a.A,{sx:{overflowX:"auto",width:"100%"},children:(0,Y.jsxs)(f.A,{sx:{maxHeight:"60vh",minWidth:650},children:[" ",(0,Y.jsxs)(j.A,{stickyHeader:!0,size:"small",children:[(0,Y.jsx)(v.A,{children:We.getHeaderGroups().map(e=>(0,Y.jsx)(b.A,{children:e.headers.map(e=>(0,Y.jsx)(_.A,{sx:{fontWeight:"bold",bgcolor:"background.default",whiteSpace:"nowrap"},children:(0,P.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,Y.jsx)(w.A,{children:0===We.getRowModel().rows.length?(0,Y.jsx)(b.A,{children:(0,Y.jsx)(_.A,{colSpan:7,align:"center",sx:{py:8},children:(0,Y.jsx)(l.A,{color:"text.secondary",children:"No items in cart. Search to add products."})})}):We.getRowModel().rows.map(e=>(0,Y.jsx)(b.A,{hover:!0,children:e.getVisibleCells().map(e=>(0,Y.jsx)(_.A,{children:(0,P.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})]})})})]}),(0,Y.jsx)(m.Ay,{item:!0,xs:12,lg:4,order:{xs:1,lg:2},children:(0,Y.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",height:"100%",gap:2},children:[(0,Y.jsx)(S.A,{elevation:3,sx:{display:"flex",flexDirection:"column",borderRadius:2},children:(0,Y.jsxs)(C.A,{sx:{p:3},children:[(0,Y.jsx)(l.A,{variant:"h6",fontWeight:600,gutterBottom:!0,color:"primary.main",children:"Sale Summary"}),(0,Y.jsx)(a.A,{my:3,children:(0,Y.jsxs)(m.Ay,{container:!0,spacing:2,children:[(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{variant:"body1",color:"text.secondary",children:"Subtotal"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,textAlign:"right",children:(0,Y.jsx)(l.A,{variant:"h6",fontWeight:500,children:(0,O.vv)(de.reduce((e,t)=>e+t.total,0),t.currency_symbol)})}),(0,Y.jsx)(m.Ay,{item:!0,xs:12,children:(0,Y.jsx)(d.A,{label:"Discount (F9)",fullWidth:!0,size:"small",type:"number",value:ye,onChange:e=>ge(e.target.value),inputRef:Se,InputLabelProps:{shrink:!0},sx:{mt:1}})}),(0,Y.jsx)(m.Ay,{item:!0,xs:12,children:(0,Y.jsxs)(d.A,{select:!0,label:"Payment Method",fullWidth:!0,size:"small",SelectProps:{native:!0},value:Ae,onChange:e=>fe(e.target.value),sx:{mt:1},children:[(0,Y.jsx)("option",{value:"cash",children:"Cash"}),(0,Y.jsx)("option",{value:"card",children:"Card"}),(0,Y.jsx)("option",{value:"online",children:"Online"})]})}),(0,Y.jsxs)(m.Ay,{item:!0,xs:12,children:[(0,Y.jsx)(k.A,{sx:{my:2}}),(0,Y.jsxs)(a.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,Y.jsx)(l.A,{variant:"h5",fontWeight:700,color:"text.primary",children:"Total"}),(0,Y.jsx)(l.A,{variant:"h4",fontWeight:800,color:"primary.main",children:(0,O.vv)(ze(),t.currency_symbol)})]})]})]})}),(0,Y.jsx)(x.A,{variant:"contained",color:"primary",fullWidth:!0,size:"large",startIcon:(0,Y.jsx)(q.A,{}),onClick:Ne,disabled:0===de.length||$,ref:Ce,sx:{py:2,fontSize:"1.2rem",fontWeight:"bold",borderRadius:2,boxShadow:4,textTransform:"none"},children:$?"Processing...":"Complete Sale (F4)"})]})}),(0,Y.jsxs)(a.A,{sx:{flexGrow:1,display:{xs:"none",md:"block"}},children:[" ",(0,Y.jsx)(G,{})]})]})})]}),(0,Y.jsx)(a.A,{mt:2,display:{xs:"block",md:"none"},children:(0,Y.jsx)(G,{})}),(0,Y.jsxs)(F.A,{open:re,onClose:()=>oe(!1),children:[(0,Y.jsx)(R.A,{children:"Keyboard Shortcuts"}),(0,Y.jsx)(z.A,{children:(0,Y.jsxs)(m.Ay,{container:!0,spacing:2,children:[(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(c.A,{label:"F2",size:"small"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{children:"Focus Search Bar"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(c.A,{label:"F3",size:"small"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{children:"Select Customer"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(c.A,{label:"F4",size:"small"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{children:"Complete Sale / Pay"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(c.A,{label:"F9",size:"small"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{children:"Focus Discount Field"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(c.A,{label:"F8",size:"small"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{children:"Toggle Unit (Item/Box)"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(c.A,{label:"Esc",size:"small"})}),(0,Y.jsx)(m.Ay,{item:!0,xs:6,children:(0,Y.jsx)(l.A,{children:"Clear Selection / Blur"})})]})}),(0,Y.jsx)(N.A,{children:(0,Y.jsx)(x.A,{onClick:()=>oe(!1),children:"Close"})})]}),(0,Y.jsx)(X.A,{open:ee,onClose:()=>te(!1),invoice:ne.invoice,items:ne.items,settings:t}),(0,Y.jsx)(J,{open:ie,onClose:()=>{ae(!1),ce("")},initialName:le,onCustomerAdded:e=>{Q(t=>[...t,e]),xe(e),ae(!1),ce(""),E.oR.success("".concat(e.name," selected for this sale"))}})]})}}}]);
//# sourceMappingURL=678.ade30d2f.chunk.js.map